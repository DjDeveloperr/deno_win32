/// Auto-generated by Deno Win32: Windows.Win32.Security.AppLocker.Apis

import * as util from "../../util.ts";

// Enums
export type SAFER_COMPUTE_TOKEN_FROM_LEVEL_FLAGS = number;
export type SAFER_POLICY_INFO_CLASS = number;
export type SAFER_OBJECT_INFO_CLASS = number;
export type SAFER_IDENTIFICATION_TYPES = number;

// Constants
export const SAFER_TOKEN_NULL_IF_EQUAL = 1;
export const SAFER_TOKEN_COMPARE_ONLY = 2;
export const SAFER_TOKEN_MAKE_INERT = 4;
export const SAFER_TOKEN_WANT_FLAGS = 8;
export const SAFER_SCOPEID_MACHINE = 1;
export const SAFER_SCOPEID_USER = 2;
export const SAFER_LEVELID_FULLYTRUSTED = 262144;
export const SAFER_LEVELID_NORMALUSER = 131072;
export const SAFER_LEVELID_CONSTRAINED = 65536;
export const SAFER_LEVELID_UNTRUSTED = 4096;
export const SAFER_LEVELID_DISALLOWED = 0;
export const SAFER_LEVEL_OPEN = 1;
export const SAFER_MAX_FRIENDLYNAME_SIZE = 256;
export const SAFER_MAX_DESCRIPTION_SIZE = 256;
export const SAFER_MAX_HASH_SIZE = 64;
export const SAFER_CRITERIA_IMAGEPATH = 1;
export const SAFER_CRITERIA_NOSIGNEDHASH = 2;
export const SAFER_CRITERIA_IMAGEHASH = 4;
export const SAFER_CRITERIA_AUTHENTICODE = 8;
export const SAFER_CRITERIA_URLZONE = 16;
export const SAFER_CRITERIA_APPX_PACKAGE = 32;
export const SAFER_CRITERIA_IMAGEPATH_NT = 4096;
export const SAFER_POLICY_JOBID_MASK = 4278190080;
export const SAFER_POLICY_JOBID_CONSTRAINED = 67108864;
export const SAFER_POLICY_JOBID_UNTRUSTED = 50331648;
export const SAFER_POLICY_ONLY_EXES = 65536;
export const SAFER_POLICY_SANDBOX_INERT = 131072;
export const SAFER_POLICY_HASH_DUPLICATE = 262144;
export const SAFER_POLICY_ONLY_AUDIT = 4096;
export const SAFER_POLICY_BLOCK_CLIENT_UI = 8192;
export const SAFER_POLICY_UIFLAGS_MASK = 255;
export const SAFER_POLICY_UIFLAGS_INFORMATION_PROMPT = 1;
export const SAFER_POLICY_UIFLAGS_OPTION_PROMPT = 2;
export const SAFER_POLICY_UIFLAGS_HIDDEN = 4;
export const SRP_POLICY_EXE = `EXE`;
export const SRP_POLICY_DLL = `DLL`;
export const SRP_POLICY_MSI = `MSI`;
export const SRP_POLICY_SCRIPT = `SCRIPT`;
export const SRP_POLICY_SHELL = `SHELL`;
export const SRP_POLICY_NOV2 = `IGNORESRPV2`;
export const SRP_POLICY_APPX = `APPX`;
export const SRP_POLICY_WLDPMSI = `WLDPMSI`;
export const SRP_POLICY_WLDPSCRIPT = `WLDPSCRIPT`;
export const SRP_POLICY_WLDPCONFIGCI = `WLDPCONFIGCI`;
export const SRP_POLICY_MANAGEDINSTALLER = `MANAGEDINSTALLER`;
export const SaferPolicyLevelList = 1;
export const SaferPolicyEnableTransparentEnforcement = 2;
export const SaferPolicyDefaultLevel = 3;
export const SaferPolicyEvaluateUserScope = 4;
export const SaferPolicyScopeFlags = 5;
export const SaferPolicyDefaultLevelFlags = 6;
export const SaferPolicyAuthenticodeEnabled = 7;
export const SaferObjectLevelId = 1;
export const SaferObjectScopeId = 2;
export const SaferObjectFriendlyName = 3;
export const SaferObjectDescription = 4;
export const SaferObjectBuiltin = 5;
export const SaferObjectDisallowed = 6;
export const SaferObjectDisableMaxPrivilege = 7;
export const SaferObjectInvertDeletedPrivileges = 8;
export const SaferObjectDeletedPrivileges = 9;
export const SaferObjectDefaultOwner = 10;
export const SaferObjectSidsToDisable = 11;
export const SaferObjectRestrictedSidsInverted = 12;
export const SaferObjectRestrictedSidsAdded = 13;
export const SaferObjectAllIdentificationGuids = 14;
export const SaferObjectSingleIdentification = 15;
export const SaferObjectExtendedError = 16;
export const SaferIdentityDefault = 0;
export const SaferIdentityTypeImageName = 1;
export const SaferIdentityTypeImageHash = 2;
export const SaferIdentityTypeUrlZone = 3;
export const SaferIdentityTypeCertificate = 4;

// Structs

export type PWSTR = Deno.PointerValue | Uint8Array;

export type HANDLE = bigint | number;

/**
 * _Anonymous_e__Struct (size: 16)
 */
export interface _Anonymous_e__Struct {
  /** u64 */
  Alignment: bigint | number;
  /** u64 */
  Region: bigint | number;
}

export const sizeof_Anonymous_e__Struct = 16;

export function alloc_Anonymous_e__Struct(data?: Partial<_Anonymous_e__Struct>): Uint8Array {
  const buf = new Uint8Array(sizeof_Anonymous_e__Struct);
  const view = new DataView(buf.buffer);
  // 0x00: u64
  if (data?.Alignment !== undefined) view.setBigUint64(0, BigInt(data.Alignment), true);
  // 0x08: u64
  if (data?.Region !== undefined) view.setBigUint64(8, BigInt(data.Region), true);
  return buf;
}

export class _Anonymous_e__StructView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u64
  get Alignment(): bigint | number {
    return Number(this.view.getBigUint64(0, true));
  }

  // 0x08: u64
  get Region(): bigint | number {
    return Number(this.view.getBigUint64(8, true));
  }

  // 0x00: u64
  set Alignment(value: bigint | number) {
    this.view.setBigUint64(0, BigInt(value), true);
  }

  // 0x08: u64
  set Region(value: bigint | number) {
    this.view.setBigUint64(8, BigInt(value), true);
  }
}

/**
 * _u_e__Struct (size: 16)
 */
export interface _u_e__Struct {
  /** u32 */
  dwValue: number;
  /** Windows.Win32.Foundation.PWSTR */
  pwszName: string | null | Uint8Array | Uint16Array;
}

export const sizeof_u_e__Struct = 16;

export function alloc_u_e__Struct(data?: Partial<_u_e__Struct>): Uint8Array {
  const buf = new Uint8Array(sizeof_u_e__Struct);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwValue !== undefined) view.setUint32(0, Number(data.dwValue), true);
  // 0x04: pad4
  // 0x08: buffer
  if (data?.pwszName !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.pwszName);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  return buf;
}

export class _u_e__StructView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwValue(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  get pwszName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwValue(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  set pwszName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }
}

/**
 * Windows.Win32.Foundation.LARGE_INTEGER (size: 24)
 */
export interface LARGE_INTEGER {
  /** _Anonymous_e__Struct */
  Anonymous: Uint8Array | Deno.PointerValue;
  /** _u_e__Struct */
  u: Uint8Array | Deno.PointerValue;
  /** i64 */
  QuadPart: bigint | number;
}

export const sizeofLARGE_INTEGER = 24;

export function allocLARGE_INTEGER(data?: Partial<LARGE_INTEGER>): Uint8Array {
  const buf = new Uint8Array(sizeofLARGE_INTEGER);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(0, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  // 0x08: pointer
  if (data?.u !== undefined) view.setBigUint64(8, data.u === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.u))), true);
  // 0x10: i64
  if (data?.QuadPart !== undefined) view.setBigInt64(16, BigInt(data.QuadPart), true);
  return buf;
}

export class LARGE_INTEGERView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get u(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: i64
  get QuadPart(): bigint | number {
    return Number(this.view.getBigInt64(16, true));
  }

  // 0x00: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set u(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: i64
  set QuadPart(value: bigint | number) {
    this.view.setBigInt64(16, BigInt(value), true);
  }
}

export type HWND = bigint | number;

/**
 * Windows.Win32.Security.AppLocker.SAFER_CODE_PROPERTIES_V1 (size: 88)
 */
export interface SAFER_CODE_PROPERTIES_V1 {
  /** u32 */
  cbSize: number;
  /** u32 */
  dwCheckFlags: number;
  /** Windows.Win32.Foundation.PWSTR */
  ImagePath: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.HANDLE */
  hImageFileHandle: Uint8Array | Deno.PointerValue;
  /** u32 */
  UrlZoneId: number;
  /** array */
  ImageHash: Deno.PointerValue;
  /** u32 */
  dwImageHashSize: number;
  /** Windows.Win32.Foundation.LARGE_INTEGER */
  ImageSize: Uint8Array | Deno.PointerValue;
  /** u32 */
  HashAlgorithm: number;
  /** ptr */
  pByteBlock: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.HWND */
  hWndParent: Deno.PointerValue;
  /** u32 */
  dwWVTUIChoice: number;
}

export const sizeofSAFER_CODE_PROPERTIES_V1 = 88;

export function allocSAFER_CODE_PROPERTIES_V1(data?: Partial<SAFER_CODE_PROPERTIES_V1>): Uint8Array {
  const buf = new Uint8Array(sizeofSAFER_CODE_PROPERTIES_V1);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.cbSize !== undefined) view.setUint32(0, Number(data.cbSize), true);
  // 0x04: u32
  if (data?.dwCheckFlags !== undefined) view.setUint32(4, Number(data.dwCheckFlags), true);
  // 0x08: buffer
  if (data?.ImagePath !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.ImagePath);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  // 0x10: pointer
  if (data?.hImageFileHandle !== undefined) view.setBigUint64(16, data.hImageFileHandle === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hImageFileHandle))), true);
  // 0x18: u32
  if (data?.UrlZoneId !== undefined) view.setUint32(24, Number(data.UrlZoneId), true);
  // 0x1c: pad4
  // 0x20: pointer
  if (data?.ImageHash !== undefined) view.setBigUint64(32, data.ImageHash === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.ImageHash))), true);
  // 0x28: u32
  if (data?.dwImageHashSize !== undefined) view.setUint32(40, Number(data.dwImageHashSize), true);
  // 0x2c: pad4
  // 0x30: pointer
  if (data?.ImageSize !== undefined) view.setBigUint64(48, data.ImageSize === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.ImageSize))), true);
  // 0x38: u32
  if (data?.HashAlgorithm !== undefined) view.setUint32(56, Number(data.HashAlgorithm), true);
  // 0x3c: pad4
  // 0x40: pointer
  if (data?.pByteBlock !== undefined) view.setBigUint64(64, data.pByteBlock === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pByteBlock))), true);
  // 0x48: pointer
  if (data?.hWndParent !== undefined) view.setBigUint64(72, data.hWndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hWndParent))), true);
  // 0x50: u32
  if (data?.dwWVTUIChoice !== undefined) view.setUint32(80, Number(data.dwWVTUIChoice), true);
  // 0x54: pad4
  return buf;
}

export class SAFER_CODE_PROPERTIES_V1View {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get cbSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get dwCheckFlags(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: buffer
  get ImagePath(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get hImageFileHandle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get UrlZoneId(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x20: pointer
  get ImageHash(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: u32
  get dwImageHashSize(): number {
    return this.view.getUint32(40, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  get ImageSize(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x38: u32
  get HashAlgorithm(): number {
    return this.view.getUint32(56, true);
  }

  // 0x3c: pad4

  // 0x40: pointer
  get pByteBlock(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(64, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x48: pointer
  get hWndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(72, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x50: u32
  get dwWVTUIChoice(): number {
    return this.view.getUint32(80, true);
  }

  // 0x54: pad4

  // 0x00: u32
  set cbSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set dwCheckFlags(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: buffer
  set ImagePath(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }

  // 0x10: pointer
  set hImageFileHandle(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: u32
  set UrlZoneId(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4

  // 0x20: pointer
  set ImageHash(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x28: u32
  set dwImageHashSize(value: number) {
    this.view.setUint32(40, value, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  set ImageSize(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x38: u32
  set HashAlgorithm(value: number) {
    this.view.setUint32(56, value, true);
  }

  // 0x3c: pad4

  // 0x40: pointer
  set pByteBlock(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(64, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x48: pointer
  set hWndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(72, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x50: u32
  set dwWVTUIChoice(value: number) {
    this.view.setUint32(80, value, true);
  }

  // 0x54: pad4
}

export type BOOL = number;

/**
 * Windows.Win32.Security.AppLocker.SAFER_CODE_PROPERTIES_V2 (size: 128)
 */
export interface SAFER_CODE_PROPERTIES_V2 {
  /** u32 */
  cbSize: number;
  /** u32 */
  dwCheckFlags: number;
  /** Windows.Win32.Foundation.PWSTR */
  ImagePath: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.HANDLE */
  hImageFileHandle: Uint8Array | Deno.PointerValue;
  /** u32 */
  UrlZoneId: number;
  /** array */
  ImageHash: Deno.PointerValue;
  /** u32 */
  dwImageHashSize: number;
  /** Windows.Win32.Foundation.LARGE_INTEGER */
  ImageSize: Uint8Array | Deno.PointerValue;
  /** u32 */
  HashAlgorithm: number;
  /** ptr */
  pByteBlock: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.HWND */
  hWndParent: Deno.PointerValue;
  /** u32 */
  dwWVTUIChoice: number;
  /** Windows.Win32.Foundation.PWSTR */
  PackageMoniker: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.PWSTR */
  PackagePublisher: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.PWSTR */
  PackageName: string | null | Uint8Array | Uint16Array;
  /** u64 */
  PackageVersion: bigint | number;
  /** Windows.Win32.Foundation.BOOL */
  PackageIsFramework: boolean;
}

export const sizeofSAFER_CODE_PROPERTIES_V2 = 128;

export function allocSAFER_CODE_PROPERTIES_V2(data?: Partial<SAFER_CODE_PROPERTIES_V2>): Uint8Array {
  const buf = new Uint8Array(sizeofSAFER_CODE_PROPERTIES_V2);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.cbSize !== undefined) view.setUint32(0, Number(data.cbSize), true);
  // 0x04: u32
  if (data?.dwCheckFlags !== undefined) view.setUint32(4, Number(data.dwCheckFlags), true);
  // 0x08: buffer
  if (data?.ImagePath !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.ImagePath);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  // 0x10: pointer
  if (data?.hImageFileHandle !== undefined) view.setBigUint64(16, data.hImageFileHandle === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hImageFileHandle))), true);
  // 0x18: u32
  if (data?.UrlZoneId !== undefined) view.setUint32(24, Number(data.UrlZoneId), true);
  // 0x1c: pad4
  // 0x20: pointer
  if (data?.ImageHash !== undefined) view.setBigUint64(32, data.ImageHash === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.ImageHash))), true);
  // 0x28: u32
  if (data?.dwImageHashSize !== undefined) view.setUint32(40, Number(data.dwImageHashSize), true);
  // 0x2c: pad4
  // 0x30: pointer
  if (data?.ImageSize !== undefined) view.setBigUint64(48, data.ImageSize === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.ImageSize))), true);
  // 0x38: u32
  if (data?.HashAlgorithm !== undefined) view.setUint32(56, Number(data.HashAlgorithm), true);
  // 0x3c: pad4
  // 0x40: pointer
  if (data?.pByteBlock !== undefined) view.setBigUint64(64, data.pByteBlock === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pByteBlock))), true);
  // 0x48: pointer
  if (data?.hWndParent !== undefined) view.setBigUint64(72, data.hWndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hWndParent))), true);
  // 0x50: u32
  if (data?.dwWVTUIChoice !== undefined) view.setUint32(80, Number(data.dwWVTUIChoice), true);
  // 0x54: pad4
  // 0x58: buffer
  if (data?.PackageMoniker !== undefined) {
    (buf as any)._f88 = util.pwstrToFfi(data.PackageMoniker);
    view.setBigUint64(88, (buf as any)._f88 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f88))), true);
  }
  // 0x60: buffer
  if (data?.PackagePublisher !== undefined) {
    (buf as any)._f96 = util.pwstrToFfi(data.PackagePublisher);
    view.setBigUint64(96, (buf as any)._f96 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f96))), true);
  }
  // 0x68: buffer
  if (data?.PackageName !== undefined) {
    (buf as any)._f104 = util.pwstrToFfi(data.PackageName);
    view.setBigUint64(104, (buf as any)._f104 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f104))), true);
  }
  // 0x70: u64
  if (data?.PackageVersion !== undefined) view.setBigUint64(112, BigInt(data.PackageVersion), true);
  // 0x78: i32
  if (data?.PackageIsFramework !== undefined) view.setInt32(120, Number(data.PackageIsFramework), true);
  // 0x7c: pad4
  return buf;
}

export class SAFER_CODE_PROPERTIES_V2View {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get cbSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get dwCheckFlags(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: buffer
  get ImagePath(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get hImageFileHandle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get UrlZoneId(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x20: pointer
  get ImageHash(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: u32
  get dwImageHashSize(): number {
    return this.view.getUint32(40, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  get ImageSize(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x38: u32
  get HashAlgorithm(): number {
    return this.view.getUint32(56, true);
  }

  // 0x3c: pad4

  // 0x40: pointer
  get pByteBlock(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(64, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x48: pointer
  get hWndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(72, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x50: u32
  get dwWVTUIChoice(): number {
    return this.view.getUint32(80, true);
  }

  // 0x54: pad4

  // 0x58: buffer
  get PackageMoniker(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(88, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x60: buffer
  get PackagePublisher(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(96, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x68: buffer
  get PackageName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(104, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x70: u64
  get PackageVersion(): bigint | number {
    return Number(this.view.getBigUint64(112, true));
  }

  // 0x78: i32
  get PackageIsFramework(): number {
    return this.view.getInt32(120, true);
  }

  // 0x7c: pad4

  // 0x00: u32
  set cbSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set dwCheckFlags(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: buffer
  set ImagePath(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }

  // 0x10: pointer
  set hImageFileHandle(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: u32
  set UrlZoneId(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4

  // 0x20: pointer
  set ImageHash(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x28: u32
  set dwImageHashSize(value: number) {
    this.view.setUint32(40, value, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  set ImageSize(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x38: u32
  set HashAlgorithm(value: number) {
    this.view.setUint32(56, value, true);
  }

  // 0x3c: pad4

  // 0x40: pointer
  set pByteBlock(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(64, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x48: pointer
  set hWndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(72, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x50: u32
  set dwWVTUIChoice(value: number) {
    this.view.setUint32(80, value, true);
  }

  // 0x54: pad4

  // 0x58: buffer
  set PackageMoniker(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f88 = value;
    this.view.setBigUint64(88, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f88))), true);
  }

  // 0x60: buffer
  set PackagePublisher(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f96 = value;
    this.view.setBigUint64(96, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f96))), true);
  }

  // 0x68: buffer
  set PackageName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f104 = value;
    this.view.setBigUint64(104, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f104))), true);
  }

  // 0x70: u64
  set PackageVersion(value: bigint | number) {
    this.view.setBigUint64(112, BigInt(value), true);
  }

  // 0x78: i32
  set PackageIsFramework(value: number) {
    this.view.setInt32(120, value, true);
  }

  // 0x7c: pad4
}

/**
 * Windows.Win32.Foundation.FILETIME (size: 8)
 */
export interface FILETIME {
  /** u32 */
  dwLowDateTime: number;
  /** u32 */
  dwHighDateTime: number;
}

export const sizeofFILETIME = 8;

export function allocFILETIME(data?: Partial<FILETIME>): Uint8Array {
  const buf = new Uint8Array(sizeofFILETIME);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwLowDateTime !== undefined) view.setUint32(0, Number(data.dwLowDateTime), true);
  // 0x04: u32
  if (data?.dwHighDateTime !== undefined) view.setUint32(4, Number(data.dwHighDateTime), true);
  return buf;
}

export class FILETIMEView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwLowDateTime(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get dwHighDateTime(): number {
    return this.view.getUint32(4, true);
  }

  // 0x00: u32
  set dwLowDateTime(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set dwHighDateTime(value: number) {
    this.view.setUint32(4, value, true);
  }
}

/**
 * Windows.Win32.Security.AppLocker.SAFER_IDENTIFICATION_HEADER (size: 24)
 */
export interface SAFER_IDENTIFICATION_HEADER {
  /** Windows.Win32.Security.AppLocker.SAFER_IDENTIFICATION_TYPES */
  dwIdentificationType: SAFER_IDENTIFICATION_TYPES;
  /** u32 */
  cbStructSize: number;
  /** System.Guid */
  IdentificationGuid: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.FILETIME */
  lastModified: Uint8Array | Deno.PointerValue;
}

export const sizeofSAFER_IDENTIFICATION_HEADER = 24;

export function allocSAFER_IDENTIFICATION_HEADER(data?: Partial<SAFER_IDENTIFICATION_HEADER>): Uint8Array {
  const buf = new Uint8Array(sizeofSAFER_IDENTIFICATION_HEADER);
  const view = new DataView(buf.buffer);
  // 0x00: i32
  if (data?.dwIdentificationType !== undefined) view.setInt32(0, Number(data.dwIdentificationType), true);
  // 0x04: u32
  if (data?.cbStructSize !== undefined) view.setUint32(4, Number(data.cbStructSize), true);
  // 0x08: pointer
  if (data?.IdentificationGuid !== undefined) view.setBigUint64(8, data.IdentificationGuid === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.IdentificationGuid))), true);
  // 0x10: pointer
  if (data?.lastModified !== undefined) view.setBigUint64(16, data.lastModified === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.lastModified))), true);
  return buf;
}

export class SAFER_IDENTIFICATION_HEADERView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: i32
  get dwIdentificationType(): number {
    return this.view.getInt32(0, true);
  }

  // 0x04: u32
  get cbStructSize(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: pointer
  get IdentificationGuid(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get lastModified(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: i32
  set dwIdentificationType(value: number) {
    this.view.setInt32(0, value, true);
  }

  // 0x04: u32
  set cbStructSize(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: pointer
  set IdentificationGuid(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: pointer
  set lastModified(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.AppLocker.SAFER_PATHNAME_IDENTIFICATION (size: 32)
 */
export interface SAFER_PATHNAME_IDENTIFICATION {
  /** Windows.Win32.Security.AppLocker.SAFER_IDENTIFICATION_HEADER */
  header: Uint8Array | Deno.PointerValue;
  /** array */
  Description: Deno.PointerValue;
  /** Windows.Win32.Foundation.PWSTR */
  ImageName: string | null | Uint8Array | Uint16Array;
  /** u32 */
  dwSaferFlags: number;
}

export const sizeofSAFER_PATHNAME_IDENTIFICATION = 32;

export function allocSAFER_PATHNAME_IDENTIFICATION(data?: Partial<SAFER_PATHNAME_IDENTIFICATION>): Uint8Array {
  const buf = new Uint8Array(sizeofSAFER_PATHNAME_IDENTIFICATION);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.header !== undefined) view.setBigUint64(0, data.header === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.header))), true);
  // 0x08: pointer
  if (data?.Description !== undefined) view.setBigUint64(8, data.Description === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Description))), true);
  // 0x10: buffer
  if (data?.ImageName !== undefined) {
    (buf as any)._f16 = util.pwstrToFfi(data.ImageName);
    view.setBigUint64(16, (buf as any)._f16 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f16))), true);
  }
  // 0x18: u32
  if (data?.dwSaferFlags !== undefined) view.setUint32(24, Number(data.dwSaferFlags), true);
  // 0x1c: pad4
  return buf;
}

export class SAFER_PATHNAME_IDENTIFICATIONView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get header(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get Description(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: buffer
  get ImageName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get dwSaferFlags(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x00: pointer
  set header(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set Description(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: buffer
  set ImageName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f16 = value;
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f16))), true);
  }

  // 0x18: u32
  set dwSaferFlags(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4
}

/**
 * Windows.Win32.Security.AppLocker.SAFER_HASH_IDENTIFICATION (size: 64)
 */
export interface SAFER_HASH_IDENTIFICATION {
  /** Windows.Win32.Security.AppLocker.SAFER_IDENTIFICATION_HEADER */
  header: Uint8Array | Deno.PointerValue;
  /** array */
  Description: Deno.PointerValue;
  /** array */
  FriendlyName: Deno.PointerValue;
  /** u32 */
  HashSize: number;
  /** array */
  ImageHash: Deno.PointerValue;
  /** u32 */
  HashAlgorithm: number;
  /** Windows.Win32.Foundation.LARGE_INTEGER */
  ImageSize: Uint8Array | Deno.PointerValue;
  /** u32 */
  dwSaferFlags: number;
}

export const sizeofSAFER_HASH_IDENTIFICATION = 64;

export function allocSAFER_HASH_IDENTIFICATION(data?: Partial<SAFER_HASH_IDENTIFICATION>): Uint8Array {
  const buf = new Uint8Array(sizeofSAFER_HASH_IDENTIFICATION);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.header !== undefined) view.setBigUint64(0, data.header === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.header))), true);
  // 0x08: pointer
  if (data?.Description !== undefined) view.setBigUint64(8, data.Description === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Description))), true);
  // 0x10: pointer
  if (data?.FriendlyName !== undefined) view.setBigUint64(16, data.FriendlyName === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.FriendlyName))), true);
  // 0x18: u32
  if (data?.HashSize !== undefined) view.setUint32(24, Number(data.HashSize), true);
  // 0x1c: pad4
  // 0x20: pointer
  if (data?.ImageHash !== undefined) view.setBigUint64(32, data.ImageHash === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.ImageHash))), true);
  // 0x28: u32
  if (data?.HashAlgorithm !== undefined) view.setUint32(40, Number(data.HashAlgorithm), true);
  // 0x2c: pad4
  // 0x30: pointer
  if (data?.ImageSize !== undefined) view.setBigUint64(48, data.ImageSize === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.ImageSize))), true);
  // 0x38: u32
  if (data?.dwSaferFlags !== undefined) view.setUint32(56, Number(data.dwSaferFlags), true);
  // 0x3c: pad4
  return buf;
}

export class SAFER_HASH_IDENTIFICATIONView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get header(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get Description(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get FriendlyName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get HashSize(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x20: pointer
  get ImageHash(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: u32
  get HashAlgorithm(): number {
    return this.view.getUint32(40, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  get ImageSize(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x38: u32
  get dwSaferFlags(): number {
    return this.view.getUint32(56, true);
  }

  // 0x3c: pad4

  // 0x00: pointer
  set header(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set Description(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: pointer
  set FriendlyName(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: u32
  set HashSize(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4

  // 0x20: pointer
  set ImageHash(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x28: u32
  set HashAlgorithm(value: number) {
    this.view.setUint32(40, value, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  set ImageSize(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x38: u32
  set dwSaferFlags(value: number) {
    this.view.setUint32(56, value, true);
  }

  // 0x3c: pad4
}

/**
 * Windows.Win32.Security.AppLocker.SAFER_HASH_IDENTIFICATION2 (size: 32)
 */
export interface SAFER_HASH_IDENTIFICATION2 {
  /** Windows.Win32.Security.AppLocker.SAFER_HASH_IDENTIFICATION */
  hashIdentification: Uint8Array | Deno.PointerValue;
  /** u32 */
  HashSize: number;
  /** array */
  ImageHash: Deno.PointerValue;
  /** u32 */
  HashAlgorithm: number;
}

export const sizeofSAFER_HASH_IDENTIFICATION2 = 32;

export function allocSAFER_HASH_IDENTIFICATION2(data?: Partial<SAFER_HASH_IDENTIFICATION2>): Uint8Array {
  const buf = new Uint8Array(sizeofSAFER_HASH_IDENTIFICATION2);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.hashIdentification !== undefined) view.setBigUint64(0, data.hashIdentification === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hashIdentification))), true);
  // 0x08: u32
  if (data?.HashSize !== undefined) view.setUint32(8, Number(data.HashSize), true);
  // 0x0c: pad4
  // 0x10: pointer
  if (data?.ImageHash !== undefined) view.setBigUint64(16, data.ImageHash === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.ImageHash))), true);
  // 0x18: u32
  if (data?.HashAlgorithm !== undefined) view.setUint32(24, Number(data.HashAlgorithm), true);
  // 0x1c: pad4
  return buf;
}

export class SAFER_HASH_IDENTIFICATION2View {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get hashIdentification(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get HashSize(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  get ImageHash(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get HashAlgorithm(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x00: pointer
  set hashIdentification(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set HashSize(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  set ImageHash(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: u32
  set HashAlgorithm(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4
}

/**
 * Windows.Win32.Security.AppLocker.SAFER_URLZONE_IDENTIFICATION (size: 16)
 */
export interface SAFER_URLZONE_IDENTIFICATION {
  /** Windows.Win32.Security.AppLocker.SAFER_IDENTIFICATION_HEADER */
  header: Uint8Array | Deno.PointerValue;
  /** u32 */
  UrlZoneId: number;
  /** u32 */
  dwSaferFlags: number;
}

export const sizeofSAFER_URLZONE_IDENTIFICATION = 16;

export function allocSAFER_URLZONE_IDENTIFICATION(data?: Partial<SAFER_URLZONE_IDENTIFICATION>): Uint8Array {
  const buf = new Uint8Array(sizeofSAFER_URLZONE_IDENTIFICATION);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.header !== undefined) view.setBigUint64(0, data.header === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.header))), true);
  // 0x08: u32
  if (data?.UrlZoneId !== undefined) view.setUint32(8, Number(data.UrlZoneId), true);
  // 0x0c: u32
  if (data?.dwSaferFlags !== undefined) view.setUint32(12, Number(data.dwSaferFlags), true);
  return buf;
}

export class SAFER_URLZONE_IDENTIFICATIONView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get header(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get UrlZoneId(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: u32
  get dwSaferFlags(): number {
    return this.view.getUint32(12, true);
  }

  // 0x00: pointer
  set header(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set UrlZoneId(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: u32
  set dwSaferFlags(value: number) {
    this.view.setUint32(12, value, true);
  }
}

export type SAFER_LEVEL_HANDLE = bigint | number;

export type BOOLEAN = number;

// Native Libraries

try {
  var libADVAPI32_dll = Deno.dlopen("ADVAPI32.dll", {
    SaferGetPolicyInformation: {
      parameters: ["u32", "i32", "u32", "pointer", "pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    SaferSetPolicyInformation: {
      parameters: ["u32", "i32", "u32", "pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    SaferCreateLevel: {
      parameters: ["u32", "u32", "u32", "pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    SaferCloseLevel: {
      parameters: ["pointer"],
      result: "i32",
      optional: true,
    },
    SaferIdentifyLevel: {
      parameters: ["u32", "pointer", "pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    SaferComputeTokenFromLevel: {
      parameters: ["pointer", "pointer", "pointer", "u32", "pointer"],
      result: "i32",
      optional: true,
    },
    SaferGetLevelInformation: {
      parameters: ["pointer", "i32", "pointer", "u32", "pointer"],
      result: "i32",
      optional: true,
    },
    SaferSetLevelInformation: {
      parameters: ["pointer", "i32", "pointer", "u32"],
      result: "i32",
      optional: true,
    },
    SaferRecordEventLogEntry: {
      parameters: ["pointer", "buffer", "pointer"],
      result: "i32",
      optional: true,
    },
    SaferiIsExecutableFileType: {
      parameters: ["buffer", "pointer"],
      result: "i32",
      optional: true,
    },
  }).symbols;
} catch(e) { /* ignore */ }

// Symbols

export function SaferGetPolicyInformation(
  dwScopeId: number /* u32 */,
  SaferPolicyInfoClass: SAFER_POLICY_INFO_CLASS /* Windows.Win32.Security.AppLocker.SAFER_POLICY_INFO_CLASS */,
  InfoBufferSize: number /* u32 */,
  InfoBuffer: Deno.PointerValue | Uint8Array /* ptr */,
  InfoBufferRetSize: Deno.PointerValue | Uint8Array /* ptr */,
  lpReserved: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferGetPolicyInformation!(dwScopeId, SaferPolicyInfoClass, InfoBufferSize, util.toPointer(InfoBuffer), util.toPointer(InfoBufferRetSize), util.toPointer(lpReserved)));
}

export function SaferSetPolicyInformation(
  dwScopeId: number /* u32 */,
  SaferPolicyInfoClass: SAFER_POLICY_INFO_CLASS /* Windows.Win32.Security.AppLocker.SAFER_POLICY_INFO_CLASS */,
  InfoBufferSize: number /* u32 */,
  InfoBuffer: Deno.PointerValue | Uint8Array /* ptr */,
  lpReserved: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferSetPolicyInformation!(dwScopeId, SaferPolicyInfoClass, InfoBufferSize, util.toPointer(InfoBuffer), util.toPointer(lpReserved)));
}

export function SaferCreateLevel(
  dwScopeId: number /* u32 */,
  dwLevelId: number /* u32 */,
  OpenFlags: number /* u32 */,
  pLevelHandle: Deno.PointerValue | Uint8Array /* ptr */,
  lpReserved: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferCreateLevel!(dwScopeId, dwLevelId, OpenFlags, util.toPointer(pLevelHandle), util.toPointer(lpReserved)));
}

export function SaferCloseLevel(
  hLevelHandle: Uint8Array | Deno.PointerValue /* Windows.Win32.Security.SAFER_LEVEL_HANDLE */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferCloseLevel!(util.toPointer(hLevelHandle)));
}

export function SaferIdentifyLevel(
  dwNumProperties: number /* u32 */,
  pCodeProperties: Deno.PointerValue | Uint8Array /* ptr */,
  pLevelHandle: Deno.PointerValue | Uint8Array /* ptr */,
  lpReserved: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferIdentifyLevel!(dwNumProperties, util.toPointer(pCodeProperties), util.toPointer(pLevelHandle), util.toPointer(lpReserved)));
}

export function SaferComputeTokenFromLevel(
  LevelHandle: Uint8Array | Deno.PointerValue /* Windows.Win32.Security.SAFER_LEVEL_HANDLE */,
  InAccessToken: Uint8Array | Deno.PointerValue /* Windows.Win32.Foundation.HANDLE */,
  OutAccessToken: Deno.PointerValue | Uint8Array /* ptr */,
  dwFlags: SAFER_COMPUTE_TOKEN_FROM_LEVEL_FLAGS /* Windows.Win32.Security.AppLocker.SAFER_COMPUTE_TOKEN_FROM_LEVEL_FLAGS */,
  lpReserved: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferComputeTokenFromLevel!(util.toPointer(LevelHandle), util.toPointer(InAccessToken), util.toPointer(OutAccessToken), dwFlags, util.toPointer(lpReserved)));
}

export function SaferGetLevelInformation(
  LevelHandle: Uint8Array | Deno.PointerValue /* Windows.Win32.Security.SAFER_LEVEL_HANDLE */,
  dwInfoType: SAFER_OBJECT_INFO_CLASS /* Windows.Win32.Security.AppLocker.SAFER_OBJECT_INFO_CLASS */,
  lpQueryBuffer: Deno.PointerValue | Uint8Array /* ptr */,
  dwInBufferSize: number /* u32 */,
  lpdwOutBufferSize: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferGetLevelInformation!(util.toPointer(LevelHandle), dwInfoType, util.toPointer(lpQueryBuffer), dwInBufferSize, util.toPointer(lpdwOutBufferSize)));
}

export function SaferSetLevelInformation(
  LevelHandle: Uint8Array | Deno.PointerValue /* Windows.Win32.Security.SAFER_LEVEL_HANDLE */,
  dwInfoType: SAFER_OBJECT_INFO_CLASS /* Windows.Win32.Security.AppLocker.SAFER_OBJECT_INFO_CLASS */,
  lpQueryBuffer: Deno.PointerValue | Uint8Array /* ptr */,
  dwInBufferSize: number /* u32 */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferSetLevelInformation!(util.toPointer(LevelHandle), dwInfoType, util.toPointer(lpQueryBuffer), dwInBufferSize));
}

export function SaferRecordEventLogEntry(
  hLevel: Uint8Array | Deno.PointerValue /* Windows.Win32.Security.SAFER_LEVEL_HANDLE */,
  szTargetPath: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  lpReserved: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferRecordEventLogEntry!(util.toPointer(hLevel), util.pwstrToFfi(szTargetPath), util.toPointer(lpReserved)));
}

export function SaferiIsExecutableFileType(
  szFullPathname: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  bFromShellExecute: Uint8Array | Deno.PointerValue /* Windows.Win32.Foundation.BOOLEAN */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libADVAPI32_dll.SaferiIsExecutableFileType!(util.pwstrToFfi(szFullPathname), util.toPointer(bFromShellExecute)));
}

