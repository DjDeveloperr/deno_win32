/// Auto-generated by Deno Win32: Windows.Win32.Security.Cryptography.UI.Apis

import * as util from "../../../util.ts";

// Enums
export type CRYPTUI_WIZ_FLAGS = number;
export type CRYPTUI_VIEWCERTIFICATE_FLAGS = number;
export type CERT_SELECT_STRUCT_FLAGS = number;
export type CRYPTUI_WIZ_IMPORT_SUBJECT_OPTION = number;
export type CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT = number;
export type CRYPTUI_WIZ_DIGITAL_SIGN = number;
export type CRYPTUI_WIZ_EXPORT_SUBJECT = number;
export type CRYPTUI_WIZ_DIGITAL_SIGN_SIG_TYPE = number;
export type CRYPTUI_WIZ_DIGITAL_SIGN_PVK_OPTION = number;
export type CERT_VIEWPROPERTIES_STRUCT_FLAGS = number;
export type CRYPTUI_WIZ_EXPORT_FORMAT = number;
export type CRYPTUI_WIZ_DIGITAL_ADDITIONAL_CERT_CHOICE = number;
export type CTL_MODIFY_REQUEST_OPERATION = number;
export type CRYPT_KEY_FLAGS = number;

// Constants
export const CRYPTUI_WIZ_NO_UI = 1;
export const CRYPTUI_WIZ_IGNORE_NO_UI_FLAG_FOR_CSPS = 2;
export const CRYPTUI_WIZ_NO_UI_EXCEPT_CSP = 3;
export const CRYPTUI_WIZ_IMPORT_ALLOW_CERT = 131072;
export const CRYPTUI_WIZ_IMPORT_ALLOW_CRL = 262144;
export const CRYPTUI_WIZ_IMPORT_ALLOW_CTL = 524288;
export const CRYPTUI_WIZ_IMPORT_NO_CHANGE_DEST_STORE = 65536;
export const CRYPTUI_WIZ_IMPORT_TO_LOCALMACHINE = 1048576;
export const CRYPTUI_WIZ_IMPORT_TO_CURRENTUSER = 2097152;
export const CRYPTUI_WIZ_IMPORT_REMOTE_DEST_STORE = 4194304;
export const CRYPTUI_WIZ_EXPORT_PRIVATE_KEY = 256;
export const CRYPTUI_WIZ_EXPORT_NO_DELETE_PRIVATE_KEY = 512;
export const CRYPTUI_HIDE_HIERARCHYPAGE = 1;
export const CRYPTUI_HIDE_DETAILPAGE = 2;
export const CRYPTUI_DISABLE_EDITPROPERTIES = 4;
export const CRYPTUI_ENABLE_EDITPROPERTIES = 8;
export const CRYPTUI_DISABLE_ADDTOSTORE = 16;
export const CRYPTUI_ENABLE_ADDTOSTORE = 32;
export const CRYPTUI_ACCEPT_DECLINE_STYLE = 64;
export const CRYPTUI_IGNORE_UNTRUSTED_ROOT = 128;
export const CRYPTUI_DONT_OPEN_STORES = 256;
export const CRYPTUI_ONLY_OPEN_ROOT_STORE = 512;
export const CRYPTUI_WARN_UNTRUSTED_ROOT = 1024;
export const CRYPTUI_ENABLE_REVOCATION_CHECKING = 2048;
export const CRYPTUI_WARN_REMOTE_TRUST = 4096;
export const CRYPTUI_DISABLE_EXPORT = 8192;
export const CRYPTUI_ENABLE_REVOCATION_CHECK_END_CERT = 16384;
export const CRYPTUI_ENABLE_REVOCATION_CHECK_CHAIN = 32768;
export const CRYPTUI_ENABLE_REVOCATION_CHECK_CHAIN_EXCLUDE_ROOT = 2048;
export const CRYPTUI_DISABLE_HTMLLINK = 65536;
export const CRYPTUI_DISABLE_ISSUERSTATEMENT = 131072;
export const CRYPTUI_CACHE_ONLY_URL_RETRIEVAL = 262144;
export const CSS_HIDE_PROPERTIES = 1;
export const CSS_ENABLEHOOK = 2;
export const CSS_ALLOWMULTISELECT = 4;
export const CSS_SHOW_HELP = 16;
export const CSS_ENABLETEMPLATE = 32;
export const CSS_ENABLETEMPLATEHANDLE = 64;
export const CRYPTUI_WIZ_IMPORT_SUBJECT_FILE = 1;
export const CRYPTUI_WIZ_IMPORT_SUBJECT_CERT_CONTEXT = 2;
export const CRYPTUI_WIZ_IMPORT_SUBJECT_CTL_CONTEXT = 3;
export const CRYPTUI_WIZ_IMPORT_SUBJECT_CRL_CONTEXT = 4;
export const CRYPTUI_WIZ_IMPORT_SUBJECT_CERT_STORE = 5;
export const CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_BLOB = 2;
export const CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_FILE = 1;
export const CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_NONE = 0;
export const CRYPTUI_WIZ_DIGITAL_SIGN_CERT = 1;
export const CRYPTUI_WIZ_DIGITAL_SIGN_STORE = 2;
export const CRYPTUI_WIZ_DIGITAL_SIGN_PVK = 3;
export const CRYPTUI_WIZ_DIGITAL_SIGN_NONE = 0;
export const CRYPTUI_WIZ_EXPORT_CERT_CONTEXT = 1;
export const CRYPTUI_WIZ_EXPORT_CTL_CONTEXT = 2;
export const CRYPTUI_WIZ_EXPORT_CRL_CONTEXT = 3;
export const CRYPTUI_WIZ_EXPORT_CERT_STORE = 4;
export const CRYPTUI_WIZ_EXPORT_CERT_STORE_CERTIFICATES_ONLY = 5;
export const CRYPTUI_WIZ_DIGITAL_SIGN_COMMERCIAL = 1;
export const CRYPTUI_WIZ_DIGITAL_SIGN_INDIVIDUAL = 2;
export const CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE = 1;
export const CRYPTUI_WIZ_DIGITAL_SIGN_PVK_PROV = 2;
export const CM_ENABLEHOOK = 1;
export const CM_SHOW_HELP = 2;
export const CM_SHOW_HELPICON = 4;
export const CM_ENABLETEMPLATE = 8;
export const CM_HIDE_ADVANCEPAGE = 16;
export const CM_HIDE_TRUSTPAGE = 32;
export const CM_NO_NAMECHANGE = 64;
export const CM_NO_EDITTRUST = 128;
export const CM_HIDE_DETAILPAGE = 256;
export const CM_ADD_CERT_STORES = 512;
export const CRYPTUI_WIZ_EXPORT_FORMAT_DER = 1;
export const CRYPTUI_WIZ_EXPORT_FORMAT_PFX = 2;
export const CRYPTUI_WIZ_EXPORT_FORMAT_PKCS7 = 3;
export const CRYPTUI_WIZ_EXPORT_FORMAT_BASE64 = 4;
export const CRYPTUI_WIZ_EXPORT_FORMAT_CRL = 6;
export const CRYPTUI_WIZ_EXPORT_FORMAT_CTL = 7;
export const CRYPTUI_WIZ_DIGITAL_SIGN_ADD_CHAIN = 1;
export const CRYPTUI_WIZ_DIGITAL_SIGN_ADD_CHAIN_NO_ROOT = 2;
export const CRYPTUI_WIZ_DIGITAL_SIGN_ADD_NONE = 0;
export const CTL_MODIFY_REQUEST_ADD_TRUSTED = 3;
export const CTL_MODIFY_REQUEST_ADD_NOT_TRUSTED = 1;
export const CTL_MODIFY_REQUEST_REMOVE = 2;
export const CRYTPDLG_FLAGS_MASK = 4278190080;
export const CRYPTDLG_REVOCATION_DEFAULT = 0;
export const CRYPTDLG_REVOCATION_ONLINE = 2147483648;
export const CRYPTDLG_REVOCATION_CACHE = 1073741824;
export const CRYPTDLG_REVOCATION_NONE = 536870912;
export const CRYPTDLG_CACHE_ONLY_URL_RETRIEVAL = 268435456;
export const CRYPTDLG_DISABLE_AIA = 134217728;
export const CRYPTDLG_POLICY_MASK = 65535;
export const POLICY_IGNORE_NON_CRITICAL_BC = 1;
export const CRYPTDLG_ACTION_MASK = 4294901760;
export const ACTION_REVOCATION_DEFAULT_ONLINE = 65536;
export const ACTION_REVOCATION_DEFAULT_CACHE = 131072;
export const CERT_DISPWELL_SELECT = 1;
export const CERT_DISPWELL_TRUST_CA_CERT = 2;
export const CERT_DISPWELL_TRUST_LEAF_CERT = 3;
export const CERT_DISPWELL_TRUST_ADD_CA_CERT = 4;
export const CERT_DISPWELL_TRUST_ADD_LEAF_CERT = 5;
export const CERT_DISPWELL_DISTRUST_CA_CERT = 6;
export const CERT_DISPWELL_DISTRUST_LEAF_CERT = 7;
export const CERT_DISPWELL_DISTRUST_ADD_CA_CERT = 8;
export const CERT_DISPWELL_DISTRUST_ADD_LEAF_CERT = 9;
export const CSS_SELECTCERT_MASK = 16777215;
export const SELCERT_PROPERTIES = 100;
export const SELCERT_FINEPRINT = 101;
export const SELCERT_CERTLIST = 102;
export const SELCERT_ISSUED_TO = 103;
export const SELCERT_VALIDITY = 104;
export const SELCERT_ALGORITHM = 105;
export const SELCERT_SERIAL_NUM = 106;
export const SELCERT_THUMBPRINT = 107;
export const CM_VIEWFLAGS_MASK = 16777215;
export const CERTVIEW_CRYPTUI_LPARAM = 8388608;
export const CERT_FILTER_OP_EXISTS = 1;
export const CERT_FILTER_OP_NOT_EXISTS = 2;
export const CERT_FILTER_OP_EQUALITY = 3;
export const CERT_FILTER_INCLUDE_V1_CERTS = 1;
export const CERT_FILTER_VALID_TIME_RANGE = 2;
export const CERT_FILTER_VALID_SIGNATURE = 4;
export const CERT_FILTER_LEAF_CERTS_ONLY = 8;
export const CERT_FILTER_ISSUER_CERTS_ONLY = 16;
export const CERT_FILTER_KEY_EXISTS = 32;
export const szCERT_CERTIFICATE_ACTION_VERIFY = `{7801ebd0-cf4b-11d0-851f-0060979387ea}`;
export const CERT_VALIDITY_BEFORE_START = 1;
export const CERT_VALIDITY_AFTER_END = 2;
export const CERT_VALIDITY_SIGNATURE_FAILS = 4;
export const CERT_VALIDITY_CERTIFICATE_REVOKED = 8;
export const CERT_VALIDITY_KEY_USAGE_EXT_FAILURE = 16;
export const CERT_VALIDITY_EXTENDED_USAGE_FAILURE = 32;
export const CERT_VALIDITY_NAME_CONSTRAINTS_FAILURE = 64;
export const CERT_VALIDITY_UNKNOWN_CRITICAL_EXTENSION = 128;
export const CERT_VALIDITY_ISSUER_INVALID = 256;
export const CERT_VALIDITY_OTHER_EXTENSION_FAILURE = 512;
export const CERT_VALIDITY_PERIOD_NESTING_FAILURE = 1024;
export const CERT_VALIDITY_OTHER_ERROR = 2048;
export const CERT_VALIDITY_ISSUER_DISTRUST = 33554432;
export const CERT_VALIDITY_EXPLICITLY_DISTRUSTED = 16777216;
export const CERT_VALIDITY_NO_ISSUER_CERT_FOUND = 268435456;
export const CERT_VALIDITY_NO_CRL_FOUND = 536870912;
export const CERT_VALIDITY_CRL_OUT_OF_DATE = 1073741824;
export const CERT_VALIDITY_NO_TRUST_DATA = 2147483648;
export const CERT_VALIDITY_MASK_TRUST = 4294901760;
export const CERT_VALIDITY_MASK_VALIDITY = 65535;
export const CERT_TRUST_MASK = 16777215;
export const CERT_TRUST_DO_FULL_SEARCH = 1;
export const CERT_TRUST_PERMIT_MISSING_CRLS = 2;
export const CERT_TRUST_DO_FULL_TRUST = 5;
export const CERT_CREDENTIAL_PROVIDER_ID = `-509`;
export const CRYPTUI_SELECT_ISSUEDTO_COLUMN = 1;
export const CRYPTUI_SELECT_ISSUEDBY_COLUMN = 2;
export const CRYPTUI_SELECT_INTENDEDUSE_COLUMN = 4;
export const CRYPTUI_SELECT_FRIENDLYNAME_COLUMN = 8;
export const CRYPTUI_SELECT_LOCATION_COLUMN = 16;
export const CRYPTUI_SELECT_EXPIRATION_COLUMN = 32;
export const CRYPTUI_CERT_MGR_TAB_MASK = 15;
export const CRYPTUI_CERT_MGR_PUBLISHER_TAB = 4;
export const CRYPTUI_CERT_MGR_SINGLE_TAB_FLAG = 32768;
export const CRYPTUI_WIZ_DIGITAL_SIGN_EXCLUDE_PAGE_HASHES = 2;
export const CRYPTUI_WIZ_DIGITAL_SIGN_INCLUDE_PAGE_HASHES = 4;
export const CRYPTUI_WIZ_EXPORT_FORMAT_SERIALIZED_CERT_STORE = 5;
export const CRYPT_EXPORTABLE = 1;
export const CRYPT_USER_PROTECTED = 2;
export const CRYPT_ARCHIVABLE = 16384;
export const CRYPT_CREATE_IV = 512;
export const CRYPT_CREATE_SALT = 4;
export const CRYPT_DATA_KEY = 2048;
export const CRYPT_FORCE_KEY_PROTECTION_HIGH = 32768;
export const CRYPT_KEK = 1024;
export const CRYPT_INITIATOR = 64;
export const CRYPT_NO_SALT = 16;
export const CRYPT_ONLINE = 128;
export const CRYPT_PREGEN = 64;
export const CRYPT_RECIPIENT = 16;
export const CRYPT_SF = 256;
export const CRYPT_SGCKEY = 8192;
export const CRYPT_VOLATILE = 4096;
export const CRYPT_MACHINE_KEYSET = 32;
export const CRYPT_USER_KEYSET = 4096;
export const PKCS12_PREFER_CNG_KSP = 256;
export const PKCS12_ALWAYS_CNG_KSP = 512;
export const PKCS12_ALLOW_OVERWRITE_KEY = 16384;
export const PKCS12_NO_PERSIST_KEY = 32768;
export const PKCS12_INCLUDE_EXTENDED_PROPERTIES = 16;
export const CRYPT_OAEP = 64;
export const CRYPT_BLOB_VER3 = 128;
export const CRYPT_DESTROYKEY = 4;
export const CRYPT_SSL2_FALLBACK = 2;
export const CRYPT_Y_ONLY = 1;
export const CRYPT_IPSEC_HMAC_KEY = 256;
export const CERT_SET_KEY_PROV_HANDLE_PROP_ID = 1;
export const CERT_SET_KEY_CONTEXT_PROP_ID = 1;

// Structs

export type HWND = bigint | number;

export type HINSTANCE = bigint | number;

export type PSTR = Deno.PointerValue | Uint8Array;

export type LPARAM = bigint | number;

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_SELECT_STRUCT_A (size: 136)
 */
export interface CERT_SELECT_STRUCT_A {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.HWND */
  hwndParent: Deno.PointerValue;
  /** Windows.Win32.Foundation.HINSTANCE */
  hInstance: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.PSTR */
  pTemplateName: string | null | Uint8Array;
  /** Windows.Win32.Security.Cryptography.UI.CERT_SELECT_STRUCT_FLAGS */
  dwFlags: CERT_SELECT_STRUCT_FLAGS;
  /** Windows.Win32.Foundation.PSTR */
  szTitle: string | null | Uint8Array;
  /** u32 */
  cCertStore: number;
  /** ptr */
  arrayCertStore: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.PSTR */
  szPurposeOid: string | null | Uint8Array;
  /** u32 */
  cCertContext: number;
  /** ptr */
  arrayCertContext: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.LPARAM */
  lCustData: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.PFNCMHOOKPROC */
  pfnHook: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.PFNCMFILTERPROC */
  pfnFilter: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.PSTR */
  szHelpFileName: string | null | Uint8Array;
  /** u32 */
  dwHelpId: number;
  /** usize */
  hprov: bigint | number;
}

export const sizeofCERT_SELECT_STRUCT_A = 136;

export function allocCERT_SELECT_STRUCT_A(data?: Partial<CERT_SELECT_STRUCT_A>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_SELECT_STRUCT_A);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.hwndParent !== undefined) view.setBigUint64(8, data.hwndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hwndParent))), true);
  // 0x10: pointer
  if (data?.hInstance !== undefined) view.setBigUint64(16, data.hInstance === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hInstance))), true);
  // 0x18: buffer
  if (data?.pTemplateName !== undefined) {
    (buf as any)._f24 = util.pstrToFfi(data.pTemplateName);
    view.setBigUint64(24, (buf as any)._f24 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f24))), true);
  }
  // 0x20: u32
  if (data?.dwFlags !== undefined) view.setUint32(32, Number(data.dwFlags), true);
  // 0x24: pad4
  // 0x28: buffer
  if (data?.szTitle !== undefined) {
    (buf as any)._f40 = util.pstrToFfi(data.szTitle);
    view.setBigUint64(40, (buf as any)._f40 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f40))), true);
  }
  // 0x30: u32
  if (data?.cCertStore !== undefined) view.setUint32(48, Number(data.cCertStore), true);
  // 0x34: pad4
  // 0x38: pointer
  if (data?.arrayCertStore !== undefined) view.setBigUint64(56, data.arrayCertStore === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayCertStore))), true);
  // 0x40: buffer
  if (data?.szPurposeOid !== undefined) {
    (buf as any)._f64 = util.pstrToFfi(data.szPurposeOid);
    view.setBigUint64(64, (buf as any)._f64 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f64))), true);
  }
  // 0x48: u32
  if (data?.cCertContext !== undefined) view.setUint32(72, Number(data.cCertContext), true);
  // 0x4c: pad4
  // 0x50: pointer
  if (data?.arrayCertContext !== undefined) view.setBigUint64(80, data.arrayCertContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayCertContext))), true);
  // 0x58: pointer
  if (data?.lCustData !== undefined) view.setBigUint64(88, data.lCustData === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.lCustData))), true);
  // 0x60: pointer
  if (data?.pfnHook !== undefined) view.setBigUint64(96, data.pfnHook === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pfnHook))), true);
  // 0x68: pointer
  if (data?.pfnFilter !== undefined) view.setBigUint64(104, data.pfnFilter === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pfnFilter))), true);
  // 0x70: buffer
  if (data?.szHelpFileName !== undefined) {
    (buf as any)._f112 = util.pstrToFfi(data.szHelpFileName);
    view.setBigUint64(112, (buf as any)._f112 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f112))), true);
  }
  // 0x78: u32
  if (data?.dwHelpId !== undefined) view.setUint32(120, Number(data.dwHelpId), true);
  // 0x7c: pad4
  // 0x80: usize
  if (data?.hprov !== undefined) view.setBigUint64(128, BigInt(data.hprov), true);
  return buf;
}

export class CERT_SELECT_STRUCT_AView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get hwndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get hInstance(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: buffer
  get pTemplateName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: u32
  get dwFlags(): number {
    return this.view.getUint32(32, true);
  }

  // 0x24: pad4

  // 0x28: buffer
  get szTitle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: u32
  get cCertStore(): number {
    return this.view.getUint32(48, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  get arrayCertStore(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(56, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x40: buffer
  get szPurposeOid(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(64, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x48: u32
  get cCertContext(): number {
    return this.view.getUint32(72, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  get arrayCertContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(80, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x58: pointer
  get lCustData(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(88, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x60: pointer
  get pfnHook(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(96, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x68: pointer
  get pfnFilter(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(104, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x70: buffer
  get szHelpFileName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(112, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x78: u32
  get dwHelpId(): number {
    return this.view.getUint32(120, true);
  }

  // 0x7c: pad4

  // 0x80: usize
  get hprov(): bigint | number {
    return Number(this.view.getBigUint64(128, true));
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set hwndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: pointer
  set hInstance(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: buffer
  set pTemplateName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f24 = value;
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f24))), true);
  }

  // 0x20: u32
  set dwFlags(value: number) {
    this.view.setUint32(32, value, true);
  }

  // 0x24: pad4

  // 0x28: buffer
  set szTitle(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f40 = value;
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f40))), true);
  }

  // 0x30: u32
  set cCertStore(value: number) {
    this.view.setUint32(48, value, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  set arrayCertStore(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(56, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x40: buffer
  set szPurposeOid(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f64 = value;
    this.view.setBigUint64(64, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f64))), true);
  }

  // 0x48: u32
  set cCertContext(value: number) {
    this.view.setUint32(72, value, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  set arrayCertContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(80, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x58: pointer
  set lCustData(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(88, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x60: pointer
  set pfnHook(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(96, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x68: pointer
  set pfnFilter(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(104, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x70: buffer
  set szHelpFileName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f112 = value;
    this.view.setBigUint64(112, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f112))), true);
  }

  // 0x78: u32
  set dwHelpId(value: number) {
    this.view.setUint32(120, value, true);
  }

  // 0x7c: pad4

  // 0x80: usize
  set hprov(value: bigint | number) {
    this.view.setBigUint64(128, BigInt(value), true);
  }
}

export type PWSTR = Deno.PointerValue | Uint8Array;

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_SELECT_STRUCT_W (size: 136)
 */
export interface CERT_SELECT_STRUCT_W {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.HWND */
  hwndParent: Deno.PointerValue;
  /** Windows.Win32.Foundation.HINSTANCE */
  hInstance: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.PWSTR */
  pTemplateName: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Security.Cryptography.UI.CERT_SELECT_STRUCT_FLAGS */
  dwFlags: CERT_SELECT_STRUCT_FLAGS;
  /** Windows.Win32.Foundation.PWSTR */
  szTitle: string | null | Uint8Array | Uint16Array;
  /** u32 */
  cCertStore: number;
  /** ptr */
  arrayCertStore: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.PSTR */
  szPurposeOid: string | null | Uint8Array;
  /** u32 */
  cCertContext: number;
  /** ptr */
  arrayCertContext: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.LPARAM */
  lCustData: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.PFNCMHOOKPROC */
  pfnHook: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.PFNCMFILTERPROC */
  pfnFilter: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.PWSTR */
  szHelpFileName: string | null | Uint8Array | Uint16Array;
  /** u32 */
  dwHelpId: number;
  /** usize */
  hprov: bigint | number;
}

export const sizeofCERT_SELECT_STRUCT_W = 136;

export function allocCERT_SELECT_STRUCT_W(data?: Partial<CERT_SELECT_STRUCT_W>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_SELECT_STRUCT_W);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.hwndParent !== undefined) view.setBigUint64(8, data.hwndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hwndParent))), true);
  // 0x10: pointer
  if (data?.hInstance !== undefined) view.setBigUint64(16, data.hInstance === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hInstance))), true);
  // 0x18: buffer
  if (data?.pTemplateName !== undefined) {
    (buf as any)._f24 = util.pwstrToFfi(data.pTemplateName);
    view.setBigUint64(24, (buf as any)._f24 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f24))), true);
  }
  // 0x20: u32
  if (data?.dwFlags !== undefined) view.setUint32(32, Number(data.dwFlags), true);
  // 0x24: pad4
  // 0x28: buffer
  if (data?.szTitle !== undefined) {
    (buf as any)._f40 = util.pwstrToFfi(data.szTitle);
    view.setBigUint64(40, (buf as any)._f40 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f40))), true);
  }
  // 0x30: u32
  if (data?.cCertStore !== undefined) view.setUint32(48, Number(data.cCertStore), true);
  // 0x34: pad4
  // 0x38: pointer
  if (data?.arrayCertStore !== undefined) view.setBigUint64(56, data.arrayCertStore === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayCertStore))), true);
  // 0x40: buffer
  if (data?.szPurposeOid !== undefined) {
    (buf as any)._f64 = util.pstrToFfi(data.szPurposeOid);
    view.setBigUint64(64, (buf as any)._f64 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f64))), true);
  }
  // 0x48: u32
  if (data?.cCertContext !== undefined) view.setUint32(72, Number(data.cCertContext), true);
  // 0x4c: pad4
  // 0x50: pointer
  if (data?.arrayCertContext !== undefined) view.setBigUint64(80, data.arrayCertContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayCertContext))), true);
  // 0x58: pointer
  if (data?.lCustData !== undefined) view.setBigUint64(88, data.lCustData === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.lCustData))), true);
  // 0x60: pointer
  if (data?.pfnHook !== undefined) view.setBigUint64(96, data.pfnHook === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pfnHook))), true);
  // 0x68: pointer
  if (data?.pfnFilter !== undefined) view.setBigUint64(104, data.pfnFilter === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pfnFilter))), true);
  // 0x70: buffer
  if (data?.szHelpFileName !== undefined) {
    (buf as any)._f112 = util.pwstrToFfi(data.szHelpFileName);
    view.setBigUint64(112, (buf as any)._f112 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f112))), true);
  }
  // 0x78: u32
  if (data?.dwHelpId !== undefined) view.setUint32(120, Number(data.dwHelpId), true);
  // 0x7c: pad4
  // 0x80: usize
  if (data?.hprov !== undefined) view.setBigUint64(128, BigInt(data.hprov), true);
  return buf;
}

export class CERT_SELECT_STRUCT_WView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get hwndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get hInstance(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: buffer
  get pTemplateName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: u32
  get dwFlags(): number {
    return this.view.getUint32(32, true);
  }

  // 0x24: pad4

  // 0x28: buffer
  get szTitle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: u32
  get cCertStore(): number {
    return this.view.getUint32(48, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  get arrayCertStore(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(56, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x40: buffer
  get szPurposeOid(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(64, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x48: u32
  get cCertContext(): number {
    return this.view.getUint32(72, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  get arrayCertContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(80, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x58: pointer
  get lCustData(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(88, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x60: pointer
  get pfnHook(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(96, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x68: pointer
  get pfnFilter(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(104, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x70: buffer
  get szHelpFileName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(112, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x78: u32
  get dwHelpId(): number {
    return this.view.getUint32(120, true);
  }

  // 0x7c: pad4

  // 0x80: usize
  get hprov(): bigint | number {
    return Number(this.view.getBigUint64(128, true));
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set hwndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: pointer
  set hInstance(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: buffer
  set pTemplateName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f24 = value;
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f24))), true);
  }

  // 0x20: u32
  set dwFlags(value: number) {
    this.view.setUint32(32, value, true);
  }

  // 0x24: pad4

  // 0x28: buffer
  set szTitle(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f40 = value;
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f40))), true);
  }

  // 0x30: u32
  set cCertStore(value: number) {
    this.view.setUint32(48, value, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  set arrayCertStore(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(56, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x40: buffer
  set szPurposeOid(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f64 = value;
    this.view.setBigUint64(64, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f64))), true);
  }

  // 0x48: u32
  set cCertContext(value: number) {
    this.view.setUint32(72, value, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  set arrayCertContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(80, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x58: pointer
  set lCustData(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(88, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x60: pointer
  set pfnHook(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(96, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x68: pointer
  set pfnFilter(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(104, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x70: buffer
  set szHelpFileName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f112 = value;
    this.view.setBigUint64(112, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f112))), true);
  }

  // 0x78: u32
  set dwHelpId(value: number) {
    this.view.setUint32(120, value, true);
  }

  // 0x7c: pad4

  // 0x80: usize
  set hprov(value: bigint | number) {
    this.view.setBigUint64(128, BigInt(value), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_VIEWPROPERTIES_STRUCT_A (size: 160)
 */
export interface CERT_VIEWPROPERTIES_STRUCT_A {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.HWND */
  hwndParent: Deno.PointerValue;
  /** Windows.Win32.Foundation.HINSTANCE */
  hInstance: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.CERT_VIEWPROPERTIES_STRUCT_FLAGS */
  dwFlags: CERT_VIEWPROPERTIES_STRUCT_FLAGS;
  /** Windows.Win32.Foundation.PSTR */
  szTitle: string | null | Uint8Array;
  /** ptr */
  pCertContext: Deno.PointerValue | Uint8Array;
  /** ptr */
  arrayPurposes: Deno.PointerValue | Uint8Array;
  /** u32 */
  cArrayPurposes: number;
  /** u32 */
  cRootStores: number;
  /** ptr */
  rghstoreRoots: Deno.PointerValue | Uint8Array;
  /** u32 */
  cStores: number;
  /** ptr */
  rghstoreCAs: Deno.PointerValue | Uint8Array;
  /** u32 */
  cTrustStores: number;
  /** ptr */
  rghstoreTrust: Deno.PointerValue | Uint8Array;
  /** usize */
  hprov: bigint | number;
  /** Windows.Win32.Foundation.LPARAM */
  lCustData: Uint8Array | Deno.PointerValue;
  /** u32 */
  dwPad: number;
  /** Windows.Win32.Foundation.PSTR */
  szHelpFileName: string | null | Uint8Array;
  /** u32 */
  dwHelpId: number;
  /** u32 */
  nStartPage: number;
  /** u32 */
  cArrayPropSheetPages: number;
  /** ptr */
  arrayPropSheetPages: Deno.PointerValue | Uint8Array;
}

export const sizeofCERT_VIEWPROPERTIES_STRUCT_A = 160;

export function allocCERT_VIEWPROPERTIES_STRUCT_A(data?: Partial<CERT_VIEWPROPERTIES_STRUCT_A>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_VIEWPROPERTIES_STRUCT_A);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.hwndParent !== undefined) view.setBigUint64(8, data.hwndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hwndParent))), true);
  // 0x10: pointer
  if (data?.hInstance !== undefined) view.setBigUint64(16, data.hInstance === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hInstance))), true);
  // 0x18: u32
  if (data?.dwFlags !== undefined) view.setUint32(24, Number(data.dwFlags), true);
  // 0x1c: pad4
  // 0x20: buffer
  if (data?.szTitle !== undefined) {
    (buf as any)._f32 = util.pstrToFfi(data.szTitle);
    view.setBigUint64(32, (buf as any)._f32 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f32))), true);
  }
  // 0x28: pointer
  if (data?.pCertContext !== undefined) view.setBigUint64(40, data.pCertContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pCertContext))), true);
  // 0x30: pointer
  if (data?.arrayPurposes !== undefined) view.setBigUint64(48, data.arrayPurposes === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayPurposes))), true);
  // 0x38: u32
  if (data?.cArrayPurposes !== undefined) view.setUint32(56, Number(data.cArrayPurposes), true);
  // 0x3c: u32
  if (data?.cRootStores !== undefined) view.setUint32(60, Number(data.cRootStores), true);
  // 0x40: pointer
  if (data?.rghstoreRoots !== undefined) view.setBigUint64(64, data.rghstoreRoots === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreRoots))), true);
  // 0x48: u32
  if (data?.cStores !== undefined) view.setUint32(72, Number(data.cStores), true);
  // 0x4c: pad4
  // 0x50: pointer
  if (data?.rghstoreCAs !== undefined) view.setBigUint64(80, data.rghstoreCAs === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreCAs))), true);
  // 0x58: u32
  if (data?.cTrustStores !== undefined) view.setUint32(88, Number(data.cTrustStores), true);
  // 0x5c: pad4
  // 0x60: pointer
  if (data?.rghstoreTrust !== undefined) view.setBigUint64(96, data.rghstoreTrust === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreTrust))), true);
  // 0x68: usize
  if (data?.hprov !== undefined) view.setBigUint64(104, BigInt(data.hprov), true);
  // 0x70: pointer
  if (data?.lCustData !== undefined) view.setBigUint64(112, data.lCustData === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.lCustData))), true);
  // 0x78: u32
  if (data?.dwPad !== undefined) view.setUint32(120, Number(data.dwPad), true);
  // 0x7c: pad4
  // 0x80: buffer
  if (data?.szHelpFileName !== undefined) {
    (buf as any)._f128 = util.pstrToFfi(data.szHelpFileName);
    view.setBigUint64(128, (buf as any)._f128 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f128))), true);
  }
  // 0x88: u32
  if (data?.dwHelpId !== undefined) view.setUint32(136, Number(data.dwHelpId), true);
  // 0x8c: u32
  if (data?.nStartPage !== undefined) view.setUint32(140, Number(data.nStartPage), true);
  // 0x90: u32
  if (data?.cArrayPropSheetPages !== undefined) view.setUint32(144, Number(data.cArrayPropSheetPages), true);
  // 0x94: pad4
  // 0x98: pointer
  if (data?.arrayPropSheetPages !== undefined) view.setBigUint64(152, data.arrayPropSheetPages === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayPropSheetPages))), true);
  return buf;
}

export class CERT_VIEWPROPERTIES_STRUCT_AView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get hwndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get hInstance(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get dwFlags(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x20: buffer
  get szTitle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: pointer
  get pCertContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: pointer
  get arrayPurposes(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x38: u32
  get cArrayPurposes(): number {
    return this.view.getUint32(56, true);
  }

  // 0x3c: u32
  get cRootStores(): number {
    return this.view.getUint32(60, true);
  }

  // 0x40: pointer
  get rghstoreRoots(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(64, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x48: u32
  get cStores(): number {
    return this.view.getUint32(72, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  get rghstoreCAs(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(80, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x58: u32
  get cTrustStores(): number {
    return this.view.getUint32(88, true);
  }

  // 0x5c: pad4

  // 0x60: pointer
  get rghstoreTrust(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(96, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x68: usize
  get hprov(): bigint | number {
    return Number(this.view.getBigUint64(104, true));
  }

  // 0x70: pointer
  get lCustData(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(112, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x78: u32
  get dwPad(): number {
    return this.view.getUint32(120, true);
  }

  // 0x7c: pad4

  // 0x80: buffer
  get szHelpFileName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(128, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x88: u32
  get dwHelpId(): number {
    return this.view.getUint32(136, true);
  }

  // 0x8c: u32
  get nStartPage(): number {
    return this.view.getUint32(140, true);
  }

  // 0x90: u32
  get cArrayPropSheetPages(): number {
    return this.view.getUint32(144, true);
  }

  // 0x94: pad4

  // 0x98: pointer
  get arrayPropSheetPages(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(152, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set hwndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: pointer
  set hInstance(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: u32
  set dwFlags(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4

  // 0x20: buffer
  set szTitle(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f32 = value;
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f32))), true);
  }

  // 0x28: pointer
  set pCertContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x30: pointer
  set arrayPurposes(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x38: u32
  set cArrayPurposes(value: number) {
    this.view.setUint32(56, value, true);
  }

  // 0x3c: u32
  set cRootStores(value: number) {
    this.view.setUint32(60, value, true);
  }

  // 0x40: pointer
  set rghstoreRoots(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(64, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x48: u32
  set cStores(value: number) {
    this.view.setUint32(72, value, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  set rghstoreCAs(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(80, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x58: u32
  set cTrustStores(value: number) {
    this.view.setUint32(88, value, true);
  }

  // 0x5c: pad4

  // 0x60: pointer
  set rghstoreTrust(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(96, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x68: usize
  set hprov(value: bigint | number) {
    this.view.setBigUint64(104, BigInt(value), true);
  }

  // 0x70: pointer
  set lCustData(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(112, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x78: u32
  set dwPad(value: number) {
    this.view.setUint32(120, value, true);
  }

  // 0x7c: pad4

  // 0x80: buffer
  set szHelpFileName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f128 = value;
    this.view.setBigUint64(128, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f128))), true);
  }

  // 0x88: u32
  set dwHelpId(value: number) {
    this.view.setUint32(136, value, true);
  }

  // 0x8c: u32
  set nStartPage(value: number) {
    this.view.setUint32(140, value, true);
  }

  // 0x90: u32
  set cArrayPropSheetPages(value: number) {
    this.view.setUint32(144, value, true);
  }

  // 0x94: pad4

  // 0x98: pointer
  set arrayPropSheetPages(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(152, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_VIEWPROPERTIES_STRUCT_W (size: 160)
 */
export interface CERT_VIEWPROPERTIES_STRUCT_W {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.HWND */
  hwndParent: Deno.PointerValue;
  /** Windows.Win32.Foundation.HINSTANCE */
  hInstance: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.CERT_VIEWPROPERTIES_STRUCT_FLAGS */
  dwFlags: CERT_VIEWPROPERTIES_STRUCT_FLAGS;
  /** Windows.Win32.Foundation.PWSTR */
  szTitle: string | null | Uint8Array | Uint16Array;
  /** ptr */
  pCertContext: Deno.PointerValue | Uint8Array;
  /** ptr */
  arrayPurposes: Deno.PointerValue | Uint8Array;
  /** u32 */
  cArrayPurposes: number;
  /** u32 */
  cRootStores: number;
  /** ptr */
  rghstoreRoots: Deno.PointerValue | Uint8Array;
  /** u32 */
  cStores: number;
  /** ptr */
  rghstoreCAs: Deno.PointerValue | Uint8Array;
  /** u32 */
  cTrustStores: number;
  /** ptr */
  rghstoreTrust: Deno.PointerValue | Uint8Array;
  /** usize */
  hprov: bigint | number;
  /** Windows.Win32.Foundation.LPARAM */
  lCustData: Uint8Array | Deno.PointerValue;
  /** u32 */
  dwPad: number;
  /** Windows.Win32.Foundation.PWSTR */
  szHelpFileName: string | null | Uint8Array | Uint16Array;
  /** u32 */
  dwHelpId: number;
  /** u32 */
  nStartPage: number;
  /** u32 */
  cArrayPropSheetPages: number;
  /** ptr */
  arrayPropSheetPages: Deno.PointerValue | Uint8Array;
}

export const sizeofCERT_VIEWPROPERTIES_STRUCT_W = 160;

export function allocCERT_VIEWPROPERTIES_STRUCT_W(data?: Partial<CERT_VIEWPROPERTIES_STRUCT_W>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_VIEWPROPERTIES_STRUCT_W);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.hwndParent !== undefined) view.setBigUint64(8, data.hwndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hwndParent))), true);
  // 0x10: pointer
  if (data?.hInstance !== undefined) view.setBigUint64(16, data.hInstance === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hInstance))), true);
  // 0x18: u32
  if (data?.dwFlags !== undefined) view.setUint32(24, Number(data.dwFlags), true);
  // 0x1c: pad4
  // 0x20: buffer
  if (data?.szTitle !== undefined) {
    (buf as any)._f32 = util.pwstrToFfi(data.szTitle);
    view.setBigUint64(32, (buf as any)._f32 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f32))), true);
  }
  // 0x28: pointer
  if (data?.pCertContext !== undefined) view.setBigUint64(40, data.pCertContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pCertContext))), true);
  // 0x30: pointer
  if (data?.arrayPurposes !== undefined) view.setBigUint64(48, data.arrayPurposes === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayPurposes))), true);
  // 0x38: u32
  if (data?.cArrayPurposes !== undefined) view.setUint32(56, Number(data.cArrayPurposes), true);
  // 0x3c: u32
  if (data?.cRootStores !== undefined) view.setUint32(60, Number(data.cRootStores), true);
  // 0x40: pointer
  if (data?.rghstoreRoots !== undefined) view.setBigUint64(64, data.rghstoreRoots === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreRoots))), true);
  // 0x48: u32
  if (data?.cStores !== undefined) view.setUint32(72, Number(data.cStores), true);
  // 0x4c: pad4
  // 0x50: pointer
  if (data?.rghstoreCAs !== undefined) view.setBigUint64(80, data.rghstoreCAs === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreCAs))), true);
  // 0x58: u32
  if (data?.cTrustStores !== undefined) view.setUint32(88, Number(data.cTrustStores), true);
  // 0x5c: pad4
  // 0x60: pointer
  if (data?.rghstoreTrust !== undefined) view.setBigUint64(96, data.rghstoreTrust === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreTrust))), true);
  // 0x68: usize
  if (data?.hprov !== undefined) view.setBigUint64(104, BigInt(data.hprov), true);
  // 0x70: pointer
  if (data?.lCustData !== undefined) view.setBigUint64(112, data.lCustData === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.lCustData))), true);
  // 0x78: u32
  if (data?.dwPad !== undefined) view.setUint32(120, Number(data.dwPad), true);
  // 0x7c: pad4
  // 0x80: buffer
  if (data?.szHelpFileName !== undefined) {
    (buf as any)._f128 = util.pwstrToFfi(data.szHelpFileName);
    view.setBigUint64(128, (buf as any)._f128 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f128))), true);
  }
  // 0x88: u32
  if (data?.dwHelpId !== undefined) view.setUint32(136, Number(data.dwHelpId), true);
  // 0x8c: u32
  if (data?.nStartPage !== undefined) view.setUint32(140, Number(data.nStartPage), true);
  // 0x90: u32
  if (data?.cArrayPropSheetPages !== undefined) view.setUint32(144, Number(data.cArrayPropSheetPages), true);
  // 0x94: pad4
  // 0x98: pointer
  if (data?.arrayPropSheetPages !== undefined) view.setBigUint64(152, data.arrayPropSheetPages === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayPropSheetPages))), true);
  return buf;
}

export class CERT_VIEWPROPERTIES_STRUCT_WView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get hwndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get hInstance(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get dwFlags(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x20: buffer
  get szTitle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: pointer
  get pCertContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: pointer
  get arrayPurposes(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x38: u32
  get cArrayPurposes(): number {
    return this.view.getUint32(56, true);
  }

  // 0x3c: u32
  get cRootStores(): number {
    return this.view.getUint32(60, true);
  }

  // 0x40: pointer
  get rghstoreRoots(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(64, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x48: u32
  get cStores(): number {
    return this.view.getUint32(72, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  get rghstoreCAs(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(80, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x58: u32
  get cTrustStores(): number {
    return this.view.getUint32(88, true);
  }

  // 0x5c: pad4

  // 0x60: pointer
  get rghstoreTrust(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(96, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x68: usize
  get hprov(): bigint | number {
    return Number(this.view.getBigUint64(104, true));
  }

  // 0x70: pointer
  get lCustData(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(112, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x78: u32
  get dwPad(): number {
    return this.view.getUint32(120, true);
  }

  // 0x7c: pad4

  // 0x80: buffer
  get szHelpFileName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(128, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x88: u32
  get dwHelpId(): number {
    return this.view.getUint32(136, true);
  }

  // 0x8c: u32
  get nStartPage(): number {
    return this.view.getUint32(140, true);
  }

  // 0x90: u32
  get cArrayPropSheetPages(): number {
    return this.view.getUint32(144, true);
  }

  // 0x94: pad4

  // 0x98: pointer
  get arrayPropSheetPages(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(152, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set hwndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: pointer
  set hInstance(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: u32
  set dwFlags(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4

  // 0x20: buffer
  set szTitle(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f32 = value;
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f32))), true);
  }

  // 0x28: pointer
  set pCertContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x30: pointer
  set arrayPurposes(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x38: u32
  set cArrayPurposes(value: number) {
    this.view.setUint32(56, value, true);
  }

  // 0x3c: u32
  set cRootStores(value: number) {
    this.view.setUint32(60, value, true);
  }

  // 0x40: pointer
  set rghstoreRoots(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(64, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x48: u32
  set cStores(value: number) {
    this.view.setUint32(72, value, true);
  }

  // 0x4c: pad4

  // 0x50: pointer
  set rghstoreCAs(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(80, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x58: u32
  set cTrustStores(value: number) {
    this.view.setUint32(88, value, true);
  }

  // 0x5c: pad4

  // 0x60: pointer
  set rghstoreTrust(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(96, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x68: usize
  set hprov(value: bigint | number) {
    this.view.setBigUint64(104, BigInt(value), true);
  }

  // 0x70: pointer
  set lCustData(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(112, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x78: u32
  set dwPad(value: number) {
    this.view.setUint32(120, value, true);
  }

  // 0x7c: pad4

  // 0x80: buffer
  set szHelpFileName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f128 = value;
    this.view.setBigUint64(128, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f128))), true);
  }

  // 0x88: u32
  set dwHelpId(value: number) {
    this.view.setUint32(136, value, true);
  }

  // 0x8c: u32
  set nStartPage(value: number) {
    this.view.setUint32(140, value, true);
  }

  // 0x90: u32
  set cArrayPropSheetPages(value: number) {
    this.view.setUint32(144, value, true);
  }

  // 0x94: pad4

  // 0x98: pointer
  set arrayPropSheetPages(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(152, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_FILTER_EXTENSION_MATCH (size: 32)
 */
export interface CERT_FILTER_EXTENSION_MATCH {
  /** Windows.Win32.Foundation.PSTR */
  szExtensionOID: string | null | Uint8Array;
  /** u32 */
  dwTestOperation: number;
  /** ptr */
  pbTestData: Deno.PointerValue | Uint8Array;
  /** u32 */
  cbTestData: number;
}

export const sizeofCERT_FILTER_EXTENSION_MATCH = 32;

export function allocCERT_FILTER_EXTENSION_MATCH(data?: Partial<CERT_FILTER_EXTENSION_MATCH>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_FILTER_EXTENSION_MATCH);
  const view = new DataView(buf.buffer);
  // 0x00: buffer
  if (data?.szExtensionOID !== undefined) {
    (buf as any)._f0 = util.pstrToFfi(data.szExtensionOID);
    view.setBigUint64(0, (buf as any)._f0 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f0))), true);
  }
  // 0x08: u32
  if (data?.dwTestOperation !== undefined) view.setUint32(8, Number(data.dwTestOperation), true);
  // 0x0c: pad4
  // 0x10: pointer
  if (data?.pbTestData !== undefined) view.setBigUint64(16, data.pbTestData === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pbTestData))), true);
  // 0x18: u32
  if (data?.cbTestData !== undefined) view.setUint32(24, Number(data.cbTestData), true);
  // 0x1c: pad4
  return buf;
}

export class CERT_FILTER_EXTENSION_MATCHView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: buffer
  get szExtensionOID(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get dwTestOperation(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  get pbTestData(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get cbTestData(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x00: buffer
  set szExtensionOID(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f0 = value;
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f0))), true);
  }

  // 0x08: u32
  set dwTestOperation(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  set pbTestData(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: u32
  set cbTestData(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4
}

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_FILTER_DATA (size: 24)
 */
export interface CERT_FILTER_DATA {
  /** u32 */
  dwSize: number;
  /** u32 */
  cExtensionChecks: number;
  /** ptr */
  arrayExtensionChecks: Deno.PointerValue | Uint8Array;
  /** u32 */
  dwCheckingFlags: number;
}

export const sizeofCERT_FILTER_DATA = 24;

export function allocCERT_FILTER_DATA(data?: Partial<CERT_FILTER_DATA>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_FILTER_DATA);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: u32
  if (data?.cExtensionChecks !== undefined) view.setUint32(4, Number(data.cExtensionChecks), true);
  // 0x08: pointer
  if (data?.arrayExtensionChecks !== undefined) view.setBigUint64(8, data.arrayExtensionChecks === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.arrayExtensionChecks))), true);
  // 0x10: u32
  if (data?.dwCheckingFlags !== undefined) view.setUint32(16, Number(data.dwCheckingFlags), true);
  // 0x14: pad4
  return buf;
}

export class CERT_FILTER_DATAView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get cExtensionChecks(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: pointer
  get arrayExtensionChecks(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwCheckingFlags(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set cExtensionChecks(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: pointer
  set arrayExtensionChecks(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set dwCheckingFlags(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4
}

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_VERIFY_CERTIFICATE_TRUST (size: 144)
 */
export interface CERT_VERIFY_CERTIFICATE_TRUST {
  /** u32 */
  cbSize: number;
  /** ptr */
  pccert: Deno.PointerValue | Uint8Array;
  /** u32 */
  dwFlags: number;
  /** u32 */
  dwIgnoreErr: number;
  /** ptr */
  pdwErrors: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.PSTR */
  pszUsageOid: string | null | Uint8Array;
  /** usize */
  hprov: bigint | number;
  /** u32 */
  cRootStores: number;
  /** ptr */
  rghstoreRoots: Deno.PointerValue | Uint8Array;
  /** u32 */
  cStores: number;
  /** ptr */
  rghstoreCAs: Deno.PointerValue | Uint8Array;
  /** u32 */
  cTrustStores: number;
  /** ptr */
  rghstoreTrust: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.LPARAM */
  lCustData: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.PFNTRUSTHELPER */
  pfnTrustHelper: Uint8Array | Deno.PointerValue;
  /** ptr */
  pcChain: Deno.PointerValue | Uint8Array;
  /** ptr */
  prgChain: Deno.PointerValue | Uint8Array;
  /** ptr */
  prgdwErrors: Deno.PointerValue | Uint8Array;
  /** ptr */
  prgpbTrustInfo: Deno.PointerValue | Uint8Array;
}

export const sizeofCERT_VERIFY_CERTIFICATE_TRUST = 144;

export function allocCERT_VERIFY_CERTIFICATE_TRUST(data?: Partial<CERT_VERIFY_CERTIFICATE_TRUST>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_VERIFY_CERTIFICATE_TRUST);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.cbSize !== undefined) view.setUint32(0, Number(data.cbSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.pccert !== undefined) view.setBigUint64(8, data.pccert === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pccert))), true);
  // 0x10: u32
  if (data?.dwFlags !== undefined) view.setUint32(16, Number(data.dwFlags), true);
  // 0x14: u32
  if (data?.dwIgnoreErr !== undefined) view.setUint32(20, Number(data.dwIgnoreErr), true);
  // 0x18: pointer
  if (data?.pdwErrors !== undefined) view.setBigUint64(24, data.pdwErrors === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pdwErrors))), true);
  // 0x20: buffer
  if (data?.pszUsageOid !== undefined) {
    (buf as any)._f32 = util.pstrToFfi(data.pszUsageOid);
    view.setBigUint64(32, (buf as any)._f32 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f32))), true);
  }
  // 0x28: usize
  if (data?.hprov !== undefined) view.setBigUint64(40, BigInt(data.hprov), true);
  // 0x30: u32
  if (data?.cRootStores !== undefined) view.setUint32(48, Number(data.cRootStores), true);
  // 0x34: pad4
  // 0x38: pointer
  if (data?.rghstoreRoots !== undefined) view.setBigUint64(56, data.rghstoreRoots === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreRoots))), true);
  // 0x40: u32
  if (data?.cStores !== undefined) view.setUint32(64, Number(data.cStores), true);
  // 0x44: pad4
  // 0x48: pointer
  if (data?.rghstoreCAs !== undefined) view.setBigUint64(72, data.rghstoreCAs === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreCAs))), true);
  // 0x50: u32
  if (data?.cTrustStores !== undefined) view.setUint32(80, Number(data.cTrustStores), true);
  // 0x54: pad4
  // 0x58: pointer
  if (data?.rghstoreTrust !== undefined) view.setBigUint64(88, data.rghstoreTrust === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghstoreTrust))), true);
  // 0x60: pointer
  if (data?.lCustData !== undefined) view.setBigUint64(96, data.lCustData === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.lCustData))), true);
  // 0x68: pointer
  if (data?.pfnTrustHelper !== undefined) view.setBigUint64(104, data.pfnTrustHelper === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pfnTrustHelper))), true);
  // 0x70: pointer
  if (data?.pcChain !== undefined) view.setBigUint64(112, data.pcChain === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pcChain))), true);
  // 0x78: pointer
  if (data?.prgChain !== undefined) view.setBigUint64(120, data.prgChain === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.prgChain))), true);
  // 0x80: pointer
  if (data?.prgdwErrors !== undefined) view.setBigUint64(128, data.prgdwErrors === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.prgdwErrors))), true);
  // 0x88: pointer
  if (data?.prgpbTrustInfo !== undefined) view.setBigUint64(136, data.prgpbTrustInfo === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.prgpbTrustInfo))), true);
  return buf;
}

export class CERT_VERIFY_CERTIFICATE_TRUSTView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get cbSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get pccert(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwFlags(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: u32
  get dwIgnoreErr(): number {
    return this.view.getUint32(20, true);
  }

  // 0x18: pointer
  get pdwErrors(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: buffer
  get pszUsageOid(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: usize
  get hprov(): bigint | number {
    return Number(this.view.getBigUint64(40, true));
  }

  // 0x30: u32
  get cRootStores(): number {
    return this.view.getUint32(48, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  get rghstoreRoots(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(56, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x40: u32
  get cStores(): number {
    return this.view.getUint32(64, true);
  }

  // 0x44: pad4

  // 0x48: pointer
  get rghstoreCAs(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(72, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x50: u32
  get cTrustStores(): number {
    return this.view.getUint32(80, true);
  }

  // 0x54: pad4

  // 0x58: pointer
  get rghstoreTrust(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(88, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x60: pointer
  get lCustData(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(96, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x68: pointer
  get pfnTrustHelper(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(104, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x70: pointer
  get pcChain(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(112, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x78: pointer
  get prgChain(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(120, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x80: pointer
  get prgdwErrors(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(128, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x88: pointer
  get prgpbTrustInfo(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(136, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set cbSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set pccert(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set dwFlags(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: u32
  set dwIgnoreErr(value: number) {
    this.view.setUint32(20, value, true);
  }

  // 0x18: pointer
  set pdwErrors(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: buffer
  set pszUsageOid(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f32 = value;
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f32))), true);
  }

  // 0x28: usize
  set hprov(value: bigint | number) {
    this.view.setBigUint64(40, BigInt(value), true);
  }

  // 0x30: u32
  set cRootStores(value: number) {
    this.view.setUint32(48, value, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  set rghstoreRoots(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(56, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x40: u32
  set cStores(value: number) {
    this.view.setUint32(64, value, true);
  }

  // 0x44: pad4

  // 0x48: pointer
  set rghstoreCAs(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(72, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x50: u32
  set cTrustStores(value: number) {
    this.view.setUint32(80, value, true);
  }

  // 0x54: pad4

  // 0x58: pointer
  set rghstoreTrust(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(88, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x60: pointer
  set lCustData(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(96, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x68: pointer
  set pfnTrustHelper(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(104, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x70: pointer
  set pcChain(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(112, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x78: pointer
  set prgChain(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(120, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x80: pointer
  set prgdwErrors(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(128, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x88: pointer
  set prgpbTrustInfo(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(136, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CTL_MODIFY_REQUEST (size: 16)
 */
export interface CTL_MODIFY_REQUEST {
  /** ptr */
  pccert: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Security.Cryptography.UI.CTL_MODIFY_REQUEST_OPERATION */
  dwOperation: CTL_MODIFY_REQUEST_OPERATION;
  /** u32 */
  dwError: number;
}

export const sizeofCTL_MODIFY_REQUEST = 16;

export function allocCTL_MODIFY_REQUEST(data?: Partial<CTL_MODIFY_REQUEST>): Uint8Array {
  const buf = new Uint8Array(sizeofCTL_MODIFY_REQUEST);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.pccert !== undefined) view.setBigUint64(0, data.pccert === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pccert))), true);
  // 0x08: u32
  if (data?.dwOperation !== undefined) view.setUint32(8, Number(data.dwOperation), true);
  // 0x0c: u32
  if (data?.dwError !== undefined) view.setUint32(12, Number(data.dwError), true);
  return buf;
}

export class CTL_MODIFY_REQUESTView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get pccert(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get dwOperation(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: u32
  get dwError(): number {
    return this.view.getUint32(12, true);
  }

  // 0x00: pointer
  set pccert(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set dwOperation(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: u32
  set dwError(value: number) {
    this.view.setUint32(12, value, true);
  }
}

export type HCERTSTORE = Deno.PointerValue | Uint8Array;

/**
 * Windows.Win32.Security.Cryptography.UI.CERT_SELECTUI_INPUT (size: 24)
 */
export interface CERT_SELECTUI_INPUT {
  /** Windows.Win32.Security.Cryptography.HCERTSTORE */
  hStore: Uint8Array | Deno.PointerValue;
  /** ptr */
  prgpChain: Deno.PointerValue | Uint8Array;
  /** u32 */
  cChain: number;
}

export const sizeofCERT_SELECTUI_INPUT = 24;

export function allocCERT_SELECTUI_INPUT(data?: Partial<CERT_SELECTUI_INPUT>): Uint8Array {
  const buf = new Uint8Array(sizeofCERT_SELECTUI_INPUT);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.hStore !== undefined) view.setBigUint64(0, data.hStore === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hStore))), true);
  // 0x08: pointer
  if (data?.prgpChain !== undefined) view.setBigUint64(8, data.prgpChain === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.prgpChain))), true);
  // 0x10: u32
  if (data?.cChain !== undefined) view.setUint32(16, Number(data.cChain), true);
  // 0x14: pad4
  return buf;
}

export class CERT_SELECTUI_INPUTView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get hStore(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get prgpChain(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get cChain(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x00: pointer
  set hStore(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set prgpChain(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set cChain(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_CERT_MGR_STRUCT (size: 40)
 */
export interface CRYPTUI_CERT_MGR_STRUCT {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.HWND */
  hwndParent: Deno.PointerValue;
  /** u32 */
  dwFlags: number;
  /** Windows.Win32.Foundation.PWSTR */
  pwszTitle: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.PSTR */
  pszInitUsageOID: string | null | Uint8Array;
}

export const sizeofCRYPTUI_CERT_MGR_STRUCT = 40;

export function allocCRYPTUI_CERT_MGR_STRUCT(data?: Partial<CRYPTUI_CERT_MGR_STRUCT>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_CERT_MGR_STRUCT);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.hwndParent !== undefined) view.setBigUint64(8, data.hwndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hwndParent))), true);
  // 0x10: u32
  if (data?.dwFlags !== undefined) view.setUint32(16, Number(data.dwFlags), true);
  // 0x14: pad4
  // 0x18: buffer
  if (data?.pwszTitle !== undefined) {
    (buf as any)._f24 = util.pwstrToFfi(data.pwszTitle);
    view.setBigUint64(24, (buf as any)._f24 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f24))), true);
  }
  // 0x20: buffer
  if (data?.pszInitUsageOID !== undefined) {
    (buf as any)._f32 = util.pstrToFfi(data.pszInitUsageOID);
    view.setBigUint64(32, (buf as any)._f32 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f32))), true);
  }
  return buf;
}

export class CRYPTUI_CERT_MGR_STRUCTView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get hwndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwFlags(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  get pwszTitle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: buffer
  get pszInitUsageOID(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set hwndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set dwFlags(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  set pwszTitle(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f24 = value;
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f24))), true);
  }

  // 0x20: buffer
  set pszInitUsageOID(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f32 = value;
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f32))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO (size: 40)
 */
export interface CRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO {
  /** u32 */
  dwSize: number;
  /** ptr */
  pGuidSubject: Deno.PointerValue | Uint8Array;
  /** u32 */
  cbBlob: number;
  /** ptr */
  pbBlob: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.PWSTR */
  pwszDisplayName: string | null | Uint8Array | Uint16Array;
}

export const sizeofCRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO = 40;

export function allocCRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO(data?: Partial<CRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.pGuidSubject !== undefined) view.setBigUint64(8, data.pGuidSubject === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pGuidSubject))), true);
  // 0x10: u32
  if (data?.cbBlob !== undefined) view.setUint32(16, Number(data.cbBlob), true);
  // 0x14: pad4
  // 0x18: pointer
  if (data?.pbBlob !== undefined) view.setBigUint64(24, data.pbBlob === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pbBlob))), true);
  // 0x20: buffer
  if (data?.pwszDisplayName !== undefined) {
    (buf as any)._f32 = util.pwstrToFfi(data.pwszDisplayName);
    view.setBigUint64(32, (buf as any)._f32 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f32))), true);
  }
  return buf;
}

export class CRYPTUI_WIZ_DIGITAL_SIGN_BLOB_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get pGuidSubject(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get cbBlob(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  get pbBlob(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: buffer
  get pwszDisplayName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set pGuidSubject(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set cbBlob(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  set pbBlob(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: buffer
  set pwszDisplayName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f32 = value;
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f32))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO (size: 32)
 */
export interface CRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO {
  /** u32 */
  dwSize: number;
  /** u32 */
  cCertStore: number;
  /** ptr */
  rghCertStore: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Security.Cryptography.UI.PFNCFILTERPROC */
  pFilterCallback: Uint8Array | Deno.PointerValue;
  /** ptr */
  pvCallbackData: Deno.PointerValue | Uint8Array;
}

export const sizeofCRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO = 32;

export function allocCRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO(data?: Partial<CRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: u32
  if (data?.cCertStore !== undefined) view.setUint32(4, Number(data.cCertStore), true);
  // 0x08: pointer
  if (data?.rghCertStore !== undefined) view.setBigUint64(8, data.rghCertStore === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghCertStore))), true);
  // 0x10: pointer
  if (data?.pFilterCallback !== undefined) view.setBigUint64(16, data.pFilterCallback === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pFilterCallback))), true);
  // 0x18: pointer
  if (data?.pvCallbackData !== undefined) view.setBigUint64(24, data.pvCallbackData === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pvCallbackData))), true);
  return buf;
}

export class CRYPTUI_WIZ_DIGITAL_SIGN_STORE_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get cCertStore(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: pointer
  get rghCertStore(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: pointer
  get pFilterCallback(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: pointer
  get pvCallbackData(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set cCertStore(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: pointer
  set rghCertStore(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: pointer
  set pFilterCallback(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: pointer
  set pvCallbackData(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO (size: 32)
 */
export interface CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.PWSTR */
  pwszPvkFileName: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.PWSTR */
  pwszProvName: string | null | Uint8Array | Uint16Array;
  /** u32 */
  dwProvType: number;
}

export const sizeofCRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO = 32;

export function allocCRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO(data?: Partial<CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: buffer
  if (data?.pwszPvkFileName !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.pwszPvkFileName);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  // 0x10: buffer
  if (data?.pwszProvName !== undefined) {
    (buf as any)._f16 = util.pwstrToFfi(data.pwszProvName);
    view.setBigUint64(16, (buf as any)._f16 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f16))), true);
  }
  // 0x18: u32
  if (data?.dwProvType !== undefined) view.setUint32(24, Number(data.dwProvType), true);
  // 0x1c: pad4
  return buf;
}

export class CRYPTUI_WIZ_DIGITAL_SIGN_PVK_FILE_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  get pwszPvkFileName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: buffer
  get pwszProvName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: u32
  get dwProvType(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: pad4

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  set pwszPvkFileName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }

  // 0x10: buffer
  set pwszProvName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f16 = value;
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f16))), true);
  }

  // 0x18: u32
  set dwProvType(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: pad4
}

/**
 * _Anonymous_e__Struct (size: 16)
 */
export interface _Anonymous_e__Struct {
  /** u64 */
  Alignment: bigint | number;
  /** u64 */
  Region: bigint | number;
}

export const sizeof_Anonymous_e__Struct = 16;

export function alloc_Anonymous_e__Struct(data?: Partial<_Anonymous_e__Struct>): Uint8Array {
  const buf = new Uint8Array(sizeof_Anonymous_e__Struct);
  const view = new DataView(buf.buffer);
  // 0x00: u64
  if (data?.Alignment !== undefined) view.setBigUint64(0, BigInt(data.Alignment), true);
  // 0x08: u64
  if (data?.Region !== undefined) view.setBigUint64(8, BigInt(data.Region), true);
  return buf;
}

export class _Anonymous_e__StructView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u64
  get Alignment(): bigint | number {
    return Number(this.view.getBigUint64(0, true));
  }

  // 0x08: u64
  get Region(): bigint | number {
    return Number(this.view.getBigUint64(8, true));
  }

  // 0x00: u64
  set Alignment(value: bigint | number) {
    this.view.setBigUint64(0, BigInt(value), true);
  }

  // 0x08: u64
  set Region(value: bigint | number) {
    this.view.setBigUint64(8, BigInt(value), true);
  }
}

/**
 * _Anonymous_e__Union (size: 16)
 */
export interface _Anonymous_e__Union {
  /** _Anonymous_e__Struct */
  Anonymous: Uint8Array | Deno.PointerValue;
  /** array */
  X: Deno.PointerValue;
}

export const sizeof_Anonymous_e__Union = 16;

export function alloc_Anonymous_e__Union(data?: Partial<_Anonymous_e__Union>): Uint8Array {
  const buf = new Uint8Array(sizeof_Anonymous_e__Union);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(0, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  // 0x08: pointer
  if (data?.X !== undefined) view.setBigUint64(8, data.X === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.X))), true);
  return buf;
}

export class _Anonymous_e__UnionView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get X(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set X(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO (size: 32)
 */
export interface CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.PWSTR */
  pwszSigningCertFileName: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_PVK_OPTION */
  dwPvkChoice: CRYPTUI_WIZ_DIGITAL_SIGN_PVK_OPTION;
  /** _Anonymous_e__Union */
  Anonymous: Uint8Array | Deno.PointerValue;
}

export const sizeofCRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO = 32;

export function allocCRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO(data?: Partial<CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: buffer
  if (data?.pwszSigningCertFileName !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.pwszSigningCertFileName);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  // 0x10: u32
  if (data?.dwPvkChoice !== undefined) view.setUint32(16, Number(data.dwPvkChoice), true);
  // 0x14: pad4
  // 0x18: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(24, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  return buf;
}

export class CRYPTUI_WIZ_DIGITAL_SIGN_CERT_PVK_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  get pwszSigningCertFileName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwPvkChoice(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  set pwszSigningCertFileName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }

  // 0x10: u32
  set dwPvkChoice(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO (size: 64)
 */
export interface CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_SIG_TYPE */
  dwAttrFlags: CRYPTUI_WIZ_DIGITAL_SIGN_SIG_TYPE;
  /** Windows.Win32.Foundation.PWSTR */
  pwszDescription: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.PWSTR */
  pwszMoreInfoLocation: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.PSTR */
  pszHashAlg: string | null | Uint8Array;
  /** Windows.Win32.Foundation.PWSTR */
  pwszSigningCertDisplayString: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Security.Cryptography.HCERTSTORE */
  hAdditionalCertStore: Uint8Array | Deno.PointerValue;
  /** ptr */
  psAuthenticated: Deno.PointerValue | Uint8Array;
  /** ptr */
  psUnauthenticated: Deno.PointerValue | Uint8Array;
}

export const sizeofCRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO = 64;

export function allocCRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO(data?: Partial<CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: u32
  if (data?.dwAttrFlags !== undefined) view.setUint32(4, Number(data.dwAttrFlags), true);
  // 0x08: buffer
  if (data?.pwszDescription !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.pwszDescription);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  // 0x10: buffer
  if (data?.pwszMoreInfoLocation !== undefined) {
    (buf as any)._f16 = util.pwstrToFfi(data.pwszMoreInfoLocation);
    view.setBigUint64(16, (buf as any)._f16 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f16))), true);
  }
  // 0x18: buffer
  if (data?.pszHashAlg !== undefined) {
    (buf as any)._f24 = util.pstrToFfi(data.pszHashAlg);
    view.setBigUint64(24, (buf as any)._f24 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f24))), true);
  }
  // 0x20: buffer
  if (data?.pwszSigningCertDisplayString !== undefined) {
    (buf as any)._f32 = util.pwstrToFfi(data.pwszSigningCertDisplayString);
    view.setBigUint64(32, (buf as any)._f32 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f32))), true);
  }
  // 0x28: pointer
  if (data?.hAdditionalCertStore !== undefined) view.setBigUint64(40, data.hAdditionalCertStore === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hAdditionalCertStore))), true);
  // 0x30: pointer
  if (data?.psAuthenticated !== undefined) view.setBigUint64(48, data.psAuthenticated === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.psAuthenticated))), true);
  // 0x38: pointer
  if (data?.psUnauthenticated !== undefined) view.setBigUint64(56, data.psUnauthenticated === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.psUnauthenticated))), true);
  return buf;
}

export class CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get dwAttrFlags(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: buffer
  get pwszDescription(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: buffer
  get pwszMoreInfoLocation(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: buffer
  get pszHashAlg(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: buffer
  get pwszSigningCertDisplayString(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: pointer
  get hAdditionalCertStore(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: pointer
  get psAuthenticated(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x38: pointer
  get psUnauthenticated(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(56, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set dwAttrFlags(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: buffer
  set pwszDescription(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }

  // 0x10: buffer
  set pwszMoreInfoLocation(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f16 = value;
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f16))), true);
  }

  // 0x18: buffer
  set pszHashAlg(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f24 = value;
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f24))), true);
  }

  // 0x20: buffer
  set pwszSigningCertDisplayString(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f32 = value;
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f32))), true);
  }

  // 0x28: pointer
  set hAdditionalCertStore(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x30: pointer
  set psAuthenticated(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x38: pointer
  set psUnauthenticated(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(56, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * _Anonymous1_e__Union (size: 64)
 */
export interface _Anonymous1_e__Union {
  /** usize */
  Data0: bigint | number;
  /** Windows.Win32.Foundation.PWSTR */
  String: string | null | Uint8Array | Uint16Array;
  /** usize */
  u: bigint | number;
  /** ptr */
  psid: Deno.PointerValue | Uint8Array;
  /** ptr */
  pguid: Deno.PointerValue | Uint8Array;
  /** u32 */
  LogonId_LowPart: number;
  /** ptr */
  pObjectTypes: Deno.PointerValue | Uint8Array;
  /** ptr */
  pIpAddress: Deno.PointerValue | Uint8Array;
}

export const sizeof_Anonymous1_e__Union = 64;

export function alloc_Anonymous1_e__Union(data?: Partial<_Anonymous1_e__Union>): Uint8Array {
  const buf = new Uint8Array(sizeof_Anonymous1_e__Union);
  const view = new DataView(buf.buffer);
  // 0x00: usize
  if (data?.Data0 !== undefined) view.setBigUint64(0, BigInt(data.Data0), true);
  // 0x08: buffer
  if (data?.String !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.String);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  // 0x10: usize
  if (data?.u !== undefined) view.setBigUint64(16, BigInt(data.u), true);
  // 0x18: pointer
  if (data?.psid !== undefined) view.setBigUint64(24, data.psid === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.psid))), true);
  // 0x20: pointer
  if (data?.pguid !== undefined) view.setBigUint64(32, data.pguid === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pguid))), true);
  // 0x28: u32
  if (data?.LogonId_LowPart !== undefined) view.setUint32(40, Number(data.LogonId_LowPart), true);
  // 0x2c: pad4
  // 0x30: pointer
  if (data?.pObjectTypes !== undefined) view.setBigUint64(48, data.pObjectTypes === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pObjectTypes))), true);
  // 0x38: pointer
  if (data?.pIpAddress !== undefined) view.setBigUint64(56, data.pIpAddress === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pIpAddress))), true);
  return buf;
}

export class _Anonymous1_e__UnionView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: usize
  get Data0(): bigint | number {
    return Number(this.view.getBigUint64(0, true));
  }

  // 0x08: buffer
  get String(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: usize
  get u(): bigint | number {
    return Number(this.view.getBigUint64(16, true));
  }

  // 0x18: pointer
  get psid(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: pointer
  get pguid(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: u32
  get LogonId_LowPart(): number {
    return this.view.getUint32(40, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  get pObjectTypes(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x38: pointer
  get pIpAddress(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(56, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: usize
  set Data0(value: bigint | number) {
    this.view.setBigUint64(0, BigInt(value), true);
  }

  // 0x08: buffer
  set String(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }

  // 0x10: usize
  set u(value: bigint | number) {
    this.view.setBigUint64(16, BigInt(value), true);
  }

  // 0x18: pointer
  set psid(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: pointer
  set pguid(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x28: u32
  set LogonId_LowPart(value: number) {
    this.view.setUint32(40, value, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  set pObjectTypes(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x38: pointer
  set pIpAddress(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(56, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * _Anonymous2_e__Union (size: 16)
 */
export interface _Anonymous2_e__Union {
  /** usize */
  Data1: bigint | number;
  /** i32 */
  LogonId_HighPart: number;
}

export const sizeof_Anonymous2_e__Union = 16;

export function alloc_Anonymous2_e__Union(data?: Partial<_Anonymous2_e__Union>): Uint8Array {
  const buf = new Uint8Array(sizeof_Anonymous2_e__Union);
  const view = new DataView(buf.buffer);
  // 0x00: usize
  if (data?.Data1 !== undefined) view.setBigUint64(0, BigInt(data.Data1), true);
  // 0x08: i32
  if (data?.LogonId_HighPart !== undefined) view.setInt32(8, Number(data.LogonId_HighPart), true);
  // 0x0c: pad4
  return buf;
}

export class _Anonymous2_e__UnionView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: usize
  get Data1(): bigint | number {
    return Number(this.view.getBigUint64(0, true));
  }

  // 0x08: i32
  get LogonId_HighPart(): number {
    return this.view.getInt32(8, true);
  }

  // 0x0c: pad4

  // 0x00: usize
  set Data1(value: bigint | number) {
    this.view.setBigUint64(0, BigInt(value), true);
  }

  // 0x08: i32
  set LogonId_HighPart(value: number) {
    this.view.setInt32(8, value, true);
  }

  // 0x0c: pad4
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_INFO (size: 56)
 */
export interface CRYPTUI_WIZ_DIGITAL_SIGN_INFO {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT */
  dwSubjectChoice: CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT;
  /** _Anonymous1_e__Union */
  Anonymous1: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN */
  dwSigningCertChoice: CRYPTUI_WIZ_DIGITAL_SIGN;
  /** _Anonymous2_e__Union */
  Anonymous2: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.PWSTR */
  pwszTimestampURL: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_ADDITIONAL_CERT_CHOICE */
  dwAdditionalCertChoice: CRYPTUI_WIZ_DIGITAL_ADDITIONAL_CERT_CHOICE;
  /** ptr */
  pSignExtInfo: Deno.PointerValue | Uint8Array;
}

export const sizeofCRYPTUI_WIZ_DIGITAL_SIGN_INFO = 56;

export function allocCRYPTUI_WIZ_DIGITAL_SIGN_INFO(data?: Partial<CRYPTUI_WIZ_DIGITAL_SIGN_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_DIGITAL_SIGN_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: u32
  if (data?.dwSubjectChoice !== undefined) view.setUint32(4, Number(data.dwSubjectChoice), true);
  // 0x08: pointer
  if (data?.Anonymous1 !== undefined) view.setBigUint64(8, data.Anonymous1 === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous1))), true);
  // 0x10: u32
  if (data?.dwSigningCertChoice !== undefined) view.setUint32(16, Number(data.dwSigningCertChoice), true);
  // 0x14: pad4
  // 0x18: pointer
  if (data?.Anonymous2 !== undefined) view.setBigUint64(24, data.Anonymous2 === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous2))), true);
  // 0x20: buffer
  if (data?.pwszTimestampURL !== undefined) {
    (buf as any)._f32 = util.pwstrToFfi(data.pwszTimestampURL);
    view.setBigUint64(32, (buf as any)._f32 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f32))), true);
  }
  // 0x28: u32
  if (data?.dwAdditionalCertChoice !== undefined) view.setUint32(40, Number(data.dwAdditionalCertChoice), true);
  // 0x2c: pad4
  // 0x30: pointer
  if (data?.pSignExtInfo !== undefined) view.setBigUint64(48, data.pSignExtInfo === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pSignExtInfo))), true);
  return buf;
}

export class CRYPTUI_WIZ_DIGITAL_SIGN_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get dwSubjectChoice(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: pointer
  get Anonymous1(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwSigningCertChoice(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  get Anonymous2(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: buffer
  get pwszTimestampURL(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: u32
  get dwAdditionalCertChoice(): number {
    return this.view.getUint32(40, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  get pSignExtInfo(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(48, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set dwSubjectChoice(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: pointer
  set Anonymous1(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set dwSigningCertChoice(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  set Anonymous2(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: buffer
  set pwszTimestampURL(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f32 = value;
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f32))), true);
  }

  // 0x28: u32
  set dwAdditionalCertChoice(value: number) {
    this.view.setUint32(40, value, true);
  }

  // 0x2c: pad4

  // 0x30: pointer
  set pSignExtInfo(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(48, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT (size: 16)
 */
export interface CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT {
  /** u32 */
  dwSize: number;
  /** u32 */
  cbBlob: number;
  /** ptr */
  pbBlob: Deno.PointerValue | Uint8Array;
}

export const sizeofCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT = 16;

export function allocCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT(data?: Partial<CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: u32
  if (data?.cbBlob !== undefined) view.setUint32(4, Number(data.cbBlob), true);
  // 0x08: pointer
  if (data?.pbBlob !== undefined) view.setBigUint64(8, data.pbBlob === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pbBlob))), true);
  return buf;
}

export class CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXTView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get cbBlob(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: pointer
  get pbBlob(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set cbBlob(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: pointer
  set pbBlob(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_INITDIALOG_STRUCT (size: 16)
 */
export interface CRYPTUI_INITDIALOG_STRUCT {
  /** Windows.Win32.Foundation.LPARAM */
  lParam: Uint8Array | Deno.PointerValue;
  /** ptr */
  pCertContext: Deno.PointerValue | Uint8Array;
}

export const sizeofCRYPTUI_INITDIALOG_STRUCT = 16;

export function allocCRYPTUI_INITDIALOG_STRUCT(data?: Partial<CRYPTUI_INITDIALOG_STRUCT>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_INITDIALOG_STRUCT);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.lParam !== undefined) view.setBigUint64(0, data.lParam === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.lParam))), true);
  // 0x08: pointer
  if (data?.pCertContext !== undefined) view.setBigUint64(8, data.pCertContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pCertContext))), true);
  return buf;
}

export class CRYPTUI_INITDIALOG_STRUCTView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get lParam(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get pCertContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: pointer
  set lParam(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set pCertContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

export type BOOL = number;

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_VIEWCERTIFICATE_STRUCTW (size: 120)
 */
export interface CRYPTUI_VIEWCERTIFICATE_STRUCTW {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.HWND */
  hwndParent: Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_VIEWCERTIFICATE_FLAGS */
  dwFlags: CRYPTUI_VIEWCERTIFICATE_FLAGS;
  /** Windows.Win32.Foundation.PWSTR */
  szTitle: string | null | Uint8Array | Uint16Array;
  /** ptr */
  pCertContext: Deno.PointerValue | Uint8Array;
  /** ptr */
  rgszPurposes: Deno.PointerValue | Uint8Array;
  /** u32 */
  cPurposes: number;
  /** _Anonymous_e__Union */
  Anonymous: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.BOOL */
  fpCryptProviderDataTrustedUsage: boolean;
  /** u32 */
  idxSigner: number;
  /** u32 */
  idxCert: number;
  /** Windows.Win32.Foundation.BOOL */
  fCounterSigner: boolean;
  /** u32 */
  idxCounterSigner: number;
  /** u32 */
  cStores: number;
  /** ptr */
  rghStores: Deno.PointerValue | Uint8Array;
  /** u32 */
  cPropSheetPages: number;
  /** ptr */
  rgPropSheetPages: Deno.PointerValue | Uint8Array;
  /** u32 */
  nStartPage: number;
}

export const sizeofCRYPTUI_VIEWCERTIFICATE_STRUCTW = 120;

export function allocCRYPTUI_VIEWCERTIFICATE_STRUCTW(data?: Partial<CRYPTUI_VIEWCERTIFICATE_STRUCTW>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_VIEWCERTIFICATE_STRUCTW);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.hwndParent !== undefined) view.setBigUint64(8, data.hwndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hwndParent))), true);
  // 0x10: u32
  if (data?.dwFlags !== undefined) view.setUint32(16, Number(data.dwFlags), true);
  // 0x14: pad4
  // 0x18: buffer
  if (data?.szTitle !== undefined) {
    (buf as any)._f24 = util.pwstrToFfi(data.szTitle);
    view.setBigUint64(24, (buf as any)._f24 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f24))), true);
  }
  // 0x20: pointer
  if (data?.pCertContext !== undefined) view.setBigUint64(32, data.pCertContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pCertContext))), true);
  // 0x28: pointer
  if (data?.rgszPurposes !== undefined) view.setBigUint64(40, data.rgszPurposes === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rgszPurposes))), true);
  // 0x30: u32
  if (data?.cPurposes !== undefined) view.setUint32(48, Number(data.cPurposes), true);
  // 0x34: pad4
  // 0x38: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(56, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  // 0x40: i32
  if (data?.fpCryptProviderDataTrustedUsage !== undefined) view.setInt32(64, Number(data.fpCryptProviderDataTrustedUsage), true);
  // 0x44: u32
  if (data?.idxSigner !== undefined) view.setUint32(68, Number(data.idxSigner), true);
  // 0x48: u32
  if (data?.idxCert !== undefined) view.setUint32(72, Number(data.idxCert), true);
  // 0x4c: i32
  if (data?.fCounterSigner !== undefined) view.setInt32(76, Number(data.fCounterSigner), true);
  // 0x50: u32
  if (data?.idxCounterSigner !== undefined) view.setUint32(80, Number(data.idxCounterSigner), true);
  // 0x54: u32
  if (data?.cStores !== undefined) view.setUint32(84, Number(data.cStores), true);
  // 0x58: pointer
  if (data?.rghStores !== undefined) view.setBigUint64(88, data.rghStores === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghStores))), true);
  // 0x60: u32
  if (data?.cPropSheetPages !== undefined) view.setUint32(96, Number(data.cPropSheetPages), true);
  // 0x64: pad4
  // 0x68: pointer
  if (data?.rgPropSheetPages !== undefined) view.setBigUint64(104, data.rgPropSheetPages === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rgPropSheetPages))), true);
  // 0x70: u32
  if (data?.nStartPage !== undefined) view.setUint32(112, Number(data.nStartPage), true);
  // 0x74: pad4
  return buf;
}

export class CRYPTUI_VIEWCERTIFICATE_STRUCTWView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get hwndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwFlags(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  get szTitle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: pointer
  get pCertContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: pointer
  get rgszPurposes(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: u32
  get cPurposes(): number {
    return this.view.getUint32(48, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(56, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x40: i32
  get fpCryptProviderDataTrustedUsage(): number {
    return this.view.getInt32(64, true);
  }

  // 0x44: u32
  get idxSigner(): number {
    return this.view.getUint32(68, true);
  }

  // 0x48: u32
  get idxCert(): number {
    return this.view.getUint32(72, true);
  }

  // 0x4c: i32
  get fCounterSigner(): number {
    return this.view.getInt32(76, true);
  }

  // 0x50: u32
  get idxCounterSigner(): number {
    return this.view.getUint32(80, true);
  }

  // 0x54: u32
  get cStores(): number {
    return this.view.getUint32(84, true);
  }

  // 0x58: pointer
  get rghStores(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(88, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x60: u32
  get cPropSheetPages(): number {
    return this.view.getUint32(96, true);
  }

  // 0x64: pad4

  // 0x68: pointer
  get rgPropSheetPages(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(104, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x70: u32
  get nStartPage(): number {
    return this.view.getUint32(112, true);
  }

  // 0x74: pad4

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set hwndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set dwFlags(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  set szTitle(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f24 = value;
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f24))), true);
  }

  // 0x20: pointer
  set pCertContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x28: pointer
  set rgszPurposes(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x30: u32
  set cPurposes(value: number) {
    this.view.setUint32(48, value, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(56, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x40: i32
  set fpCryptProviderDataTrustedUsage(value: number) {
    this.view.setInt32(64, value, true);
  }

  // 0x44: u32
  set idxSigner(value: number) {
    this.view.setUint32(68, value, true);
  }

  // 0x48: u32
  set idxCert(value: number) {
    this.view.setUint32(72, value, true);
  }

  // 0x4c: i32
  set fCounterSigner(value: number) {
    this.view.setInt32(76, value, true);
  }

  // 0x50: u32
  set idxCounterSigner(value: number) {
    this.view.setUint32(80, value, true);
  }

  // 0x54: u32
  set cStores(value: number) {
    this.view.setUint32(84, value, true);
  }

  // 0x58: pointer
  set rghStores(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(88, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x60: u32
  set cPropSheetPages(value: number) {
    this.view.setUint32(96, value, true);
  }

  // 0x64: pad4

  // 0x68: pointer
  set rgPropSheetPages(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(104, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x70: u32
  set nStartPage(value: number) {
    this.view.setUint32(112, value, true);
  }

  // 0x74: pad4
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_VIEWCERTIFICATE_STRUCTA (size: 120)
 */
export interface CRYPTUI_VIEWCERTIFICATE_STRUCTA {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.HWND */
  hwndParent: Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_VIEWCERTIFICATE_FLAGS */
  dwFlags: CRYPTUI_VIEWCERTIFICATE_FLAGS;
  /** Windows.Win32.Foundation.PSTR */
  szTitle: string | null | Uint8Array;
  /** ptr */
  pCertContext: Deno.PointerValue | Uint8Array;
  /** ptr */
  rgszPurposes: Deno.PointerValue | Uint8Array;
  /** u32 */
  cPurposes: number;
  /** _Anonymous_e__Union */
  Anonymous: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.BOOL */
  fpCryptProviderDataTrustedUsage: boolean;
  /** u32 */
  idxSigner: number;
  /** u32 */
  idxCert: number;
  /** Windows.Win32.Foundation.BOOL */
  fCounterSigner: boolean;
  /** u32 */
  idxCounterSigner: number;
  /** u32 */
  cStores: number;
  /** ptr */
  rghStores: Deno.PointerValue | Uint8Array;
  /** u32 */
  cPropSheetPages: number;
  /** ptr */
  rgPropSheetPages: Deno.PointerValue | Uint8Array;
  /** u32 */
  nStartPage: number;
}

export const sizeofCRYPTUI_VIEWCERTIFICATE_STRUCTA = 120;

export function allocCRYPTUI_VIEWCERTIFICATE_STRUCTA(data?: Partial<CRYPTUI_VIEWCERTIFICATE_STRUCTA>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_VIEWCERTIFICATE_STRUCTA);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.hwndParent !== undefined) view.setBigUint64(8, data.hwndParent === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.hwndParent))), true);
  // 0x10: u32
  if (data?.dwFlags !== undefined) view.setUint32(16, Number(data.dwFlags), true);
  // 0x14: pad4
  // 0x18: buffer
  if (data?.szTitle !== undefined) {
    (buf as any)._f24 = util.pstrToFfi(data.szTitle);
    view.setBigUint64(24, (buf as any)._f24 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f24))), true);
  }
  // 0x20: pointer
  if (data?.pCertContext !== undefined) view.setBigUint64(32, data.pCertContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pCertContext))), true);
  // 0x28: pointer
  if (data?.rgszPurposes !== undefined) view.setBigUint64(40, data.rgszPurposes === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rgszPurposes))), true);
  // 0x30: u32
  if (data?.cPurposes !== undefined) view.setUint32(48, Number(data.cPurposes), true);
  // 0x34: pad4
  // 0x38: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(56, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  // 0x40: i32
  if (data?.fpCryptProviderDataTrustedUsage !== undefined) view.setInt32(64, Number(data.fpCryptProviderDataTrustedUsage), true);
  // 0x44: u32
  if (data?.idxSigner !== undefined) view.setUint32(68, Number(data.idxSigner), true);
  // 0x48: u32
  if (data?.idxCert !== undefined) view.setUint32(72, Number(data.idxCert), true);
  // 0x4c: i32
  if (data?.fCounterSigner !== undefined) view.setInt32(76, Number(data.fCounterSigner), true);
  // 0x50: u32
  if (data?.idxCounterSigner !== undefined) view.setUint32(80, Number(data.idxCounterSigner), true);
  // 0x54: u32
  if (data?.cStores !== undefined) view.setUint32(84, Number(data.cStores), true);
  // 0x58: pointer
  if (data?.rghStores !== undefined) view.setBigUint64(88, data.rghStores === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghStores))), true);
  // 0x60: u32
  if (data?.cPropSheetPages !== undefined) view.setUint32(96, Number(data.cPropSheetPages), true);
  // 0x64: pad4
  // 0x68: pointer
  if (data?.rgPropSheetPages !== undefined) view.setBigUint64(104, data.rgPropSheetPages === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rgPropSheetPages))), true);
  // 0x70: u32
  if (data?.nStartPage !== undefined) view.setUint32(112, Number(data.nStartPage), true);
  // 0x74: pad4
  return buf;
}

export class CRYPTUI_VIEWCERTIFICATE_STRUCTAView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get hwndParent(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwFlags(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  get szTitle(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: pointer
  get pCertContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x28: pointer
  get rgszPurposes(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: u32
  get cPurposes(): number {
    return this.view.getUint32(48, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(56, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x40: i32
  get fpCryptProviderDataTrustedUsage(): number {
    return this.view.getInt32(64, true);
  }

  // 0x44: u32
  get idxSigner(): number {
    return this.view.getUint32(68, true);
  }

  // 0x48: u32
  get idxCert(): number {
    return this.view.getUint32(72, true);
  }

  // 0x4c: i32
  get fCounterSigner(): number {
    return this.view.getInt32(76, true);
  }

  // 0x50: u32
  get idxCounterSigner(): number {
    return this.view.getUint32(80, true);
  }

  // 0x54: u32
  get cStores(): number {
    return this.view.getUint32(84, true);
  }

  // 0x58: pointer
  get rghStores(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(88, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x60: u32
  get cPropSheetPages(): number {
    return this.view.getUint32(96, true);
  }

  // 0x64: pad4

  // 0x68: pointer
  get rgPropSheetPages(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(104, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x70: u32
  get nStartPage(): number {
    return this.view.getUint32(112, true);
  }

  // 0x74: pad4

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set hwndParent(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set dwFlags(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  set szTitle(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f24 = value;
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f24))), true);
  }

  // 0x20: pointer
  set pCertContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x28: pointer
  set rgszPurposes(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x30: u32
  set cPurposes(value: number) {
    this.view.setUint32(48, value, true);
  }

  // 0x34: pad4

  // 0x38: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(56, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x40: i32
  set fpCryptProviderDataTrustedUsage(value: number) {
    this.view.setInt32(64, value, true);
  }

  // 0x44: u32
  set idxSigner(value: number) {
    this.view.setUint32(68, value, true);
  }

  // 0x48: u32
  set idxCert(value: number) {
    this.view.setUint32(72, value, true);
  }

  // 0x4c: i32
  set fCounterSigner(value: number) {
    this.view.setInt32(76, value, true);
  }

  // 0x50: u32
  set idxCounterSigner(value: number) {
    this.view.setUint32(80, value, true);
  }

  // 0x54: u32
  set cStores(value: number) {
    this.view.setUint32(84, value, true);
  }

  // 0x58: pointer
  set rghStores(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(88, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x60: u32
  set cPropSheetPages(value: number) {
    this.view.setUint32(96, value, true);
  }

  // 0x64: pad4

  // 0x68: pointer
  set rgPropSheetPages(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(104, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x70: u32
  set nStartPage(value: number) {
    this.view.setUint32(112, value, true);
  }

  // 0x74: pad4
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_EXPORT_INFO (size: 48)
 */
export interface CRYPTUI_WIZ_EXPORT_INFO {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Foundation.PWSTR */
  pwszExportFileName: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_EXPORT_SUBJECT */
  dwSubjectChoice: CRYPTUI_WIZ_EXPORT_SUBJECT;
  /** _Anonymous_e__Union */
  Anonymous: Uint8Array | Deno.PointerValue;
  /** u32 */
  cStores: number;
  /** ptr */
  rghStores: Deno.PointerValue | Uint8Array;
}

export const sizeofCRYPTUI_WIZ_EXPORT_INFO = 48;

export function allocCRYPTUI_WIZ_EXPORT_INFO(data?: Partial<CRYPTUI_WIZ_EXPORT_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_EXPORT_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: pad4
  // 0x08: buffer
  if (data?.pwszExportFileName !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.pwszExportFileName);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  // 0x10: u32
  if (data?.dwSubjectChoice !== undefined) view.setUint32(16, Number(data.dwSubjectChoice), true);
  // 0x14: pad4
  // 0x18: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(24, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  // 0x20: u32
  if (data?.cStores !== undefined) view.setUint32(32, Number(data.cStores), true);
  // 0x24: pad4
  // 0x28: pointer
  if (data?.rghStores !== undefined) view.setBigUint64(40, data.rghStores === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.rghStores))), true);
  return buf;
}

export class CRYPTUI_WIZ_EXPORT_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  get pwszExportFileName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwSubjectChoice(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: u32
  get cStores(): number {
    return this.view.getUint32(32, true);
  }

  // 0x24: pad4

  // 0x28: pointer
  get rghStores(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  set pwszExportFileName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }

  // 0x10: u32
  set dwSubjectChoice(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: u32
  set cStores(value: number) {
    this.view.setUint32(32, value, true);
  }

  // 0x24: pad4

  // 0x28: pointer
  set rghStores(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO (size: 32)
 */
export interface CRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_EXPORT_FORMAT */
  dwExportFormat: CRYPTUI_WIZ_EXPORT_FORMAT;
  /** Windows.Win32.Foundation.BOOL */
  fExportChain: boolean;
  /** Windows.Win32.Foundation.BOOL */
  fExportPrivateKeys: boolean;
  /** Windows.Win32.Foundation.PWSTR */
  pwszPassword: string | null | Uint8Array | Uint16Array;
  /** Windows.Win32.Foundation.BOOL */
  fStrongEncryption: boolean;
}

export const sizeofCRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO = 32;

export function allocCRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO(data?: Partial<CRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: u32
  if (data?.dwExportFormat !== undefined) view.setUint32(4, Number(data.dwExportFormat), true);
  // 0x08: i32
  if (data?.fExportChain !== undefined) view.setInt32(8, Number(data.fExportChain), true);
  // 0x0c: i32
  if (data?.fExportPrivateKeys !== undefined) view.setInt32(12, Number(data.fExportPrivateKeys), true);
  // 0x10: buffer
  if (data?.pwszPassword !== undefined) {
    (buf as any)._f16 = util.pwstrToFfi(data.pwszPassword);
    view.setBigUint64(16, (buf as any)._f16 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f16))), true);
  }
  // 0x18: i32
  if (data?.fStrongEncryption !== undefined) view.setInt32(24, Number(data.fStrongEncryption), true);
  // 0x1c: pad4
  return buf;
}

export class CRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get dwExportFormat(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: i32
  get fExportChain(): number {
    return this.view.getInt32(8, true);
  }

  // 0x0c: i32
  get fExportPrivateKeys(): number {
    return this.view.getInt32(12, true);
  }

  // 0x10: buffer
  get pwszPassword(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: i32
  get fStrongEncryption(): number {
    return this.view.getInt32(24, true);
  }

  // 0x1c: pad4

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set dwExportFormat(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: i32
  set fExportChain(value: number) {
    this.view.setInt32(8, value, true);
  }

  // 0x0c: i32
  set fExportPrivateKeys(value: number) {
    this.view.setInt32(12, value, true);
  }

  // 0x10: buffer
  set pwszPassword(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f16 = value;
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f16))), true);
  }

  // 0x18: i32
  set fStrongEncryption(value: number) {
    this.view.setInt32(24, value, true);
  }

  // 0x1c: pad4
}

/**
 * Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_IMPORT_SRC_INFO (size: 32)
 */
export interface CRYPTUI_WIZ_IMPORT_SRC_INFO {
  /** u32 */
  dwSize: number;
  /** Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_IMPORT_SUBJECT_OPTION */
  dwSubjectChoice: CRYPTUI_WIZ_IMPORT_SUBJECT_OPTION;
  /** _Anonymous_e__Union */
  Anonymous: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Security.Cryptography.CRYPT_KEY_FLAGS */
  dwFlags: CRYPT_KEY_FLAGS;
  /** Windows.Win32.Foundation.PWSTR */
  pwszPassword: string | null | Uint8Array | Uint16Array;
}

export const sizeofCRYPTUI_WIZ_IMPORT_SRC_INFO = 32;

export function allocCRYPTUI_WIZ_IMPORT_SRC_INFO(data?: Partial<CRYPTUI_WIZ_IMPORT_SRC_INFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCRYPTUI_WIZ_IMPORT_SRC_INFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwSize !== undefined) view.setUint32(0, Number(data.dwSize), true);
  // 0x04: u32
  if (data?.dwSubjectChoice !== undefined) view.setUint32(4, Number(data.dwSubjectChoice), true);
  // 0x08: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(8, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  // 0x10: u32
  if (data?.dwFlags !== undefined) view.setUint32(16, Number(data.dwFlags), true);
  // 0x14: pad4
  // 0x18: buffer
  if (data?.pwszPassword !== undefined) {
    (buf as any)._f24 = util.pwstrToFfi(data.pwszPassword);
    view.setBigUint64(24, (buf as any)._f24 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f24))), true);
  }
  return buf;
}

export class CRYPTUI_WIZ_IMPORT_SRC_INFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get dwSubjectChoice(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get dwFlags(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  get pwszPassword(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set dwSubjectChoice(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set dwFlags(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: pad4

  // 0x18: buffer
  set pwszPassword(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f24 = value;
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f24))), true);
  }
}

export type HRESULT = number;

// Native Libraries

try {
  var libCRYPTUI_dll = Deno.dlopen("CRYPTUI.dll", {
    CryptUIDlgViewContext: {
      parameters: ["u32", "pointer", "pointer", "buffer", "u32", "pointer"],
      result: "i32",
      optional: true,
    },
    CryptUIDlgSelectCertificateFromStore: {
      parameters: ["pointer", "pointer", "buffer", "buffer", "u32", "u32", "pointer"],
      result: "pointer",
      optional: true,
    },
    CertSelectionGetSerializedBlob: {
      parameters: ["pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    CryptUIDlgCertMgr: {
      parameters: ["pointer"],
      result: "i32",
      optional: true,
    },
    CryptUIWizDigitalSign: {
      parameters: ["u32", "pointer", "buffer", "pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    CryptUIWizFreeDigitalSignContext: {
      parameters: ["pointer"],
      result: "i32",
      optional: true,
    },
    CryptUIDlgViewCertificateW: {
      parameters: ["pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    CryptUIDlgViewCertificateA: {
      parameters: ["pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    CryptUIWizExport: {
      parameters: ["u32", "pointer", "buffer", "pointer", "pointer"],
      result: "i32",
      optional: true,
    },
    CryptUIWizImport: {
      parameters: ["u32", "pointer", "buffer", "pointer", "pointer"],
      result: "i32",
      optional: true,
    },
  }).symbols;
} catch(e) { /* ignore */ }

// Symbols

export function CryptUIDlgViewContext(
  dwContextType: number /* u32 */,
  pvContext: Deno.PointerValue | Uint8Array /* ptr */,
  hwnd: Deno.PointerValue /* Windows.Win32.Foundation.HWND */,
  pwszTitle: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  dwFlags: number /* u32 */,
  pvReserved: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIDlgViewContext!(dwContextType, util.toPointer(pvContext), (hwnd), util.pwstrToFfi(pwszTitle), dwFlags, util.toPointer(pvReserved)));
}

export function CryptUIDlgSelectCertificateFromStore(
  hCertStore: Uint8Array | Deno.PointerValue /* Windows.Win32.Security.Cryptography.HCERTSTORE */,
  hwnd: Deno.PointerValue /* Windows.Win32.Foundation.HWND */,
  pwszTitle: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pwszDisplayString: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  dwDontUseColumn: number /* u32 */,
  dwFlags: number /* u32 */,
  pvReserved: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* ptr */ {
  return libCRYPTUI_dll.CryptUIDlgSelectCertificateFromStore!(util.toPointer(hCertStore), (hwnd), util.pwstrToFfi(pwszTitle), util.pwstrToFfi(pwszDisplayString), dwDontUseColumn, dwFlags, util.toPointer(pvReserved));
}

export function CertSelectionGetSerializedBlob(
  pcsi: Deno.PointerValue | Uint8Array /* ptr */,
  ppOutBuffer: Deno.PointerValue | Uint8Array /* ptr */,
  pulOutBufferSize: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libCRYPTUI_dll.CertSelectionGetSerializedBlob!(util.toPointer(pcsi), util.toPointer(ppOutBuffer), util.toPointer(pulOutBufferSize));
}

export function CryptUIDlgCertMgr(
  pCryptUICertMgr: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIDlgCertMgr!(util.toPointer(pCryptUICertMgr)));
}

export function CryptUIWizDigitalSign(
  dwFlags: number /* u32 */,
  hwndParent: Deno.PointerValue /* Windows.Win32.Foundation.HWND */,
  pwszWizardTitle: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pDigitalSignInfo: Deno.PointerValue | Uint8Array /* ptr */,
  ppSignContext: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIWizDigitalSign!(dwFlags, (hwndParent), util.pwstrToFfi(pwszWizardTitle), util.toPointer(pDigitalSignInfo), util.toPointer(ppSignContext)));
}

export function CryptUIWizFreeDigitalSignContext(
  pSignContext: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIWizFreeDigitalSignContext!(util.toPointer(pSignContext)));
}

export function CryptUIDlgViewCertificateW(
  pCertViewInfo: Deno.PointerValue | Uint8Array /* ptr */,
  pfPropertiesChanged: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIDlgViewCertificateW!(util.toPointer(pCertViewInfo), util.toPointer(pfPropertiesChanged)));
}

export function CryptUIDlgViewCertificateA(
  pCertViewInfo: Deno.PointerValue | Uint8Array /* ptr */,
  pfPropertiesChanged: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIDlgViewCertificateA!(util.toPointer(pCertViewInfo), util.toPointer(pfPropertiesChanged)));
}

export function CryptUIWizExport(
  dwFlags: CRYPTUI_WIZ_FLAGS /* Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_FLAGS */,
  hwndParent: Deno.PointerValue /* Windows.Win32.Foundation.HWND */,
  pwszWizardTitle: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pExportInfo: Deno.PointerValue | Uint8Array /* ptr */,
  pvoid: Deno.PointerValue | Uint8Array /* ptr */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIWizExport!(dwFlags, (hwndParent), util.pwstrToFfi(pwszWizardTitle), util.toPointer(pExportInfo), util.toPointer(pvoid)));
}

export function CryptUIWizImport(
  dwFlags: CRYPTUI_WIZ_FLAGS /* Windows.Win32.Security.Cryptography.UI.CRYPTUI_WIZ_FLAGS */,
  hwndParent: Deno.PointerValue /* Windows.Win32.Foundation.HWND */,
  pwszWizardTitle: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pImportSrc: Deno.PointerValue | Uint8Array /* ptr */,
  hDestCertStore: Uint8Array | Deno.PointerValue /* Windows.Win32.Security.Cryptography.HCERTSTORE */,
): boolean /* Windows.Win32.Foundation.BOOL */ {
  return util.boolFromFfi(libCRYPTUI_dll.CryptUIWizImport!(dwFlags, (hwndParent), util.pwstrToFfi(pwszWizardTitle), util.toPointer(pImportSrc), util.toPointer(hDestCertStore)));
}

