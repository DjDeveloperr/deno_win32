/// Auto-generated by Deno Win32: Windows.Win32.System.Com.CallObj.Apis

import * as util from "../../../util.ts";

// Enums
export type CALLFRAME_COPY = number;
export type CALLFRAME_FREE = number;
export type CALLFRAME_NULL = number;
export type CALLFRAME_WALK = number;

// Constants
export const CALLFRAME_COPY_NESTED = 1;
export const CALLFRAME_COPY_INDEPENDENT = 2;
export const CALLFRAME_FREE_NONE = 0;
export const CALLFRAME_FREE_IN = 1;
export const CALLFRAME_FREE_INOUT = 2;
export const CALLFRAME_FREE_OUT = 4;
export const CALLFRAME_FREE_TOP_INOUT = 8;
export const CALLFRAME_FREE_TOP_OUT = 16;
export const CALLFRAME_FREE_ALL = 31;
export const CALLFRAME_NULL_NONE = 0;
export const CALLFRAME_NULL_INOUT = 2;
export const CALLFRAME_NULL_OUT = 4;
export const CALLFRAME_NULL_ALL = 6;
export const CALLFRAME_WALK_IN = 1;
export const CALLFRAME_WALK_INOUT = 2;
export const CALLFRAME_WALK_OUT = 4;

// Structs

export type BOOL = number;

/**
 * Windows.Win32.System.Com.CallObj.CALLFRAMEINFO (size: 56)
 */
export interface CALLFRAMEINFO {
  /** u32 */
  iMethod: number;
  /** Windows.Win32.Foundation.BOOL */
  fHasInValues: boolean;
  /** Windows.Win32.Foundation.BOOL */
  fHasInOutValues: boolean;
  /** Windows.Win32.Foundation.BOOL */
  fHasOutValues: boolean;
  /** Windows.Win32.Foundation.BOOL */
  fDerivesFromIDispatch: boolean;
  /** i32 */
  cInInterfacesMax: number;
  /** i32 */
  cInOutInterfacesMax: number;
  /** i32 */
  cOutInterfacesMax: number;
  /** i32 */
  cTopLevelInInterfaces: number;
  /** System.Guid */
  iid: Uint8Array | Deno.PointerValue;
  /** u32 */
  cMethod: number;
  /** u32 */
  cParams: number;
}

export const sizeofCALLFRAMEINFO = 56;

export function allocCALLFRAMEINFO(data?: Partial<CALLFRAMEINFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCALLFRAMEINFO);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.iMethod !== undefined) view.setUint32(0, Number(data.iMethod), true);
  // 0x04: i32
  if (data?.fHasInValues !== undefined) view.setInt32(4, Number(data.fHasInValues), true);
  // 0x08: i32
  if (data?.fHasInOutValues !== undefined) view.setInt32(8, Number(data.fHasInOutValues), true);
  // 0x0c: i32
  if (data?.fHasOutValues !== undefined) view.setInt32(12, Number(data.fHasOutValues), true);
  // 0x10: i32
  if (data?.fDerivesFromIDispatch !== undefined) view.setInt32(16, Number(data.fDerivesFromIDispatch), true);
  // 0x14: i32
  if (data?.cInInterfacesMax !== undefined) view.setInt32(20, Number(data.cInInterfacesMax), true);
  // 0x18: i32
  if (data?.cInOutInterfacesMax !== undefined) view.setInt32(24, Number(data.cInOutInterfacesMax), true);
  // 0x1c: i32
  if (data?.cOutInterfacesMax !== undefined) view.setInt32(28, Number(data.cOutInterfacesMax), true);
  // 0x20: i32
  if (data?.cTopLevelInInterfaces !== undefined) view.setInt32(32, Number(data.cTopLevelInInterfaces), true);
  // 0x24: pad4
  // 0x28: pointer
  if (data?.iid !== undefined) view.setBigUint64(40, data.iid === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.iid))), true);
  // 0x30: u32
  if (data?.cMethod !== undefined) view.setUint32(48, Number(data.cMethod), true);
  // 0x34: u32
  if (data?.cParams !== undefined) view.setUint32(52, Number(data.cParams), true);
  return buf;
}

export class CALLFRAMEINFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get iMethod(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: i32
  get fHasInValues(): number {
    return this.view.getInt32(4, true);
  }

  // 0x08: i32
  get fHasInOutValues(): number {
    return this.view.getInt32(8, true);
  }

  // 0x0c: i32
  get fHasOutValues(): number {
    return this.view.getInt32(12, true);
  }

  // 0x10: i32
  get fDerivesFromIDispatch(): number {
    return this.view.getInt32(16, true);
  }

  // 0x14: i32
  get cInInterfacesMax(): number {
    return this.view.getInt32(20, true);
  }

  // 0x18: i32
  get cInOutInterfacesMax(): number {
    return this.view.getInt32(24, true);
  }

  // 0x1c: i32
  get cOutInterfacesMax(): number {
    return this.view.getInt32(28, true);
  }

  // 0x20: i32
  get cTopLevelInInterfaces(): number {
    return this.view.getInt32(32, true);
  }

  // 0x24: pad4

  // 0x28: pointer
  get iid(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(40, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x30: u32
  get cMethod(): number {
    return this.view.getUint32(48, true);
  }

  // 0x34: u32
  get cParams(): number {
    return this.view.getUint32(52, true);
  }

  // 0x00: u32
  set iMethod(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: i32
  set fHasInValues(value: number) {
    this.view.setInt32(4, value, true);
  }

  // 0x08: i32
  set fHasInOutValues(value: number) {
    this.view.setInt32(8, value, true);
  }

  // 0x0c: i32
  set fHasOutValues(value: number) {
    this.view.setInt32(12, value, true);
  }

  // 0x10: i32
  set fDerivesFromIDispatch(value: number) {
    this.view.setInt32(16, value, true);
  }

  // 0x14: i32
  set cInInterfacesMax(value: number) {
    this.view.setInt32(20, value, true);
  }

  // 0x18: i32
  set cInOutInterfacesMax(value: number) {
    this.view.setInt32(24, value, true);
  }

  // 0x1c: i32
  set cOutInterfacesMax(value: number) {
    this.view.setInt32(28, value, true);
  }

  // 0x20: i32
  set cTopLevelInInterfaces(value: number) {
    this.view.setInt32(32, value, true);
  }

  // 0x24: pad4

  // 0x28: pointer
  set iid(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(40, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x30: u32
  set cMethod(value: number) {
    this.view.setUint32(48, value, true);
  }

  // 0x34: u32
  set cParams(value: number) {
    this.view.setUint32(52, value, true);
  }
}

export type BOOLEAN = number;

/**
 * Windows.Win32.System.Com.CallObj.CALLFRAMEPARAMINFO (size: 24)
 */
export interface CALLFRAMEPARAMINFO {
  /** Windows.Win32.Foundation.BOOLEAN */
  fIn: Uint8Array | Deno.PointerValue;
  /** Windows.Win32.Foundation.BOOLEAN */
  fOut: Uint8Array | Deno.PointerValue;
  /** u32 */
  stackOffset: number;
  /** u32 */
  cbParam: number;
}

export const sizeofCALLFRAMEPARAMINFO = 24;

export function allocCALLFRAMEPARAMINFO(data?: Partial<CALLFRAMEPARAMINFO>): Uint8Array {
  const buf = new Uint8Array(sizeofCALLFRAMEPARAMINFO);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.fIn !== undefined) view.setBigUint64(0, data.fIn === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.fIn))), true);
  // 0x08: pointer
  if (data?.fOut !== undefined) view.setBigUint64(8, data.fOut === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.fOut))), true);
  // 0x10: u32
  if (data?.stackOffset !== undefined) view.setUint32(16, Number(data.stackOffset), true);
  // 0x14: u32
  if (data?.cbParam !== undefined) view.setUint32(20, Number(data.cbParam), true);
  return buf;
}

export class CALLFRAMEPARAMINFOView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get fIn(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get fOut(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get stackOffset(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: u32
  get cbParam(): number {
    return this.view.getUint32(20, true);
  }

  // 0x00: pointer
  set fIn(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set fOut(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set stackOffset(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: u32
  set cbParam(value: number) {
    this.view.setUint32(20, value, true);
  }
}

/**
 * Windows.Win32.System.Com.CallObj.CALLFRAME_MARSHALCONTEXT (size: 40)
 */
export interface CALLFRAME_MARSHALCONTEXT {
  /** Windows.Win32.Foundation.BOOLEAN */
  fIn: Uint8Array | Deno.PointerValue;
  /** u32 */
  dwDestContext: number;
  /** ptr */
  pvDestContext: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.System.Com.IUnknown */
  punkReserved: Uint8Array | Deno.PointerValue;
  /** System.Guid */
  guidTransferSyntax: Uint8Array | Deno.PointerValue;
}

export const sizeofCALLFRAME_MARSHALCONTEXT = 40;

export function allocCALLFRAME_MARSHALCONTEXT(data?: Partial<CALLFRAME_MARSHALCONTEXT>): Uint8Array {
  const buf = new Uint8Array(sizeofCALLFRAME_MARSHALCONTEXT);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.fIn !== undefined) view.setBigUint64(0, data.fIn === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.fIn))), true);
  // 0x08: u32
  if (data?.dwDestContext !== undefined) view.setUint32(8, Number(data.dwDestContext), true);
  // 0x0c: pad4
  // 0x10: pointer
  if (data?.pvDestContext !== undefined) view.setBigUint64(16, data.pvDestContext === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pvDestContext))), true);
  // 0x18: pointer
  if (data?.punkReserved !== undefined) view.setBigUint64(24, data.punkReserved === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.punkReserved))), true);
  // 0x20: pointer
  if (data?.guidTransferSyntax !== undefined) view.setBigUint64(32, data.guidTransferSyntax === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.guidTransferSyntax))), true);
  return buf;
}

export class CALLFRAME_MARSHALCONTEXTView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get fIn(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get dwDestContext(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  get pvDestContext(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: pointer
  get punkReserved(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: pointer
  get guidTransferSyntax(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: pointer
  set fIn(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set dwDestContext(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  set pvDestContext(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: pointer
  set punkReserved(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: pointer
  set guidTransferSyntax(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

export type HRESULT = number;

// Native Libraries

try {
  var libole32_dll = Deno.dlopen("ole32.dll", {
    CoGetInterceptor: {
      parameters: ["pointer", "pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    CoGetInterceptorFromTypeInfo: {
      parameters: ["pointer", "pointer", "pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
  }).symbols;
} catch(e) { /* ignore */ }

// Symbols

export function CoGetInterceptor(
  iidIntercepted: Deno.PointerValue | Uint8Array /* ptr */,
  punkOuter: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IUnknown */,
  iid: Deno.PointerValue | Uint8Array /* ptr */,
  ppv: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libole32_dll.CoGetInterceptor!(util.toPointer(iidIntercepted), util.toPointer(punkOuter), util.toPointer(iid), util.toPointer(ppv));
}

export function CoGetInterceptorFromTypeInfo(
  iidIntercepted: Deno.PointerValue | Uint8Array /* ptr */,
  punkOuter: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IUnknown */,
  typeInfo: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.ITypeInfo */,
  iid: Deno.PointerValue | Uint8Array /* ptr */,
  ppv: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libole32_dll.CoGetInterceptorFromTypeInfo!(util.toPointer(iidIntercepted), util.toPointer(punkOuter), util.toPointer(typeInfo), util.toPointer(iid), util.toPointer(ppv));
}

