/// Auto-generated by Deno Win32: Windows.Win32.System.CorrelationVector.Apis

import * as util from "../../util.ts";

// Constants
export const RTL_CORRELATION_VECTOR_STRING_LENGTH = 129;
export const RTL_CORRELATION_VECTOR_V1_PREFIX_LENGTH = 16;
export const RTL_CORRELATION_VECTOR_V1_LENGTH = 64;
export const RTL_CORRELATION_VECTOR_V2_PREFIX_LENGTH = 22;
export const RTL_CORRELATION_VECTOR_V2_LENGTH = 128;

// Structs

export type CHAR = number;

/**
 * Windows.Win32.System.CorrelationVector.CORRELATION_VECTOR (size: 16)
 */
export interface CORRELATION_VECTOR {
  /** Windows.Win32.Foundation.CHAR */
  Version: Uint8Array | Deno.PointerValue | null;
  /** array */
  Vector: Deno.PointerValue | null;
}

export const sizeofCORRELATION_VECTOR = 16;

export function allocCORRELATION_VECTOR(data?: Partial<CORRELATION_VECTOR>): Uint8Array {
  const buf = new Uint8Array(sizeofCORRELATION_VECTOR);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Version !== undefined) view.setBigUint64(0, data.Version === null ? 0n : BigInt(util.toPointer(data.Version)), true);
  // 0x08: pointer
  if (data?.Vector !== undefined) view.setBigUint64(8, data.Vector === null ? 0n : BigInt(util.toPointer(data.Vector)), true);
  return buf;
}

// Native Libraries

try {
  var libntdll_dll = Deno.dlopen("ntdll.dll", {
    RtlInitializeCorrelationVector: {
      parameters: ["pointer", "i32", "pointer"],
      result: "u32",
    },
    RtlIncrementCorrelationVector: {
      parameters: ["pointer"],
      result: "u32",
    },
    RtlExtendCorrelationVector: {
      parameters: ["pointer"],
      result: "u32",
    },
    RtlValidateCorrelationVector: {
      parameters: ["pointer"],
      result: "u32",
    },
  }).symbols;
} catch(e) { /* ignore */ }

// Symbols

export function RtlInitializeCorrelationVector(
  CorrelationVector: Deno.PointerValue | Uint8Array | null /* ptr */,
  Version: number /* i32 */,
  Guid: Deno.PointerValue | Uint8Array | null /* ptr */,
): number /* u32 */ {
  return libntdll_dll.RtlInitializeCorrelationVector(util.toPointer(CorrelationVector), Version, util.toPointer(Guid));
}

export function RtlIncrementCorrelationVector(
  CorrelationVector: Deno.PointerValue | Uint8Array | null /* ptr */,
): number /* u32 */ {
  return libntdll_dll.RtlIncrementCorrelationVector(util.toPointer(CorrelationVector));
}

export function RtlExtendCorrelationVector(
  CorrelationVector: Deno.PointerValue | Uint8Array | null /* ptr */,
): number /* u32 */ {
  return libntdll_dll.RtlExtendCorrelationVector(util.toPointer(CorrelationVector));
}

export function RtlValidateCorrelationVector(
  Vector: Deno.PointerValue | Uint8Array | null /* ptr */,
): number /* u32 */ {
  return libntdll_dll.RtlValidateCorrelationVector(util.toPointer(Vector));
}

