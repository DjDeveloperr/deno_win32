/// Auto-generated by Deno Win32: Windows.Win32.Graphics.Imaging.Apis

import * as util from "../../util.ts";

// Enums
export type WICColorContextType = number;
export type WICBitmapCreateCacheOption = number;
export type WICDecodeOptions = number;
export type WICBitmapEncoderCacheOption = number;
export type WICComponentType = number;
export type WICComponentEnumerateOptions = number;
export type WICBitmapInterpolationMode = number;
export type WICBitmapPaletteType = number;
export type WICBitmapDitherType = number;
export type WICBitmapAlphaChannelOption = number;
export type WICBitmapTransformOptions = number;
export type WICBitmapLockFlags = number;
export type WICBitmapDecoderCapabilities = number;
export type WICProgressOperation = number;
export type WICProgressNotification = number;
export type WICComponentSigning = number;
export type WICGifLogicalScreenDescriptorProperties = number;
export type WICGifImageDescriptorProperties = number;
export type WICGifGraphicControlExtensionProperties = number;
export type WICGifApplicationExtensionProperties = number;
export type WICGifCommentExtensionProperties = number;
export type WICJpegCommentProperties = number;
export type WICJpegLuminanceProperties = number;
export type WICJpegChrominanceProperties = number;
export type WIC8BIMIptcProperties = number;
export type WIC8BIMResolutionInfoProperties = number;
export type WIC8BIMIptcDigestProperties = number;
export type WICPngGamaProperties = number;
export type WICPngBkgdProperties = number;
export type WICPngItxtProperties = number;
export type WICPngChrmProperties = number;
export type WICPngHistProperties = number;
export type WICPngIccpProperties = number;
export type WICPngSrgbProperties = number;
export type WICPngTimeProperties = number;
export type WICHeifProperties = number;
export type WICHeifHdrProperties = number;
export type WICWebpAnimProperties = number;
export type WICWebpAnmfProperties = number;
export type WICSectionAccessLevel = number;
export type WICPixelFormatNumericRepresentation = number;
export type WICPlanarOptions = number;
export type WICJpegIndexingOptions = number;
export type WICJpegTransferMatrix = number;
export type WICJpegScanType = number;
export type DXGI_FORMAT = number;
export type D2D1_ALPHA_MODE = number;
export type WICTiffCompressionOption = number;
export type WICJpegYCrCbSubsamplingOption = number;
export type WICPngFilterOption = number;
export type WICNamedWhitePoint = number;
export type WICRawCapabilities = number;
export type WICRawRotationCapabilities = number;
export type WICRawParameterSet = number;
export type WICRawRenderMode = number;
export type WICDdsDimension = number;
export type WICDdsAlphaMode = number;
export type WICMetadataCreationOptions = number;
export type WICPersistOptions = number;

// Constants
export const WINCODEC_SDK_VERSION1 = 566;
export const WINCODEC_SDK_VERSION2 = 567;
export const WINCODEC_SDK_VERSION = 567;
export const WIC_JPEG_MAX_COMPONENT_COUNT = 4;
export const WIC_JPEG_MAX_TABLE_INDEX = 3;
export const WIC_JPEG_SAMPLE_FACTORS_ONE = 17;
export const WIC_JPEG_SAMPLE_FACTORS_THREE_420 = 1118498;
export const WIC_JPEG_SAMPLE_FACTORS_THREE_422 = 1118497;
export const WIC_JPEG_SAMPLE_FACTORS_THREE_440 = 1118482;
export const WIC_JPEG_SAMPLE_FACTORS_THREE_444 = 1118481;
export const WIC_JPEG_QUANTIZATION_BASELINE_ONE = 0;
export const WIC_JPEG_QUANTIZATION_BASELINE_THREE = 65792;
export const WIC_JPEG_HUFFMAN_BASELINE_ONE = 0;
export const WIC_JPEG_HUFFMAN_BASELINE_THREE = 1118464;
export const FACILITY_WINCODEC_ERR = 2200;
export const WINCODEC_ERR_BASE = 8192;
export const WINCODEC_ERR_GENERIC_ERROR = `-2147467259`;
export const WINCODEC_ERR_INVALIDPARAMETER = `-2147024809`;
export const WINCODEC_ERR_OUTOFMEMORY = `-2147024882`;
export const WINCODEC_ERR_NOTIMPLEMENTED = `-2147467263`;
export const WINCODEC_ERR_ABORTED = `-2147467260`;
export const WINCODEC_ERR_ACCESSDENIED = `-2147024891`;
export const WICRawChangeNotification_ExposureCompensation = 1;
export const WICRawChangeNotification_NamedWhitePoint = 2;
export const WICRawChangeNotification_KelvinWhitePoint = 4;
export const WICRawChangeNotification_RGBWhitePoint = 8;
export const WICRawChangeNotification_Contrast = 16;
export const WICRawChangeNotification_Gamma = 32;
export const WICRawChangeNotification_Sharpness = 64;
export const WICRawChangeNotification_Saturation = 128;
export const WICRawChangeNotification_Tint = 256;
export const WICRawChangeNotification_NoiseReduction = 512;
export const WICRawChangeNotification_DestinationColorContext = 1024;
export const WICRawChangeNotification_ToneCurve = 2048;
export const WICRawChangeNotification_Rotation = 4096;
export const WICRawChangeNotification_RenderMode = 8192;
export const WICColorContextUninitialized = 0;
export const WICColorContextProfile = 1;
export const WICColorContextExifColorSpace = 2;
export const WICBitmapNoCache = 0;
export const WICBitmapCacheOnDemand = 1;
export const WICBitmapCacheOnLoad = 2;
export const WICBITMAPCREATECACHEOPTION_FORCE_DWORD = 2147483647;
export const WICDecodeMetadataCacheOnDemand = 0;
export const WICDecodeMetadataCacheOnLoad = 1;
export const WICMETADATACACHEOPTION_FORCE_DWORD = 2147483647;
export const WICBitmapEncoderCacheInMemory = 0;
export const WICBitmapEncoderCacheTempFile = 1;
export const WICBitmapEncoderNoCache = 2;
export const WICBITMAPENCODERCACHEOPTION_FORCE_DWORD = 2147483647;
export const WICDecoder = 1;
export const WICEncoder = 2;
export const WICPixelFormatConverter = 4;
export const WICMetadataReader = 8;
export const WICMetadataWriter = 16;
export const WICPixelFormat = 32;
export const WICAllComponents = 63;
export const WICCOMPONENTTYPE_FORCE_DWORD = 2147483647;
export const WICComponentEnumerateDefault = 0;
export const WICComponentEnumerateRefresh = 1;
export const WICComponentEnumerateDisabled = `-2147483648`;
export const WICComponentEnumerateUnsigned = 1073741824;
export const WICComponentEnumerateBuiltInOnly = 536870912;
export const WICCOMPONENTENUMERATEOPTIONS_FORCE_DWORD = 2147483647;
export const WICBitmapInterpolationModeNearestNeighbor = 0;
export const WICBitmapInterpolationModeLinear = 1;
export const WICBitmapInterpolationModeCubic = 2;
export const WICBitmapInterpolationModeFant = 3;
export const WICBitmapInterpolationModeHighQualityCubic = 4;
export const WICBITMAPINTERPOLATIONMODE_FORCE_DWORD = 2147483647;
export const WICBitmapPaletteTypeCustom = 0;
export const WICBitmapPaletteTypeMedianCut = 1;
export const WICBitmapPaletteTypeFixedBW = 2;
export const WICBitmapPaletteTypeFixedHalftone8 = 3;
export const WICBitmapPaletteTypeFixedHalftone27 = 4;
export const WICBitmapPaletteTypeFixedHalftone64 = 5;
export const WICBitmapPaletteTypeFixedHalftone125 = 6;
export const WICBitmapPaletteTypeFixedHalftone216 = 7;
export const WICBitmapPaletteTypeFixedWebPalette = 7;
export const WICBitmapPaletteTypeFixedHalftone252 = 8;
export const WICBitmapPaletteTypeFixedHalftone256 = 9;
export const WICBitmapPaletteTypeFixedGray4 = 10;
export const WICBitmapPaletteTypeFixedGray16 = 11;
export const WICBitmapPaletteTypeFixedGray256 = 12;
export const WICBITMAPPALETTETYPE_FORCE_DWORD = 2147483647;
export const WICBitmapDitherTypeNone = 0;
export const WICBitmapDitherTypeSolid = 0;
export const WICBitmapDitherTypeOrdered4x4 = 1;
export const WICBitmapDitherTypeOrdered8x8 = 2;
export const WICBitmapDitherTypeOrdered16x16 = 3;
export const WICBitmapDitherTypeSpiral4x4 = 4;
export const WICBitmapDitherTypeSpiral8x8 = 5;
export const WICBitmapDitherTypeDualSpiral4x4 = 6;
export const WICBitmapDitherTypeDualSpiral8x8 = 7;
export const WICBitmapDitherTypeErrorDiffusion = 8;
export const WICBITMAPDITHERTYPE_FORCE_DWORD = 2147483647;
export const WICBitmapUseAlpha = 0;
export const WICBitmapUsePremultipliedAlpha = 1;
export const WICBitmapIgnoreAlpha = 2;
export const WICBITMAPALPHACHANNELOPTIONS_FORCE_DWORD = 2147483647;
export const WICBitmapTransformRotate0 = 0;
export const WICBitmapTransformRotate90 = 1;
export const WICBitmapTransformRotate180 = 2;
export const WICBitmapTransformRotate270 = 3;
export const WICBitmapTransformFlipHorizontal = 8;
export const WICBitmapTransformFlipVertical = 16;
export const WICBITMAPTRANSFORMOPTIONS_FORCE_DWORD = 2147483647;
export const WICBitmapLockRead = 1;
export const WICBitmapLockWrite = 2;
export const WICBITMAPLOCKFLAGS_FORCE_DWORD = 2147483647;
export const WICBitmapDecoderCapabilitySameEncoder = 1;
export const WICBitmapDecoderCapabilityCanDecodeAllImages = 2;
export const WICBitmapDecoderCapabilityCanDecodeSomeImages = 4;
export const WICBitmapDecoderCapabilityCanEnumerateMetadata = 8;
export const WICBitmapDecoderCapabilityCanDecodeThumbnail = 16;
export const WICBITMAPDECODERCAPABILITIES_FORCE_DWORD = 2147483647;
export const WICProgressOperationCopyPixels = 1;
export const WICProgressOperationWritePixels = 2;
export const WICProgressOperationAll = 65535;
export const WICPROGRESSOPERATION_FORCE_DWORD = 2147483647;
export const WICProgressNotificationBegin = 65536;
export const WICProgressNotificationEnd = 131072;
export const WICProgressNotificationFrequent = 262144;
export const WICProgressNotificationAll = `-65536`;
export const WICPROGRESSNOTIFICATION_FORCE_DWORD = 2147483647;
export const WICComponentSigned = 1;
export const WICComponentUnsigned = 2;
export const WICComponentSafe = 4;
export const WICComponentDisabled = `-2147483648`;
export const WICCOMPONENTSIGNING_FORCE_DWORD = 2147483647;
export const WICGifLogicalScreenSignature = 1;
export const WICGifLogicalScreenDescriptorWidth = 2;
export const WICGifLogicalScreenDescriptorHeight = 3;
export const WICGifLogicalScreenDescriptorGlobalColorTableFlag = 4;
export const WICGifLogicalScreenDescriptorColorResolution = 5;
export const WICGifLogicalScreenDescriptorSortFlag = 6;
export const WICGifLogicalScreenDescriptorGlobalColorTableSize = 7;
export const WICGifLogicalScreenDescriptorBackgroundColorIndex = 8;
export const WICGifLogicalScreenDescriptorPixelAspectRatio = 9;
export const WICGifLogicalScreenDescriptorProperties_FORCE_DWORD = 2147483647;
export const WICGifImageDescriptorLeft = 1;
export const WICGifImageDescriptorTop = 2;
export const WICGifImageDescriptorWidth = 3;
export const WICGifImageDescriptorHeight = 4;
export const WICGifImageDescriptorLocalColorTableFlag = 5;
export const WICGifImageDescriptorInterlaceFlag = 6;
export const WICGifImageDescriptorSortFlag = 7;
export const WICGifImageDescriptorLocalColorTableSize = 8;
export const WICGifImageDescriptorProperties_FORCE_DWORD = 2147483647;
export const WICGifGraphicControlExtensionDisposal = 1;
export const WICGifGraphicControlExtensionUserInputFlag = 2;
export const WICGifGraphicControlExtensionTransparencyFlag = 3;
export const WICGifGraphicControlExtensionDelay = 4;
export const WICGifGraphicControlExtensionTransparentColorIndex = 5;
export const WICGifGraphicControlExtensionProperties_FORCE_DWORD = 2147483647;
export const WICGifApplicationExtensionApplication = 1;
export const WICGifApplicationExtensionData = 2;
export const WICGifApplicationExtensionProperties_FORCE_DWORD = 2147483647;
export const WICGifCommentExtensionText = 1;
export const WICGifCommentExtensionProperties_FORCE_DWORD = 2147483647;
export const WICJpegCommentText = 1;
export const WICJpegCommentProperties_FORCE_DWORD = 2147483647;
export const WICJpegLuminanceTable = 1;
export const WICJpegLuminanceProperties_FORCE_DWORD = 2147483647;
export const WICJpegChrominanceTable = 1;
export const WICJpegChrominanceProperties_FORCE_DWORD = 2147483647;
export const WIC8BIMIptcPString = 0;
export const WIC8BIMIptcEmbeddedIPTC = 1;
export const WIC8BIMIptcProperties_FORCE_DWORD = 2147483647;
export const WIC8BIMResolutionInfoPString = 1;
export const WIC8BIMResolutionInfoHResolution = 2;
export const WIC8BIMResolutionInfoHResolutionUnit = 3;
export const WIC8BIMResolutionInfoWidthUnit = 4;
export const WIC8BIMResolutionInfoVResolution = 5;
export const WIC8BIMResolutionInfoVResolutionUnit = 6;
export const WIC8BIMResolutionInfoHeightUnit = 7;
export const WIC8BIMResolutionInfoProperties_FORCE_DWORD = 2147483647;
export const WIC8BIMIptcDigestPString = 1;
export const WIC8BIMIptcDigestIptcDigest = 2;
export const WIC8BIMIptcDigestProperties_FORCE_DWORD = 2147483647;
export const WICPngGamaGamma = 1;
export const WICPngGamaProperties_FORCE_DWORD = 2147483647;
export const WICPngBkgdBackgroundColor = 1;
export const WICPngBkgdProperties_FORCE_DWORD = 2147483647;
export const WICPngItxtKeyword = 1;
export const WICPngItxtCompressionFlag = 2;
export const WICPngItxtLanguageTag = 3;
export const WICPngItxtTranslatedKeyword = 4;
export const WICPngItxtText = 5;
export const WICPngItxtProperties_FORCE_DWORD = 2147483647;
export const WICPngChrmWhitePointX = 1;
export const WICPngChrmWhitePointY = 2;
export const WICPngChrmRedX = 3;
export const WICPngChrmRedY = 4;
export const WICPngChrmGreenX = 5;
export const WICPngChrmGreenY = 6;
export const WICPngChrmBlueX = 7;
export const WICPngChrmBlueY = 8;
export const WICPngChrmProperties_FORCE_DWORD = 2147483647;
export const WICPngHistFrequencies = 1;
export const WICPngHistProperties_FORCE_DWORD = 2147483647;
export const WICPngIccpProfileName = 1;
export const WICPngIccpProfileData = 2;
export const WICPngIccpProperties_FORCE_DWORD = 2147483647;
export const WICPngSrgbRenderingIntent = 1;
export const WICPngSrgbProperties_FORCE_DWORD = 2147483647;
export const WICPngTimeYear = 1;
export const WICPngTimeMonth = 2;
export const WICPngTimeDay = 3;
export const WICPngTimeHour = 4;
export const WICPngTimeMinute = 5;
export const WICPngTimeSecond = 6;
export const WICPngTimeProperties_FORCE_DWORD = 2147483647;
export const WICHeifOrientation = 1;
export const WICHeifProperties_FORCE_DWORD = 2147483647;
export const WICHeifHdrMaximumLuminanceLevel = 1;
export const WICHeifHdrMaximumFrameAverageLuminanceLevel = 2;
export const WICHeifHdrMinimumMasteringDisplayLuminanceLevel = 3;
export const WICHeifHdrMaximumMasteringDisplayLuminanceLevel = 4;
export const WICHeifHdrCustomVideoPrimaries = 5;
export const WICHeifHdrProperties_FORCE_DWORD = 2147483647;
export const WICWebpAnimLoopCount = 1;
export const WICWebpAnimProperties_FORCE_DWORD = 2147483647;
export const WICWebpAnmfFrameDuration = 1;
export const WICWebpAnmfProperties_FORCE_DWORD = 2147483647;
export const WICSectionAccessLevelRead = 1;
export const WICSectionAccessLevelReadWrite = 3;
export const WICSectionAccessLevel_FORCE_DWORD = 2147483647;
export const WICPixelFormatNumericRepresentationUnspecified = 0;
export const WICPixelFormatNumericRepresentationIndexed = 1;
export const WICPixelFormatNumericRepresentationUnsignedInteger = 2;
export const WICPixelFormatNumericRepresentationSignedInteger = 3;
export const WICPixelFormatNumericRepresentationFixed = 4;
export const WICPixelFormatNumericRepresentationFloat = 5;
export const WICPixelFormatNumericRepresentation_FORCE_DWORD = 2147483647;
export const WICPlanarOptionsDefault = 0;
export const WICPlanarOptionsPreserveSubsampling = 1;
export const WICPLANAROPTIONS_FORCE_DWORD = 2147483647;
export const WICJpegIndexingOptionsGenerateOnDemand = 0;
export const WICJpegIndexingOptionsGenerateOnLoad = 1;
export const WICJpegIndexingOptions_FORCE_DWORD = 2147483647;
export const WICJpegTransferMatrixIdentity = 0;
export const WICJpegTransferMatrixBT601 = 1;
export const WICJpegTransferMatrix_FORCE_DWORD = 2147483647;
export const WICJpegScanTypeInterleaved = 0;
export const WICJpegScanTypePlanarComponents = 1;
export const WICJpegScanTypeProgressive = 2;
export const WICJpegScanType_FORCE_DWORD = 2147483647;
export const DXGI_FORMAT_UNKNOWN = 0;
export const DXGI_FORMAT_R32G32B32A32_TYPELESS = 1;
export const DXGI_FORMAT_R32G32B32A32_FLOAT = 2;
export const DXGI_FORMAT_R32G32B32A32_UINT = 3;
export const DXGI_FORMAT_R32G32B32A32_SINT = 4;
export const DXGI_FORMAT_R32G32B32_TYPELESS = 5;
export const DXGI_FORMAT_R32G32B32_FLOAT = 6;
export const DXGI_FORMAT_R32G32B32_UINT = 7;
export const DXGI_FORMAT_R32G32B32_SINT = 8;
export const DXGI_FORMAT_R16G16B16A16_TYPELESS = 9;
export const DXGI_FORMAT_R16G16B16A16_FLOAT = 10;
export const DXGI_FORMAT_R16G16B16A16_UNORM = 11;
export const DXGI_FORMAT_R16G16B16A16_UINT = 12;
export const DXGI_FORMAT_R16G16B16A16_SNORM = 13;
export const DXGI_FORMAT_R16G16B16A16_SINT = 14;
export const DXGI_FORMAT_R32G32_TYPELESS = 15;
export const DXGI_FORMAT_R32G32_FLOAT = 16;
export const DXGI_FORMAT_R32G32_UINT = 17;
export const DXGI_FORMAT_R32G32_SINT = 18;
export const DXGI_FORMAT_R32G8X24_TYPELESS = 19;
export const DXGI_FORMAT_D32_FLOAT_S8X24_UINT = 20;
export const DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS = 21;
export const DXGI_FORMAT_X32_TYPELESS_G8X24_UINT = 22;
export const DXGI_FORMAT_R10G10B10A2_TYPELESS = 23;
export const DXGI_FORMAT_R10G10B10A2_UNORM = 24;
export const DXGI_FORMAT_R10G10B10A2_UINT = 25;
export const DXGI_FORMAT_R11G11B10_FLOAT = 26;
export const DXGI_FORMAT_R8G8B8A8_TYPELESS = 27;
export const DXGI_FORMAT_R8G8B8A8_UNORM = 28;
export const DXGI_FORMAT_R8G8B8A8_UNORM_SRGB = 29;
export const DXGI_FORMAT_R8G8B8A8_UINT = 30;
export const DXGI_FORMAT_R8G8B8A8_SNORM = 31;
export const DXGI_FORMAT_R8G8B8A8_SINT = 32;
export const DXGI_FORMAT_R16G16_TYPELESS = 33;
export const DXGI_FORMAT_R16G16_FLOAT = 34;
export const DXGI_FORMAT_R16G16_UNORM = 35;
export const DXGI_FORMAT_R16G16_UINT = 36;
export const DXGI_FORMAT_R16G16_SNORM = 37;
export const DXGI_FORMAT_R16G16_SINT = 38;
export const DXGI_FORMAT_R32_TYPELESS = 39;
export const DXGI_FORMAT_D32_FLOAT = 40;
export const DXGI_FORMAT_R32_FLOAT = 41;
export const DXGI_FORMAT_R32_UINT = 42;
export const DXGI_FORMAT_R32_SINT = 43;
export const DXGI_FORMAT_R24G8_TYPELESS = 44;
export const DXGI_FORMAT_D24_UNORM_S8_UINT = 45;
export const DXGI_FORMAT_R24_UNORM_X8_TYPELESS = 46;
export const DXGI_FORMAT_X24_TYPELESS_G8_UINT = 47;
export const DXGI_FORMAT_R8G8_TYPELESS = 48;
export const DXGI_FORMAT_R8G8_UNORM = 49;
export const DXGI_FORMAT_R8G8_UINT = 50;
export const DXGI_FORMAT_R8G8_SNORM = 51;
export const DXGI_FORMAT_R8G8_SINT = 52;
export const DXGI_FORMAT_R16_TYPELESS = 53;
export const DXGI_FORMAT_R16_FLOAT = 54;
export const DXGI_FORMAT_D16_UNORM = 55;
export const DXGI_FORMAT_R16_UNORM = 56;
export const DXGI_FORMAT_R16_UINT = 57;
export const DXGI_FORMAT_R16_SNORM = 58;
export const DXGI_FORMAT_R16_SINT = 59;
export const DXGI_FORMAT_R8_TYPELESS = 60;
export const DXGI_FORMAT_R8_UNORM = 61;
export const DXGI_FORMAT_R8_UINT = 62;
export const DXGI_FORMAT_R8_SNORM = 63;
export const DXGI_FORMAT_R8_SINT = 64;
export const DXGI_FORMAT_A8_UNORM = 65;
export const DXGI_FORMAT_R1_UNORM = 66;
export const DXGI_FORMAT_R9G9B9E5_SHAREDEXP = 67;
export const DXGI_FORMAT_R8G8_B8G8_UNORM = 68;
export const DXGI_FORMAT_G8R8_G8B8_UNORM = 69;
export const DXGI_FORMAT_BC1_TYPELESS = 70;
export const DXGI_FORMAT_BC1_UNORM = 71;
export const DXGI_FORMAT_BC1_UNORM_SRGB = 72;
export const DXGI_FORMAT_BC2_TYPELESS = 73;
export const DXGI_FORMAT_BC2_UNORM = 74;
export const DXGI_FORMAT_BC2_UNORM_SRGB = 75;
export const DXGI_FORMAT_BC3_TYPELESS = 76;
export const DXGI_FORMAT_BC3_UNORM = 77;
export const DXGI_FORMAT_BC3_UNORM_SRGB = 78;
export const DXGI_FORMAT_BC4_TYPELESS = 79;
export const DXGI_FORMAT_BC4_UNORM = 80;
export const DXGI_FORMAT_BC4_SNORM = 81;
export const DXGI_FORMAT_BC5_TYPELESS = 82;
export const DXGI_FORMAT_BC5_UNORM = 83;
export const DXGI_FORMAT_BC5_SNORM = 84;
export const DXGI_FORMAT_B5G6R5_UNORM = 85;
export const DXGI_FORMAT_B5G5R5A1_UNORM = 86;
export const DXGI_FORMAT_B8G8R8A8_UNORM = 87;
export const DXGI_FORMAT_B8G8R8X8_UNORM = 88;
export const DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM = 89;
export const DXGI_FORMAT_B8G8R8A8_TYPELESS = 90;
export const DXGI_FORMAT_B8G8R8A8_UNORM_SRGB = 91;
export const DXGI_FORMAT_B8G8R8X8_TYPELESS = 92;
export const DXGI_FORMAT_B8G8R8X8_UNORM_SRGB = 93;
export const DXGI_FORMAT_BC6H_TYPELESS = 94;
export const DXGI_FORMAT_BC6H_UF16 = 95;
export const DXGI_FORMAT_BC6H_SF16 = 96;
export const DXGI_FORMAT_BC7_TYPELESS = 97;
export const DXGI_FORMAT_BC7_UNORM = 98;
export const DXGI_FORMAT_BC7_UNORM_SRGB = 99;
export const DXGI_FORMAT_AYUV = 100;
export const DXGI_FORMAT_Y410 = 101;
export const DXGI_FORMAT_Y416 = 102;
export const DXGI_FORMAT_NV12 = 103;
export const DXGI_FORMAT_P010 = 104;
export const DXGI_FORMAT_P016 = 105;
export const DXGI_FORMAT_420_OPAQUE = 106;
export const DXGI_FORMAT_YUY2 = 107;
export const DXGI_FORMAT_Y210 = 108;
export const DXGI_FORMAT_Y216 = 109;
export const DXGI_FORMAT_NV11 = 110;
export const DXGI_FORMAT_AI44 = 111;
export const DXGI_FORMAT_IA44 = 112;
export const DXGI_FORMAT_P8 = 113;
export const DXGI_FORMAT_A8P8 = 114;
export const DXGI_FORMAT_B4G4R4A4_UNORM = 115;
export const DXGI_FORMAT_P208 = 130;
export const DXGI_FORMAT_V208 = 131;
export const DXGI_FORMAT_V408 = 132;
export const DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE = 189;
export const DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE = 190;
export const DXGI_FORMAT_FORCE_UINT = 4294967295;
export const D2D1_ALPHA_MODE_UNKNOWN = 0;
export const D2D1_ALPHA_MODE_PREMULTIPLIED = 1;
export const D2D1_ALPHA_MODE_STRAIGHT = 2;
export const D2D1_ALPHA_MODE_IGNORE = 3;
export const D2D1_ALPHA_MODE_FORCE_DWORD = 4294967295;
export const WICTiffCompressionDontCare = 0;
export const WICTiffCompressionNone = 1;
export const WICTiffCompressionCCITT3 = 2;
export const WICTiffCompressionCCITT4 = 3;
export const WICTiffCompressionLZW = 4;
export const WICTiffCompressionRLE = 5;
export const WICTiffCompressionZIP = 6;
export const WICTiffCompressionLZWHDifferencing = 7;
export const WICTIFFCOMPRESSIONOPTION_FORCE_DWORD = 2147483647;
export const WICJpegYCrCbSubsamplingDefault = 0;
export const WICJpegYCrCbSubsampling420 = 1;
export const WICJpegYCrCbSubsampling422 = 2;
export const WICJpegYCrCbSubsampling444 = 3;
export const WICJpegYCrCbSubsampling440 = 4;
export const WICJPEGYCRCBSUBSAMPLING_FORCE_DWORD = 2147483647;
export const WICPngFilterUnspecified = 0;
export const WICPngFilterNone = 1;
export const WICPngFilterSub = 2;
export const WICPngFilterUp = 3;
export const WICPngFilterAverage = 4;
export const WICPngFilterPaeth = 5;
export const WICPngFilterAdaptive = 6;
export const WICPNGFILTEROPTION_FORCE_DWORD = 2147483647;
export const WICWhitePointDefault = 1;
export const WICWhitePointDaylight = 2;
export const WICWhitePointCloudy = 4;
export const WICWhitePointShade = 8;
export const WICWhitePointTungsten = 16;
export const WICWhitePointFluorescent = 32;
export const WICWhitePointFlash = 64;
export const WICWhitePointUnderwater = 128;
export const WICWhitePointCustom = 256;
export const WICWhitePointAutoWhiteBalance = 512;
export const WICWhitePointAsShot = 1;
export const WICNAMEDWHITEPOINT_FORCE_DWORD = 2147483647;
export const WICRawCapabilityNotSupported = 0;
export const WICRawCapabilityGetSupported = 1;
export const WICRawCapabilityFullySupported = 2;
export const WICRAWCAPABILITIES_FORCE_DWORD = 2147483647;
export const WICRawRotationCapabilityNotSupported = 0;
export const WICRawRotationCapabilityGetSupported = 1;
export const WICRawRotationCapabilityNinetyDegreesSupported = 2;
export const WICRawRotationCapabilityFullySupported = 3;
export const WICRAWROTATIONCAPABILITIES_FORCE_DWORD = 2147483647;
export const WICAsShotParameterSet = 1;
export const WICUserAdjustedParameterSet = 2;
export const WICAutoAdjustedParameterSet = 3;
export const WICRAWPARAMETERSET_FORCE_DWORD = 2147483647;
export const WICRawRenderModeDraft = 1;
export const WICRawRenderModeNormal = 2;
export const WICRawRenderModeBestQuality = 3;
export const WICRAWRENDERMODE_FORCE_DWORD = 2147483647;
export const WICDdsTexture1D = 0;
export const WICDdsTexture2D = 1;
export const WICDdsTexture3D = 2;
export const WICDdsTextureCube = 3;
export const WICDDSTEXTURE_FORCE_DWORD = 2147483647;
export const WICDdsAlphaModeUnknown = 0;
export const WICDdsAlphaModeStraight = 1;
export const WICDdsAlphaModePremultiplied = 2;
export const WICDdsAlphaModeOpaque = 3;
export const WICDdsAlphaModeCustom = 4;
export const WICDDSALPHAMODE_FORCE_DWORD = 2147483647;
export const WICMetadataCreationDefault = 0;
export const WICMetadataCreationAllowUnknown = 0;
export const WICMetadataCreationFailUnknown = 65536;
export const WICMetadataCreationMask = `-65536`;
export const WICPersistOptionDefault = 0;
export const WICPersistOptionLittleEndian = 0;
export const WICPersistOptionBigEndian = 1;
export const WICPersistOptionStrictFormat = 2;
export const WICPersistOptionNoCacheStream = 4;
export const WICPersistOptionPreferUTF8 = 8;
export const WICPersistOptionMask = 65535;

// Structs

/**
 * Windows.Win32.Graphics.Imaging.WICRect (size: 16)
 */
export interface WICRect {
  /** i32 */
  X: number;
  /** i32 */
  Y: number;
  /** i32 */
  Width: number;
  /** i32 */
  Height: number;
}

export const sizeofWICRect = 16;

export function allocWICRect(data?: Partial<WICRect>): Uint8Array {
  const buf = new Uint8Array(sizeofWICRect);
  const view = new DataView(buf.buffer);
  // 0x00: i32
  if (data?.X !== undefined) view.setInt32(0, Number(data.X), true);
  // 0x04: i32
  if (data?.Y !== undefined) view.setInt32(4, Number(data.Y), true);
  // 0x08: i32
  if (data?.Width !== undefined) view.setInt32(8, Number(data.Width), true);
  // 0x0c: i32
  if (data?.Height !== undefined) view.setInt32(12, Number(data.Height), true);
  return buf;
}

export class WICRectView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: i32
  get X(): number {
    return this.view.getInt32(0, true);
  }

  // 0x04: i32
  get Y(): number {
    return this.view.getInt32(4, true);
  }

  // 0x08: i32
  get Width(): number {
    return this.view.getInt32(8, true);
  }

  // 0x0c: i32
  get Height(): number {
    return this.view.getInt32(12, true);
  }

  // 0x00: i32
  set X(value: number) {
    this.view.setInt32(0, value, true);
  }

  // 0x04: i32
  set Y(value: number) {
    this.view.setInt32(4, value, true);
  }

  // 0x08: i32
  set Width(value: number) {
    this.view.setInt32(8, value, true);
  }

  // 0x0c: i32
  set Height(value: number) {
    this.view.setInt32(12, value, true);
  }
}

/**
 * _Anonymous_e__Struct (size: 16)
 */
export interface _Anonymous_e__Struct {
  /** u64 */
  Alignment: bigint | number;
  /** u64 */
  Region: bigint | number;
}

export const sizeof_Anonymous_e__Struct = 16;

export function alloc_Anonymous_e__Struct(data?: Partial<_Anonymous_e__Struct>): Uint8Array {
  const buf = new Uint8Array(sizeof_Anonymous_e__Struct);
  const view = new DataView(buf.buffer);
  // 0x00: u64
  if (data?.Alignment !== undefined) view.setBigUint64(0, BigInt(data.Alignment), true);
  // 0x08: u64
  if (data?.Region !== undefined) view.setBigUint64(8, BigInt(data.Region), true);
  return buf;
}

export class _Anonymous_e__StructView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u64
  get Alignment(): bigint | number {
    return Number(this.view.getBigUint64(0, true));
  }

  // 0x08: u64
  get Region(): bigint | number {
    return Number(this.view.getBigUint64(8, true));
  }

  // 0x00: u64
  set Alignment(value: bigint | number) {
    this.view.setBigUint64(0, BigInt(value), true);
  }

  // 0x08: u64
  set Region(value: bigint | number) {
    this.view.setBigUint64(8, BigInt(value), true);
  }
}

export type PWSTR = Deno.PointerValue | Uint8Array;

/**
 * _u_e__Struct (size: 16)
 */
export interface _u_e__Struct {
  /** u32 */
  dwValue: number;
  /** Windows.Win32.Foundation.PWSTR */
  pwszName: string | null | Uint8Array | Uint16Array;
}

export const sizeof_u_e__Struct = 16;

export function alloc_u_e__Struct(data?: Partial<_u_e__Struct>): Uint8Array {
  const buf = new Uint8Array(sizeof_u_e__Struct);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.dwValue !== undefined) view.setUint32(0, Number(data.dwValue), true);
  // 0x04: pad4
  // 0x08: buffer
  if (data?.pwszName !== undefined) {
    (buf as any)._f8 = util.pwstrToFfi(data.pwszName);
    view.setBigUint64(8, (buf as any)._f8 === null ? 0n : BigInt(Deno.UnsafePointer.value(Deno.UnsafePointer.of((buf as any)._f8))), true);
  }
  return buf;
}

export class _u_e__StructView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get dwValue(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  get pwszName(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set dwValue(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: buffer
  set pwszName(value: Uint8Array | Deno.PointerValue) {
    (this.buf as any)._f8 = value;
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer((this.buf as any)._f8))), true);
  }
}

/**
 * Windows.Win32.Foundation.ULARGE_INTEGER (size: 24)
 */
export interface ULARGE_INTEGER {
  /** _Anonymous_e__Struct */
  Anonymous: Uint8Array | Deno.PointerValue;
  /** _u_e__Struct */
  u: Uint8Array | Deno.PointerValue;
  /** u64 */
  QuadPart: bigint | number;
}

export const sizeofULARGE_INTEGER = 24;

export function allocULARGE_INTEGER(data?: Partial<ULARGE_INTEGER>): Uint8Array {
  const buf = new Uint8Array(sizeofULARGE_INTEGER);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Anonymous !== undefined) view.setBigUint64(0, data.Anonymous === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Anonymous))), true);
  // 0x08: pointer
  if (data?.u !== undefined) view.setBigUint64(8, data.u === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.u))), true);
  // 0x10: u64
  if (data?.QuadPart !== undefined) view.setBigUint64(16, BigInt(data.QuadPart), true);
  return buf;
}

export class ULARGE_INTEGERView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Anonymous(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get u(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u64
  get QuadPart(): bigint | number {
    return Number(this.view.getBigUint64(16, true));
  }

  // 0x00: pointer
  set Anonymous(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set u(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u64
  set QuadPart(value: bigint | number) {
    this.view.setBigUint64(16, BigInt(value), true);
  }
}

export type BOOL = number;

/**
 * Windows.Win32.Graphics.Imaging.WICBitmapPattern (size: 40)
 */
export interface WICBitmapPattern {
  /** Windows.Win32.Foundation.ULARGE_INTEGER */
  Position: Uint8Array | Deno.PointerValue;
  /** u32 */
  Length: number;
  /** ptr */
  Pattern: Deno.PointerValue | Uint8Array;
  /** ptr */
  Mask: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.BOOL */
  EndOfStream: boolean;
}

export const sizeofWICBitmapPattern = 40;

export function allocWICBitmapPattern(data?: Partial<WICBitmapPattern>): Uint8Array {
  const buf = new Uint8Array(sizeofWICBitmapPattern);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Position !== undefined) view.setBigUint64(0, data.Position === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Position))), true);
  // 0x08: u32
  if (data?.Length !== undefined) view.setUint32(8, Number(data.Length), true);
  // 0x0c: pad4
  // 0x10: pointer
  if (data?.Pattern !== undefined) view.setBigUint64(16, data.Pattern === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Pattern))), true);
  // 0x18: pointer
  if (data?.Mask !== undefined) view.setBigUint64(24, data.Mask === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Mask))), true);
  // 0x20: i32
  if (data?.EndOfStream !== undefined) view.setInt32(32, Number(data.EndOfStream), true);
  // 0x24: pad4
  return buf;
}

export class WICBitmapPatternView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Position(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get Length(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  get Pattern(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: pointer
  get Mask(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: i32
  get EndOfStream(): number {
    return this.view.getInt32(32, true);
  }

  // 0x24: pad4

  // 0x00: pointer
  set Position(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set Length(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  set Pattern(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: pointer
  set Mask(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: i32
  set EndOfStream(value: number) {
    this.view.setInt32(32, value, true);
  }

  // 0x24: pad4
}

/**
 * Windows.Win32.Graphics.Direct2D.Common.D2D1_PIXEL_FORMAT (size: 8)
 */
export interface D2D1_PIXEL_FORMAT {
  /** Windows.Win32.Graphics.Dxgi.Common.DXGI_FORMAT */
  format: DXGI_FORMAT;
  /** Windows.Win32.Graphics.Direct2D.Common.D2D1_ALPHA_MODE */
  alphaMode: D2D1_ALPHA_MODE;
}

export const sizeofD2D1_PIXEL_FORMAT = 8;

export function allocD2D1_PIXEL_FORMAT(data?: Partial<D2D1_PIXEL_FORMAT>): Uint8Array {
  const buf = new Uint8Array(sizeofD2D1_PIXEL_FORMAT);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.format !== undefined) view.setUint32(0, Number(data.format), true);
  // 0x04: u32
  if (data?.alphaMode !== undefined) view.setUint32(4, Number(data.alphaMode), true);
  return buf;
}

export class D2D1_PIXEL_FORMATView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get format(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get alphaMode(): number {
    return this.view.getUint32(4, true);
  }

  // 0x00: u32
  set format(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set alphaMode(value: number) {
    this.view.setUint32(4, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICImageParameters (size: 32)
 */
export interface WICImageParameters {
  /** Windows.Win32.Graphics.Direct2D.Common.D2D1_PIXEL_FORMAT */
  PixelFormat: Uint8Array | Deno.PointerValue;
  /** f32 */
  DpiX: number;
  /** f32 */
  DpiY: number;
  /** f32 */
  Top: number;
  /** f32 */
  Left: number;
  /** u32 */
  PixelWidth: number;
  /** u32 */
  PixelHeight: number;
}

export const sizeofWICImageParameters = 32;

export function allocWICImageParameters(data?: Partial<WICImageParameters>): Uint8Array {
  const buf = new Uint8Array(sizeofWICImageParameters);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.PixelFormat !== undefined) view.setBigUint64(0, data.PixelFormat === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.PixelFormat))), true);
  // 0x08: f32
  if (data?.DpiX !== undefined) view.setFloat32(8, Number(data.DpiX), true);
  // 0x0c: f32
  if (data?.DpiY !== undefined) view.setFloat32(12, Number(data.DpiY), true);
  // 0x10: f32
  if (data?.Top !== undefined) view.setFloat32(16, Number(data.Top), true);
  // 0x14: f32
  if (data?.Left !== undefined) view.setFloat32(20, Number(data.Left), true);
  // 0x18: u32
  if (data?.PixelWidth !== undefined) view.setUint32(24, Number(data.PixelWidth), true);
  // 0x1c: u32
  if (data?.PixelHeight !== undefined) view.setUint32(28, Number(data.PixelHeight), true);
  return buf;
}

export class WICImageParametersView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get PixelFormat(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: f32
  get DpiX(): number {
    return this.view.getFloat32(8, true);
  }

  // 0x0c: f32
  get DpiY(): number {
    return this.view.getFloat32(12, true);
  }

  // 0x10: f32
  get Top(): number {
    return this.view.getFloat32(16, true);
  }

  // 0x14: f32
  get Left(): number {
    return this.view.getFloat32(20, true);
  }

  // 0x18: u32
  get PixelWidth(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: u32
  get PixelHeight(): number {
    return this.view.getUint32(28, true);
  }

  // 0x00: pointer
  set PixelFormat(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: f32
  set DpiX(value: number) {
    this.view.setFloat32(8, value, true);
  }

  // 0x0c: f32
  set DpiY(value: number) {
    this.view.setFloat32(12, value, true);
  }

  // 0x10: f32
  set Top(value: number) {
    this.view.setFloat32(16, value, true);
  }

  // 0x14: f32
  set Left(value: number) {
    this.view.setFloat32(20, value, true);
  }

  // 0x18: u32
  set PixelWidth(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: u32
  set PixelHeight(value: number) {
    this.view.setUint32(28, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICBitmapPlaneDescription (size: 16)
 */
export interface WICBitmapPlaneDescription {
  /** System.Guid */
  Format: Uint8Array | Deno.PointerValue;
  /** u32 */
  Width: number;
  /** u32 */
  Height: number;
}

export const sizeofWICBitmapPlaneDescription = 16;

export function allocWICBitmapPlaneDescription(data?: Partial<WICBitmapPlaneDescription>): Uint8Array {
  const buf = new Uint8Array(sizeofWICBitmapPlaneDescription);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Format !== undefined) view.setBigUint64(0, data.Format === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Format))), true);
  // 0x08: u32
  if (data?.Width !== undefined) view.setUint32(8, Number(data.Width), true);
  // 0x0c: u32
  if (data?.Height !== undefined) view.setUint32(12, Number(data.Height), true);
  return buf;
}

export class WICBitmapPlaneDescriptionView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Format(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get Width(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: u32
  get Height(): number {
    return this.view.getUint32(12, true);
  }

  // 0x00: pointer
  set Format(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set Width(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: u32
  set Height(value: number) {
    this.view.setUint32(12, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICBitmapPlane (size: 24)
 */
export interface WICBitmapPlane {
  /** System.Guid */
  Format: Uint8Array | Deno.PointerValue;
  /** ptr */
  pbBuffer: Deno.PointerValue | Uint8Array;
  /** u32 */
  cbStride: number;
  /** u32 */
  cbBufferSize: number;
}

export const sizeofWICBitmapPlane = 24;

export function allocWICBitmapPlane(data?: Partial<WICBitmapPlane>): Uint8Array {
  const buf = new Uint8Array(sizeofWICBitmapPlane);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Format !== undefined) view.setBigUint64(0, data.Format === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Format))), true);
  // 0x08: pointer
  if (data?.pbBuffer !== undefined) view.setBigUint64(8, data.pbBuffer === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.pbBuffer))), true);
  // 0x10: u32
  if (data?.cbStride !== undefined) view.setUint32(16, Number(data.cbStride), true);
  // 0x14: u32
  if (data?.cbBufferSize !== undefined) view.setUint32(20, Number(data.cbBufferSize), true);
  return buf;
}

export class WICBitmapPlaneView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Format(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: pointer
  get pbBuffer(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x10: u32
  get cbStride(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: u32
  get cbBufferSize(): number {
    return this.view.getUint32(20, true);
  }

  // 0x00: pointer
  set Format(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: pointer
  set pbBuffer(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x10: u32
  set cbStride(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: u32
  set cbBufferSize(value: number) {
    this.view.setUint32(20, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICJpegFrameHeader (size: 32)
 */
export interface WICJpegFrameHeader {
  /** u32 */
  Width: number;
  /** u32 */
  Height: number;
  /** Windows.Win32.Graphics.Imaging.WICJpegTransferMatrix */
  TransferMatrix: WICJpegTransferMatrix;
  /** Windows.Win32.Graphics.Imaging.WICJpegScanType */
  ScanType: WICJpegScanType;
  /** u32 */
  cComponents: number;
  /** u32 */
  ComponentIdentifiers: number;
  /** u32 */
  SampleFactors: number;
  /** u32 */
  QuantizationTableIndices: number;
}

export const sizeofWICJpegFrameHeader = 32;

export function allocWICJpegFrameHeader(data?: Partial<WICJpegFrameHeader>): Uint8Array {
  const buf = new Uint8Array(sizeofWICJpegFrameHeader);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.Width !== undefined) view.setUint32(0, Number(data.Width), true);
  // 0x04: u32
  if (data?.Height !== undefined) view.setUint32(4, Number(data.Height), true);
  // 0x08: u32
  if (data?.TransferMatrix !== undefined) view.setUint32(8, Number(data.TransferMatrix), true);
  // 0x0c: u32
  if (data?.ScanType !== undefined) view.setUint32(12, Number(data.ScanType), true);
  // 0x10: u32
  if (data?.cComponents !== undefined) view.setUint32(16, Number(data.cComponents), true);
  // 0x14: u32
  if (data?.ComponentIdentifiers !== undefined) view.setUint32(20, Number(data.ComponentIdentifiers), true);
  // 0x18: u32
  if (data?.SampleFactors !== undefined) view.setUint32(24, Number(data.SampleFactors), true);
  // 0x1c: u32
  if (data?.QuantizationTableIndices !== undefined) view.setUint32(28, Number(data.QuantizationTableIndices), true);
  return buf;
}

export class WICJpegFrameHeaderView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get Width(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get Height(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: u32
  get TransferMatrix(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: u32
  get ScanType(): number {
    return this.view.getUint32(12, true);
  }

  // 0x10: u32
  get cComponents(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: u32
  get ComponentIdentifiers(): number {
    return this.view.getUint32(20, true);
  }

  // 0x18: u32
  get SampleFactors(): number {
    return this.view.getUint32(24, true);
  }

  // 0x1c: u32
  get QuantizationTableIndices(): number {
    return this.view.getUint32(28, true);
  }

  // 0x00: u32
  set Width(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set Height(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: u32
  set TransferMatrix(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: u32
  set ScanType(value: number) {
    this.view.setUint32(12, value, true);
  }

  // 0x10: u32
  set cComponents(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: u32
  set ComponentIdentifiers(value: number) {
    this.view.setUint32(20, value, true);
  }

  // 0x18: u32
  set SampleFactors(value: number) {
    this.view.setUint32(24, value, true);
  }

  // 0x1c: u32
  set QuantizationTableIndices(value: number) {
    this.view.setUint32(28, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICJpegScanHeader (size: 24)
 */
export interface WICJpegScanHeader {
  /** u32 */
  cComponents: number;
  /** u32 */
  RestartInterval: number;
  /** u32 */
  ComponentSelectors: number;
  /** u32 */
  HuffmanTableIndices: number;
  /** u8 */
  StartSpectralSelection: number;
  /** u8 */
  EndSpectralSelection: number;
  /** u8 */
  SuccessiveApproximationHigh: number;
  /** u8 */
  SuccessiveApproximationLow: number;
}

export const sizeofWICJpegScanHeader = 24;

export function allocWICJpegScanHeader(data?: Partial<WICJpegScanHeader>): Uint8Array {
  const buf = new Uint8Array(sizeofWICJpegScanHeader);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.cComponents !== undefined) view.setUint32(0, Number(data.cComponents), true);
  // 0x04: u32
  if (data?.RestartInterval !== undefined) view.setUint32(4, Number(data.RestartInterval), true);
  // 0x08: u32
  if (data?.ComponentSelectors !== undefined) view.setUint32(8, Number(data.ComponentSelectors), true);
  // 0x0c: u32
  if (data?.HuffmanTableIndices !== undefined) view.setUint32(12, Number(data.HuffmanTableIndices), true);
  // 0x10: u8
  if (data?.StartSpectralSelection !== undefined) view.setUint8(16, Number(data.StartSpectralSelection));
  // 0x11: u8
  if (data?.EndSpectralSelection !== undefined) view.setUint8(17, Number(data.EndSpectralSelection));
  // 0x12: u8
  if (data?.SuccessiveApproximationHigh !== undefined) view.setUint8(18, Number(data.SuccessiveApproximationHigh));
  // 0x13: u8
  if (data?.SuccessiveApproximationLow !== undefined) view.setUint8(19, Number(data.SuccessiveApproximationLow));
  // 0x14: pad4
  return buf;
}

export class WICJpegScanHeaderView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get cComponents(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get RestartInterval(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: u32
  get ComponentSelectors(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: u32
  get HuffmanTableIndices(): number {
    return this.view.getUint32(12, true);
  }

  // 0x10: u8
  get StartSpectralSelection(): number {
    return this.view.getUint8(16);
  }

  // 0x11: u8
  get EndSpectralSelection(): number {
    return this.view.getUint8(17);
  }

  // 0x12: u8
  get SuccessiveApproximationHigh(): number {
    return this.view.getUint8(18);
  }

  // 0x13: u8
  get SuccessiveApproximationLow(): number {
    return this.view.getUint8(19);
  }

  // 0x14: pad4

  // 0x00: u32
  set cComponents(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set RestartInterval(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: u32
  set ComponentSelectors(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: u32
  set HuffmanTableIndices(value: number) {
    this.view.setUint32(12, value, true);
  }

  // 0x10: u8
  set StartSpectralSelection(value: number) {
    this.view.setUint8(16, value);
  }

  // 0x11: u8
  set EndSpectralSelection(value: number) {
    this.view.setUint8(17, value);
  }

  // 0x12: u8
  set SuccessiveApproximationHigh(value: number) {
    this.view.setUint8(18, value);
  }

  // 0x13: u8
  set SuccessiveApproximationLow(value: number) {
    this.view.setUint8(19, value);
  }

  // 0x14: pad4
}

/**
 * Windows.Win32.Graphics.Imaging.WICRawCapabilitiesInfo (size: 72)
 */
export interface WICRawCapabilitiesInfo {
  /** u32 */
  cbSize: number;
  /** u32 */
  CodecMajorVersion: number;
  /** u32 */
  CodecMinorVersion: number;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  ExposureCompensationSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  ContrastSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  RGBWhitePointSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  NamedWhitePointSupport: WICRawCapabilities;
  /** u32 */
  NamedWhitePointSupportMask: number;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  KelvinWhitePointSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  GammaSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  TintSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  SaturationSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  SharpnessSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  NoiseReductionSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  DestinationColorProfileSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  ToneCurveSupport: WICRawCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawRotationCapabilities */
  RotationSupport: WICRawRotationCapabilities;
  /** Windows.Win32.Graphics.Imaging.WICRawCapabilities */
  RenderModeSupport: WICRawCapabilities;
}

export const sizeofWICRawCapabilitiesInfo = 72;

export function allocWICRawCapabilitiesInfo(data?: Partial<WICRawCapabilitiesInfo>): Uint8Array {
  const buf = new Uint8Array(sizeofWICRawCapabilitiesInfo);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.cbSize !== undefined) view.setUint32(0, Number(data.cbSize), true);
  // 0x04: u32
  if (data?.CodecMajorVersion !== undefined) view.setUint32(4, Number(data.CodecMajorVersion), true);
  // 0x08: u32
  if (data?.CodecMinorVersion !== undefined) view.setUint32(8, Number(data.CodecMinorVersion), true);
  // 0x0c: i32
  if (data?.ExposureCompensationSupport !== undefined) view.setInt32(12, Number(data.ExposureCompensationSupport), true);
  // 0x10: i32
  if (data?.ContrastSupport !== undefined) view.setInt32(16, Number(data.ContrastSupport), true);
  // 0x14: i32
  if (data?.RGBWhitePointSupport !== undefined) view.setInt32(20, Number(data.RGBWhitePointSupport), true);
  // 0x18: i32
  if (data?.NamedWhitePointSupport !== undefined) view.setInt32(24, Number(data.NamedWhitePointSupport), true);
  // 0x1c: u32
  if (data?.NamedWhitePointSupportMask !== undefined) view.setUint32(28, Number(data.NamedWhitePointSupportMask), true);
  // 0x20: i32
  if (data?.KelvinWhitePointSupport !== undefined) view.setInt32(32, Number(data.KelvinWhitePointSupport), true);
  // 0x24: i32
  if (data?.GammaSupport !== undefined) view.setInt32(36, Number(data.GammaSupport), true);
  // 0x28: i32
  if (data?.TintSupport !== undefined) view.setInt32(40, Number(data.TintSupport), true);
  // 0x2c: i32
  if (data?.SaturationSupport !== undefined) view.setInt32(44, Number(data.SaturationSupport), true);
  // 0x30: i32
  if (data?.SharpnessSupport !== undefined) view.setInt32(48, Number(data.SharpnessSupport), true);
  // 0x34: i32
  if (data?.NoiseReductionSupport !== undefined) view.setInt32(52, Number(data.NoiseReductionSupport), true);
  // 0x38: i32
  if (data?.DestinationColorProfileSupport !== undefined) view.setInt32(56, Number(data.DestinationColorProfileSupport), true);
  // 0x3c: i32
  if (data?.ToneCurveSupport !== undefined) view.setInt32(60, Number(data.ToneCurveSupport), true);
  // 0x40: i32
  if (data?.RotationSupport !== undefined) view.setInt32(64, Number(data.RotationSupport), true);
  // 0x44: i32
  if (data?.RenderModeSupport !== undefined) view.setInt32(68, Number(data.RenderModeSupport), true);
  return buf;
}

export class WICRawCapabilitiesInfoView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get cbSize(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get CodecMajorVersion(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: u32
  get CodecMinorVersion(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: i32
  get ExposureCompensationSupport(): number {
    return this.view.getInt32(12, true);
  }

  // 0x10: i32
  get ContrastSupport(): number {
    return this.view.getInt32(16, true);
  }

  // 0x14: i32
  get RGBWhitePointSupport(): number {
    return this.view.getInt32(20, true);
  }

  // 0x18: i32
  get NamedWhitePointSupport(): number {
    return this.view.getInt32(24, true);
  }

  // 0x1c: u32
  get NamedWhitePointSupportMask(): number {
    return this.view.getUint32(28, true);
  }

  // 0x20: i32
  get KelvinWhitePointSupport(): number {
    return this.view.getInt32(32, true);
  }

  // 0x24: i32
  get GammaSupport(): number {
    return this.view.getInt32(36, true);
  }

  // 0x28: i32
  get TintSupport(): number {
    return this.view.getInt32(40, true);
  }

  // 0x2c: i32
  get SaturationSupport(): number {
    return this.view.getInt32(44, true);
  }

  // 0x30: i32
  get SharpnessSupport(): number {
    return this.view.getInt32(48, true);
  }

  // 0x34: i32
  get NoiseReductionSupport(): number {
    return this.view.getInt32(52, true);
  }

  // 0x38: i32
  get DestinationColorProfileSupport(): number {
    return this.view.getInt32(56, true);
  }

  // 0x3c: i32
  get ToneCurveSupport(): number {
    return this.view.getInt32(60, true);
  }

  // 0x40: i32
  get RotationSupport(): number {
    return this.view.getInt32(64, true);
  }

  // 0x44: i32
  get RenderModeSupport(): number {
    return this.view.getInt32(68, true);
  }

  // 0x00: u32
  set cbSize(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set CodecMajorVersion(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: u32
  set CodecMinorVersion(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: i32
  set ExposureCompensationSupport(value: number) {
    this.view.setInt32(12, value, true);
  }

  // 0x10: i32
  set ContrastSupport(value: number) {
    this.view.setInt32(16, value, true);
  }

  // 0x14: i32
  set RGBWhitePointSupport(value: number) {
    this.view.setInt32(20, value, true);
  }

  // 0x18: i32
  set NamedWhitePointSupport(value: number) {
    this.view.setInt32(24, value, true);
  }

  // 0x1c: u32
  set NamedWhitePointSupportMask(value: number) {
    this.view.setUint32(28, value, true);
  }

  // 0x20: i32
  set KelvinWhitePointSupport(value: number) {
    this.view.setInt32(32, value, true);
  }

  // 0x24: i32
  set GammaSupport(value: number) {
    this.view.setInt32(36, value, true);
  }

  // 0x28: i32
  set TintSupport(value: number) {
    this.view.setInt32(40, value, true);
  }

  // 0x2c: i32
  set SaturationSupport(value: number) {
    this.view.setInt32(44, value, true);
  }

  // 0x30: i32
  set SharpnessSupport(value: number) {
    this.view.setInt32(48, value, true);
  }

  // 0x34: i32
  set NoiseReductionSupport(value: number) {
    this.view.setInt32(52, value, true);
  }

  // 0x38: i32
  set DestinationColorProfileSupport(value: number) {
    this.view.setInt32(56, value, true);
  }

  // 0x3c: i32
  set ToneCurveSupport(value: number) {
    this.view.setInt32(60, value, true);
  }

  // 0x40: i32
  set RotationSupport(value: number) {
    this.view.setInt32(64, value, true);
  }

  // 0x44: i32
  set RenderModeSupport(value: number) {
    this.view.setInt32(68, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICRawToneCurvePoint (size: 16)
 */
export interface WICRawToneCurvePoint {
  /** f64 */
  Input: number;
  /** f64 */
  Output: number;
}

export const sizeofWICRawToneCurvePoint = 16;

export function allocWICRawToneCurvePoint(data?: Partial<WICRawToneCurvePoint>): Uint8Array {
  const buf = new Uint8Array(sizeofWICRawToneCurvePoint);
  const view = new DataView(buf.buffer);
  // 0x00: f64
  if (data?.Input !== undefined) view.setFloat64(0, Number(data.Input), true);
  // 0x08: f64
  if (data?.Output !== undefined) view.setFloat64(8, Number(data.Output), true);
  return buf;
}

export class WICRawToneCurvePointView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: f64
  get Input(): number {
    return this.view.getFloat64(0, true);
  }

  // 0x08: f64
  get Output(): number {
    return this.view.getFloat64(8, true);
  }

  // 0x00: f64
  set Input(value: number) {
    this.view.setFloat64(0, value, true);
  }

  // 0x08: f64
  set Output(value: number) {
    this.view.setFloat64(8, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICRawToneCurve (size: 16)
 */
export interface WICRawToneCurve {
  /** u32 */
  cPoints: number;
  /** array */
  aPoints: Deno.PointerValue;
}

export const sizeofWICRawToneCurve = 16;

export function allocWICRawToneCurve(data?: Partial<WICRawToneCurve>): Uint8Array {
  const buf = new Uint8Array(sizeofWICRawToneCurve);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.cPoints !== undefined) view.setUint32(0, Number(data.cPoints), true);
  // 0x04: pad4
  // 0x08: pointer
  if (data?.aPoints !== undefined) view.setBigUint64(8, data.aPoints === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.aPoints))), true);
  return buf;
}

export class WICRawToneCurveView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get cPoints(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  get aPoints(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(8, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: u32
  set cPoints(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: pad4

  // 0x08: pointer
  set aPoints(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(8, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICDdsParameters (size: 32)
 */
export interface WICDdsParameters {
  /** u32 */
  Width: number;
  /** u32 */
  Height: number;
  /** u32 */
  Depth: number;
  /** u32 */
  MipLevels: number;
  /** u32 */
  ArraySize: number;
  /** Windows.Win32.Graphics.Dxgi.Common.DXGI_FORMAT */
  DxgiFormat: DXGI_FORMAT;
  /** Windows.Win32.Graphics.Imaging.WICDdsDimension */
  Dimension: WICDdsDimension;
  /** Windows.Win32.Graphics.Imaging.WICDdsAlphaMode */
  AlphaMode: WICDdsAlphaMode;
}

export const sizeofWICDdsParameters = 32;

export function allocWICDdsParameters(data?: Partial<WICDdsParameters>): Uint8Array {
  const buf = new Uint8Array(sizeofWICDdsParameters);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.Width !== undefined) view.setUint32(0, Number(data.Width), true);
  // 0x04: u32
  if (data?.Height !== undefined) view.setUint32(4, Number(data.Height), true);
  // 0x08: u32
  if (data?.Depth !== undefined) view.setUint32(8, Number(data.Depth), true);
  // 0x0c: u32
  if (data?.MipLevels !== undefined) view.setUint32(12, Number(data.MipLevels), true);
  // 0x10: u32
  if (data?.ArraySize !== undefined) view.setUint32(16, Number(data.ArraySize), true);
  // 0x14: u32
  if (data?.DxgiFormat !== undefined) view.setUint32(20, Number(data.DxgiFormat), true);
  // 0x18: i32
  if (data?.Dimension !== undefined) view.setInt32(24, Number(data.Dimension), true);
  // 0x1c: i32
  if (data?.AlphaMode !== undefined) view.setInt32(28, Number(data.AlphaMode), true);
  return buf;
}

export class WICDdsParametersView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get Width(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get Height(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: u32
  get Depth(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: u32
  get MipLevels(): number {
    return this.view.getUint32(12, true);
  }

  // 0x10: u32
  get ArraySize(): number {
    return this.view.getUint32(16, true);
  }

  // 0x14: u32
  get DxgiFormat(): number {
    return this.view.getUint32(20, true);
  }

  // 0x18: i32
  get Dimension(): number {
    return this.view.getInt32(24, true);
  }

  // 0x1c: i32
  get AlphaMode(): number {
    return this.view.getInt32(28, true);
  }

  // 0x00: u32
  set Width(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set Height(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: u32
  set Depth(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: u32
  set MipLevels(value: number) {
    this.view.setUint32(12, value, true);
  }

  // 0x10: u32
  set ArraySize(value: number) {
    this.view.setUint32(16, value, true);
  }

  // 0x14: u32
  set DxgiFormat(value: number) {
    this.view.setUint32(20, value, true);
  }

  // 0x18: i32
  set Dimension(value: number) {
    this.view.setInt32(24, value, true);
  }

  // 0x1c: i32
  set AlphaMode(value: number) {
    this.view.setInt32(28, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICDdsFormatInfo (size: 16)
 */
export interface WICDdsFormatInfo {
  /** Windows.Win32.Graphics.Dxgi.Common.DXGI_FORMAT */
  DxgiFormat: DXGI_FORMAT;
  /** u32 */
  BytesPerBlock: number;
  /** u32 */
  BlockWidth: number;
  /** u32 */
  BlockHeight: number;
}

export const sizeofWICDdsFormatInfo = 16;

export function allocWICDdsFormatInfo(data?: Partial<WICDdsFormatInfo>): Uint8Array {
  const buf = new Uint8Array(sizeofWICDdsFormatInfo);
  const view = new DataView(buf.buffer);
  // 0x00: u32
  if (data?.DxgiFormat !== undefined) view.setUint32(0, Number(data.DxgiFormat), true);
  // 0x04: u32
  if (data?.BytesPerBlock !== undefined) view.setUint32(4, Number(data.BytesPerBlock), true);
  // 0x08: u32
  if (data?.BlockWidth !== undefined) view.setUint32(8, Number(data.BlockWidth), true);
  // 0x0c: u32
  if (data?.BlockHeight !== undefined) view.setUint32(12, Number(data.BlockHeight), true);
  return buf;
}

export class WICDdsFormatInfoView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: u32
  get DxgiFormat(): number {
    return this.view.getUint32(0, true);
  }

  // 0x04: u32
  get BytesPerBlock(): number {
    return this.view.getUint32(4, true);
  }

  // 0x08: u32
  get BlockWidth(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: u32
  get BlockHeight(): number {
    return this.view.getUint32(12, true);
  }

  // 0x00: u32
  set DxgiFormat(value: number) {
    this.view.setUint32(0, value, true);
  }

  // 0x04: u32
  set BytesPerBlock(value: number) {
    this.view.setUint32(4, value, true);
  }

  // 0x08: u32
  set BlockWidth(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: u32
  set BlockHeight(value: number) {
    this.view.setUint32(12, value, true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICMetadataPattern (size: 40)
 */
export interface WICMetadataPattern {
  /** Windows.Win32.Foundation.ULARGE_INTEGER */
  Position: Uint8Array | Deno.PointerValue;
  /** u32 */
  Length: number;
  /** ptr */
  Pattern: Deno.PointerValue | Uint8Array;
  /** ptr */
  Mask: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.ULARGE_INTEGER */
  DataOffset: Uint8Array | Deno.PointerValue;
}

export const sizeofWICMetadataPattern = 40;

export function allocWICMetadataPattern(data?: Partial<WICMetadataPattern>): Uint8Array {
  const buf = new Uint8Array(sizeofWICMetadataPattern);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Position !== undefined) view.setBigUint64(0, data.Position === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Position))), true);
  // 0x08: u32
  if (data?.Length !== undefined) view.setUint32(8, Number(data.Length), true);
  // 0x0c: pad4
  // 0x10: pointer
  if (data?.Pattern !== undefined) view.setBigUint64(16, data.Pattern === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Pattern))), true);
  // 0x18: pointer
  if (data?.Mask !== undefined) view.setBigUint64(24, data.Mask === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Mask))), true);
  // 0x20: pointer
  if (data?.DataOffset !== undefined) view.setBigUint64(32, data.DataOffset === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.DataOffset))), true);
  return buf;
}

export class WICMetadataPatternView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Position(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get Length(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  get Pattern(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: pointer
  get Mask(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x20: pointer
  get DataOffset(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(32, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: pointer
  set Position(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set Length(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  set Pattern(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: pointer
  set Mask(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x20: pointer
  set DataOffset(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(32, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

/**
 * Windows.Win32.Graphics.Imaging.WICMetadataHeader (size: 32)
 */
export interface WICMetadataHeader {
  /** Windows.Win32.Foundation.ULARGE_INTEGER */
  Position: Uint8Array | Deno.PointerValue;
  /** u32 */
  Length: number;
  /** ptr */
  Header: Deno.PointerValue | Uint8Array;
  /** Windows.Win32.Foundation.ULARGE_INTEGER */
  DataOffset: Uint8Array | Deno.PointerValue;
}

export const sizeofWICMetadataHeader = 32;

export function allocWICMetadataHeader(data?: Partial<WICMetadataHeader>): Uint8Array {
  const buf = new Uint8Array(sizeofWICMetadataHeader);
  const view = new DataView(buf.buffer);
  // 0x00: pointer
  if (data?.Position !== undefined) view.setBigUint64(0, data.Position === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Position))), true);
  // 0x08: u32
  if (data?.Length !== undefined) view.setUint32(8, Number(data.Length), true);
  // 0x0c: pad4
  // 0x10: pointer
  if (data?.Header !== undefined) view.setBigUint64(16, data.Header === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.Header))), true);
  // 0x18: pointer
  if (data?.DataOffset !== undefined) view.setBigUint64(24, data.DataOffset === null ? 0n : BigInt(Deno.UnsafePointer.value(util.toPointer(data.DataOffset))), true);
  return buf;
}

export class WICMetadataHeaderView {
  private readonly view: DataView;
  constructor(private readonly buf: Uint8Array) {
    this.view = new DataView(buf.buffer);
  }

  get buffer(): Uint8Array {
    return this.buf;
  }

  // 0x00: pointer
  get Position(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(0, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x08: u32
  get Length(): number {
    return this.view.getUint32(8, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  get Header(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(16, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x18: pointer
  get DataOffset(): Uint8Array | Deno.PointerValue {
    const ptr = this.view.getBigUint64(24, true);
    return Deno.UnsafePointer.create(ptr);
  }

  // 0x00: pointer
  set Position(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(0, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x08: u32
  set Length(value: number) {
    this.view.setUint32(8, value, true);
  }

  // 0x0c: pad4

  // 0x10: pointer
  set Header(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(16, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }

  // 0x18: pointer
  set DataOffset(value: Uint8Array | Deno.PointerValue) {
    this.view.setBigUint64(24, BigInt(Deno.UnsafePointer.value(util.toPointer(value))), true);
  }
}

export type HRESULT = number;

export type HANDLE = bigint | number;

// Native Libraries

try {
  var libWindowsCodecs_dll = Deno.dlopen("WindowsCodecs.dll", {
    WICConvertBitmapSource: {
      parameters: ["pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICCreateBitmapFromSection: {
      parameters: ["u32", "u32", "pointer", "pointer", "u32", "u32", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICCreateBitmapFromSectionEx: {
      parameters: ["u32", "u32", "pointer", "pointer", "u32", "u32", "u32", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICMapGuidToShortName: {
      parameters: ["pointer", "u32", "buffer", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICMapShortNameToGuid: {
      parameters: ["buffer", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICMapSchemaToName: {
      parameters: ["pointer", "buffer", "u32", "buffer", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICMatchMetadataContent: {
      parameters: ["pointer", "pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICSerializeMetadataContent: {
      parameters: ["pointer", "pointer", "u32", "pointer"],
      result: "pointer",
      optional: true,
    },
    WICGetMetadataContentSize: {
      parameters: ["pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
  }).symbols;
} catch(e) { /* ignore */ }

// Symbols

export function WICConvertBitmapSource(
  dstFormat: Deno.PointerValue | Uint8Array /* ptr */,
  pISrc: Uint8Array | Deno.PointerValue /* Windows.Win32.Graphics.Imaging.IWICBitmapSource */,
  ppIDst: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICConvertBitmapSource!(util.toPointer(dstFormat), util.toPointer(pISrc), util.toPointer(ppIDst));
}

export function WICCreateBitmapFromSection(
  width: number /* u32 */,
  height: number /* u32 */,
  pixelFormat: Deno.PointerValue | Uint8Array /* ptr */,
  hSection: Uint8Array | Deno.PointerValue /* Windows.Win32.Foundation.HANDLE */,
  stride: number /* u32 */,
  offset: number /* u32 */,
  ppIBitmap: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICCreateBitmapFromSection!(width, height, util.toPointer(pixelFormat), util.toPointer(hSection), stride, offset, util.toPointer(ppIBitmap));
}

export function WICCreateBitmapFromSectionEx(
  width: number /* u32 */,
  height: number /* u32 */,
  pixelFormat: Deno.PointerValue | Uint8Array /* ptr */,
  hSection: Uint8Array | Deno.PointerValue /* Windows.Win32.Foundation.HANDLE */,
  stride: number /* u32 */,
  offset: number /* u32 */,
  desiredAccessLevel: WICSectionAccessLevel /* Windows.Win32.Graphics.Imaging.WICSectionAccessLevel */,
  ppIBitmap: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICCreateBitmapFromSectionEx!(width, height, util.toPointer(pixelFormat), util.toPointer(hSection), stride, offset, desiredAccessLevel, util.toPointer(ppIBitmap));
}

export function WICMapGuidToShortName(
  guid: Deno.PointerValue | Uint8Array /* ptr */,
  cchName: number /* u32 */,
  wzName: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pcchActual: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICMapGuidToShortName!(util.toPointer(guid), cchName, util.pwstrToFfi(wzName), util.toPointer(pcchActual));
}

export function WICMapShortNameToGuid(
  wzName: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pguid: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICMapShortNameToGuid!(util.pwstrToFfi(wzName), util.toPointer(pguid));
}

export function WICMapSchemaToName(
  guidMetadataFormat: Deno.PointerValue | Uint8Array /* ptr */,
  pwzSchema: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  cchName: number /* u32 */,
  wzName: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pcchActual: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICMapSchemaToName!(util.toPointer(guidMetadataFormat), util.pwstrToFfi(pwzSchema), cchName, util.pwstrToFfi(wzName), util.toPointer(pcchActual));
}

export function WICMatchMetadataContent(
  guidContainerFormat: Deno.PointerValue | Uint8Array /* ptr */,
  pguidVendor: Deno.PointerValue | Uint8Array /* ptr */,
  pIStream: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pguidMetadataFormat: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICMatchMetadataContent!(util.toPointer(guidContainerFormat), util.toPointer(pguidVendor), util.toPointer(pIStream), util.toPointer(pguidMetadataFormat));
}

export function WICSerializeMetadataContent(
  guidContainerFormat: Deno.PointerValue | Uint8Array /* ptr */,
  pIWriter: Uint8Array | Deno.PointerValue /* Windows.Win32.Graphics.Imaging.IWICMetadataWriter */,
  dwPersistOptions: number /* u32 */,
  pIStream: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICSerializeMetadataContent!(util.toPointer(guidContainerFormat), util.toPointer(pIWriter), dwPersistOptions, util.toPointer(pIStream));
}

export function WICGetMetadataContentSize(
  guidContainerFormat: Deno.PointerValue | Uint8Array /* ptr */,
  pIWriter: Uint8Array | Deno.PointerValue /* Windows.Win32.Graphics.Imaging.IWICMetadataWriter */,
  pcbSize: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libWindowsCodecs_dll.WICGetMetadataContentSize!(util.toPointer(guidContainerFormat), util.toPointer(pIWriter), util.toPointer(pcbSize));
}

