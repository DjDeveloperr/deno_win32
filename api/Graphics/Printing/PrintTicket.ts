/// Auto-generated by Deno Win32: Windows.Win32.Graphics.Printing.PrintTicket.Apis

import * as util from "../../../util.ts";

// Enums
export type EDefaultDevmodeType = number;
export type EPrintTicketScope = number;

// Constants
export const PRINTTICKET_ISTREAM_APIS = 1;
export const S_PT_NO_CONFLICT = 262145;
export const S_PT_CONFLICT_RESOLVED = 262146;
export const E_PRINTTICKET_FORMAT = 2147745795;
export const E_PRINTCAPABILITIES_FORMAT = 2147745796;
export const E_DELTA_PRINTTICKET_FORMAT = 2147745797;
export const E_PRINTDEVICECAPABILITIES_FORMAT = 2147745798;
export const kUserDefaultDevmode = 0;
export const kPrinterDefaultDevmode = 1;
export const kPTPageScope = 0;
export const kPTDocumentScope = 1;
export const kPTJobScope = 2;

// Structs

export type PWSTR = Deno.PointerValue | Uint8Array;

export type HRESULT = number;

export type HPTPROVIDER = bigint | number;

// Native Libraries

try {
  var libprntvpt_dll = Deno.dlopen("prntvpt.dll", {
    PTQuerySchemaVersionSupport: {
      parameters: ["buffer", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTOpenProvider: {
      parameters: ["buffer", "u32", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTOpenProviderEx: {
      parameters: ["buffer", "u32", "u32", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTCloseProvider: {
      parameters: ["pointer"],
      result: "pointer",
      optional: true,
    },
    PTReleaseMemory: {
      parameters: ["pointer"],
      result: "pointer",
      optional: true,
    },
    PTGetPrintCapabilities: {
      parameters: ["pointer", "pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTGetPrintDeviceCapabilities: {
      parameters: ["pointer", "pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTGetPrintDeviceResources: {
      parameters: ["pointer", "buffer", "pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTMergeAndValidatePrintTicket: {
      parameters: ["pointer", "pointer", "pointer", "i32", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTConvertPrintTicketToDevMode: {
      parameters: ["pointer", "pointer", "i32", "i32", "pointer", "pointer", "pointer"],
      result: "pointer",
      optional: true,
    },
    PTConvertDevModeToPrintTicket: {
      parameters: ["pointer", "u32", "pointer", "i32", "pointer"],
      result: "pointer",
      optional: true,
    },
  }).symbols;
} catch(e) { /* ignore */ }

// Symbols

export function PTQuerySchemaVersionSupport(
  pszPrinterName: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pMaxVersion: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTQuerySchemaVersionSupport!(util.pwstrToFfi(pszPrinterName), util.toPointer(pMaxVersion));
}

export function PTOpenProvider(
  pszPrinterName: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  dwVersion: number /* u32 */,
  phProvider: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTOpenProvider!(util.pwstrToFfi(pszPrinterName), dwVersion, util.toPointer(phProvider));
}

export function PTOpenProviderEx(
  pszPrinterName: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  dwMaxVersion: number /* u32 */,
  dwPrefVersion: number /* u32 */,
  phProvider: Deno.PointerValue | Uint8Array /* ptr */,
  pUsedVersion: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTOpenProviderEx!(util.pwstrToFfi(pszPrinterName), dwMaxVersion, dwPrefVersion, util.toPointer(phProvider), util.toPointer(pUsedVersion));
}

export function PTCloseProvider(
  hProvider: Uint8Array | Deno.PointerValue /* Windows.Win32.Storage.Xps.HPTPROVIDER */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTCloseProvider!(util.toPointer(hProvider));
}

export function PTReleaseMemory(
  pBuffer: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTReleaseMemory!(util.toPointer(pBuffer));
}

export function PTGetPrintCapabilities(
  hProvider: Uint8Array | Deno.PointerValue /* Windows.Win32.Storage.Xps.HPTPROVIDER */,
  pPrintTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pCapabilities: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pbstrErrorMessage: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTGetPrintCapabilities!(util.toPointer(hProvider), util.toPointer(pPrintTicket), util.toPointer(pCapabilities), util.toPointer(pbstrErrorMessage));
}

export function PTGetPrintDeviceCapabilities(
  hProvider: Uint8Array | Deno.PointerValue /* Windows.Win32.Storage.Xps.HPTPROVIDER */,
  pPrintTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pDeviceCapabilities: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pbstrErrorMessage: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTGetPrintDeviceCapabilities!(util.toPointer(hProvider), util.toPointer(pPrintTicket), util.toPointer(pDeviceCapabilities), util.toPointer(pbstrErrorMessage));
}

export function PTGetPrintDeviceResources(
  hProvider: Uint8Array | Deno.PointerValue /* Windows.Win32.Storage.Xps.HPTPROVIDER */,
  pszLocaleName: string | null | Uint8Array | Uint16Array /* Windows.Win32.Foundation.PWSTR */,
  pPrintTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pDeviceResources: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pbstrErrorMessage: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTGetPrintDeviceResources!(util.toPointer(hProvider), util.pwstrToFfi(pszLocaleName), util.toPointer(pPrintTicket), util.toPointer(pDeviceResources), util.toPointer(pbstrErrorMessage));
}

export function PTMergeAndValidatePrintTicket(
  hProvider: Uint8Array | Deno.PointerValue /* Windows.Win32.Storage.Xps.HPTPROVIDER */,
  pBaseTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pDeltaTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  scope: EPrintTicketScope /* Windows.Win32.Graphics.Printing.PrintTicket.EPrintTicketScope */,
  pResultTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  pbstrErrorMessage: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTMergeAndValidatePrintTicket!(util.toPointer(hProvider), util.toPointer(pBaseTicket), util.toPointer(pDeltaTicket), scope, util.toPointer(pResultTicket), util.toPointer(pbstrErrorMessage));
}

export function PTConvertPrintTicketToDevMode(
  hProvider: Uint8Array | Deno.PointerValue /* Windows.Win32.Storage.Xps.HPTPROVIDER */,
  pPrintTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
  baseDevmodeType: EDefaultDevmodeType /* Windows.Win32.Graphics.Printing.PrintTicket.EDefaultDevmodeType */,
  scope: EPrintTicketScope /* Windows.Win32.Graphics.Printing.PrintTicket.EPrintTicketScope */,
  pcbDevmode: Deno.PointerValue | Uint8Array /* ptr */,
  ppDevmode: Deno.PointerValue | Uint8Array /* ptr */,
  pbstrErrorMessage: Deno.PointerValue | Uint8Array /* ptr */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTConvertPrintTicketToDevMode!(util.toPointer(hProvider), util.toPointer(pPrintTicket), baseDevmodeType, scope, util.toPointer(pcbDevmode), util.toPointer(ppDevmode), util.toPointer(pbstrErrorMessage));
}

export function PTConvertDevModeToPrintTicket(
  hProvider: Uint8Array | Deno.PointerValue /* Windows.Win32.Storage.Xps.HPTPROVIDER */,
  cbDevmode: number /* u32 */,
  pDevmode: Deno.PointerValue | Uint8Array /* ptr */,
  scope: EPrintTicketScope /* Windows.Win32.Graphics.Printing.PrintTicket.EPrintTicketScope */,
  pPrintTicket: Uint8Array | Deno.PointerValue /* Windows.Win32.System.Com.IStream */,
): Deno.PointerValue /* Windows.Win32.Foundation.HRESULT */ {
  return libprntvpt_dll.PTConvertDevModeToPrintTicket!(util.toPointer(hProvider), cbDevmode, util.toPointer(pDevmode), scope, util.toPointer(pPrintTicket));
}

